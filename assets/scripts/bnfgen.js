(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var Curry=require("./curry.js");var Caml_obj=require("./caml_obj.js");var Caml_array=require("./caml_array.js");var Caml_exceptions=require("./caml_exceptions.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");var make_float=Caml_array.caml_make_float_vect;var Floatarray={};function init(l,f){if(l===0){return[]}else{if(l<0){throw[Caml_builtin_exceptions.invalid_argument,"Array.init"]}var res=Caml_array.caml_make_vect(l,Curry._1(f,0));for(var i=1,i_finish=l-1|0;i<=i_finish;++i){res[i]=Curry._1(f,i)}return res}}function make_matrix(sx,sy,init){var res=Caml_array.caml_make_vect(sx,[]);for(var x=0,x_finish=sx-1|0;x<=x_finish;++x){res[x]=Caml_array.caml_make_vect(sy,init)}return res}function copy(a){var l=a.length;if(l===0){return[]}else{return Caml_array.caml_array_sub(a,0,l)}}function append(a1,a2){var l1=a1.length;if(l1===0){return copy(a2)}else if(a2.length===0){return Caml_array.caml_array_sub(a1,0,l1)}else{return a1.concat(a2)}}function sub(a,ofs,len){if(ofs<0||len<0||ofs>(a.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Array.sub"]}return Caml_array.caml_array_sub(a,ofs,len)}function fill(a,ofs,len,v){if(ofs<0||len<0||ofs>(a.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Array.fill"]}for(var i=ofs,i_finish=(ofs+len|0)-1|0;i<=i_finish;++i){a[i]=v}return 0}function blit(a1,ofs1,a2,ofs2,len){if(len<0||ofs1<0||ofs1>(a1.length-len|0)||ofs2<0||ofs2>(a2.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Array.blit"]}return Caml_array.caml_array_blit(a1,ofs1,a2,ofs2,len)}function iter(f,a){for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){Curry._1(f,a[i])}return 0}function iter2(f,a,b){if(a.length!==b.length){throw[Caml_builtin_exceptions.invalid_argument,"Array.iter2: arrays must have the same length"]}for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){Curry._2(f,a[i],b[i])}return 0}function map(f,a){var l=a.length;if(l===0){return[]}else{var r=Caml_array.caml_make_vect(l,Curry._1(f,a[0]));for(var i=1,i_finish=l-1|0;i<=i_finish;++i){r[i]=Curry._1(f,a[i])}return r}}function map2(f,a,b){var la=a.length;var lb=b.length;if(la!==lb){throw[Caml_builtin_exceptions.invalid_argument,"Array.map2: arrays must have the same length"]}if(la===0){return[]}else{var r=Caml_array.caml_make_vect(la,Curry._2(f,a[0],b[0]));for(var i=1,i_finish=la-1|0;i<=i_finish;++i){r[i]=Curry._2(f,a[i],b[i])}return r}}function iteri(f,a){for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){Curry._2(f,i,a[i])}return 0}function mapi(f,a){var l=a.length;if(l===0){return[]}else{var r=Caml_array.caml_make_vect(l,Curry._2(f,0,a[0]));for(var i=1,i_finish=l-1|0;i<=i_finish;++i){r[i]=Curry._2(f,i,a[i])}return r}}function to_list(a){var _i=a.length-1|0;var _res=0;while(true){var res=_res;var i=_i;if(i<0){return res}else{_res=[a[i],res];_i=i-1|0;continue}}}function list_length(_accu,_param){while(true){var param=_param;var accu=_accu;if(param){_param=param[1];_accu=accu+1|0;continue}else{return accu}}}function of_list(l){if(l){var a=Caml_array.caml_make_vect(list_length(0,l),l[0]);var _i=1;var _param=l[1];while(true){var param=_param;var i=_i;if(param){a[i]=param[0];_param=param[1];_i=i+1|0;continue}else{return a}}}else{return[]}}function fold_left(f,x,a){var r=x;for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){r=Curry._2(f,r,a[i])}return r}function fold_right(f,a,x){var r=x;for(var i=a.length-1|0;i>=0;--i){r=Curry._2(f,a[i],r)}return r}function exists(p,a){var n=a.length;var _i=0;while(true){var i=_i;if(i===n){return false}else if(Curry._1(p,a[i])){return true}else{_i=i+1|0;continue}}}function for_all(p,a){var n=a.length;var _i=0;while(true){var i=_i;if(i===n){return true}else if(Curry._1(p,a[i])){_i=i+1|0;continue}else{return false}}}function mem(x,a){var n=a.length;var _i=0;while(true){var i=_i;if(i===n){return false}else if(Caml_obj.caml_equal(a[i],x)){return true}else{_i=i+1|0;continue}}}function memq(x,a){var n=a.length;var _i=0;while(true){var i=_i;if(i===n){return false}else if(x===a[i]){return true}else{_i=i+1|0;continue}}}var Bottom=Caml_exceptions.create("Array.Bottom");function sort(cmp,a){var maxson=function(l,i){var i31=((i+i|0)+i|0)+1|0;var x=i31;if((i31+2|0)<l){if(Curry._2(cmp,Caml_array.caml_array_get(a,i31),Caml_array.caml_array_get(a,i31+1|0))<0){x=i31+1|0}if(Curry._2(cmp,Caml_array.caml_array_get(a,x),Caml_array.caml_array_get(a,i31+2|0))<0){x=i31+2|0}return x}else if((i31+1|0)<l&&Curry._2(cmp,Caml_array.caml_array_get(a,i31),Caml_array.caml_array_get(a,i31+1|0))<0){return i31+1|0}else if(i31<l){return i31}else{throw[Bottom,i]}};var trickle=function(l,i,e){try{var l$1=l;var _i=i;var e$1=e;while(true){var i$1=_i;var j=maxson(l$1,i$1);if(Curry._2(cmp,Caml_array.caml_array_get(a,j),e$1)>0){Caml_array.caml_array_set(a,i$1,Caml_array.caml_array_get(a,j));_i=j;continue}else{return Caml_array.caml_array_set(a,i$1,e$1)}}}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Bottom){return Caml_array.caml_array_set(a,exn[1],e)}else{throw exn}}};var bubble=function(l,i){try{var l$1=l;var _i=i;while(true){var i$1=_i;var j=maxson(l$1,i$1);Caml_array.caml_array_set(a,i$1,Caml_array.caml_array_get(a,j));_i=j;continue}}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Bottom){return exn[1]}else{throw exn}}};var trickleup=function(_i,e){while(true){var i=_i;var father=(i-1|0)/3|0;if(i===father){throw[Caml_builtin_exceptions.assert_failure,["array.ml",238,4]]}if(Curry._2(cmp,Caml_array.caml_array_get(a,father),e)<0){Caml_array.caml_array_set(a,i,Caml_array.caml_array_get(a,father));if(father>0){_i=father;continue}else{return Caml_array.caml_array_set(a,0,e)}}else{return Caml_array.caml_array_set(a,i,e)}}};var l=a.length;for(var i=((l+1|0)/3|0)-1|0;i>=0;--i){trickle(l,i,Caml_array.caml_array_get(a,i))}for(var i$1=l-1|0;i$1>=2;--i$1){var e=Caml_array.caml_array_get(a,i$1);Caml_array.caml_array_set(a,i$1,Caml_array.caml_array_get(a,0));trickleup(bubble(i$1,0),e)}if(l>1){var e$1=Caml_array.caml_array_get(a,1);Caml_array.caml_array_set(a,1,Caml_array.caml_array_get(a,0));return Caml_array.caml_array_set(a,0,e$1)}else{return 0}}function stable_sort(cmp,a){var merge=function(src1ofs,src1len,src2,src2ofs,src2len,dst,dstofs){var src1r=src1ofs+src1len|0;var src2r=src2ofs+src2len|0;var _i1=src1ofs;var _s1=Caml_array.caml_array_get(a,src1ofs);var _i2=src2ofs;var _s2=Caml_array.caml_array_get(src2,src2ofs);var _d=dstofs;while(true){var d=_d;var s2=_s2;var i2=_i2;var s1=_s1;var i1=_i1;if(Curry._2(cmp,s1,s2)<=0){Caml_array.caml_array_set(dst,d,s1);var i1$1=i1+1|0;if(i1$1<src1r){_d=d+1|0;_s1=Caml_array.caml_array_get(a,i1$1);_i1=i1$1;continue}else{return blit(src2,i2,dst,d+1|0,src2r-i2|0)}}else{Caml_array.caml_array_set(dst,d,s2);var i2$1=i2+1|0;if(i2$1<src2r){_d=d+1|0;_s2=Caml_array.caml_array_get(src2,i2$1);_i2=i2$1;continue}else{return blit(a,i1,dst,d+1|0,src1r-i1|0)}}}};var isortto=function(srcofs,dst,dstofs,len){for(var i=0,i_finish=len-1|0;i<=i_finish;++i){var e=Caml_array.caml_array_get(a,srcofs+i|0);var j=(dstofs+i|0)-1|0;while(j>=dstofs&&Curry._2(cmp,Caml_array.caml_array_get(dst,j),e)>0){Caml_array.caml_array_set(dst,j+1|0,Caml_array.caml_array_get(dst,j));j=j-1|0}Caml_array.caml_array_set(dst,j+1|0,e)}return 0};var sortto=function(srcofs,dst,dstofs,len){if(len<=5){return isortto(srcofs,dst,dstofs,len)}else{var l1=len/2|0;var l2=len-l1|0;sortto(srcofs+l1|0,dst,dstofs+l1|0,l2);sortto(srcofs,a,srcofs+l2|0,l1);return merge(srcofs+l2|0,l1,dst,dstofs+l1|0,l2,dst,dstofs)}};var l=a.length;if(l<=5){return isortto(0,a,0,l)}else{var l1=l/2|0;var l2=l-l1|0;var t=Caml_array.caml_make_vect(l2,Caml_array.caml_array_get(a,0));sortto(l1,t,0,l2);sortto(0,a,l2,l1);return merge(l2,l1,t,0,l2,a,0)}}var create_matrix=make_matrix;var concat=Caml_array.caml_array_concat;var fast_sort=stable_sort;exports.make_float=make_float;exports.init=init;exports.make_matrix=make_matrix;exports.create_matrix=create_matrix;exports.append=append;exports.concat=concat;exports.sub=sub;exports.copy=copy;exports.fill=fill;exports.blit=blit;exports.to_list=to_list;exports.of_list=of_list;exports.iter=iter;exports.iteri=iteri;exports.map=map;exports.mapi=mapi;exports.fold_left=fold_left;exports.fold_right=fold_right;exports.iter2=iter2;exports.map2=map2;exports.for_all=for_all;exports.exists=exists;exports.mem=mem;exports.memq=memq;exports.sort=sort;exports.stable_sort=stable_sort;exports.fast_sort=fast_sort;exports.Floatarray=Floatarray},{"./caml_array.js":5,"./caml_builtin_exceptions.js":6,"./caml_exceptions.js":8,"./caml_js_exceptions.js":14,"./caml_obj.js":17,"./curry.js":27}],2:[function(require,module,exports){"use strict";function __(tag,block){block.tag=tag;return block}exports.__=__},{}],3:[function(require,module,exports){"use strict";var Bytes=require("./bytes.js");var Curry=require("./curry.js");var $$String=require("./string.js");var Caml_bytes=require("./caml_bytes.js");var Pervasives=require("./pervasives.js");var Caml_string=require("./caml_string.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function create(n){var n$1=n<1?1:n;var s=Caml_bytes.caml_create_bytes(n$1);return{buffer:s,position:0,length:n$1,initial_buffer:s}}function contents(b){return Bytes.sub_string(b.buffer,0,b.position)}function to_bytes(b){return Bytes.sub(b.buffer,0,b.position)}function sub(b,ofs,len){if(ofs<0||len<0||ofs>(b.position-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.sub"]}return Bytes.sub_string(b.buffer,ofs,len)}function blit(src,srcoff,dst,dstoff,len){if(len<0||srcoff<0||srcoff>(src.position-len|0)||dstoff<0||dstoff>(dst.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.blit"]}return Caml_bytes.caml_blit_bytes(src.buffer,srcoff,dst,dstoff,len)}function nth(b,ofs){if(ofs<0||ofs>=b.position){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.nth"]}return b.buffer[ofs]}function length(b){return b.position}function clear(b){b.position=0;return 0}function reset(b){b.position=0;b.buffer=b.initial_buffer;b.length=b.buffer.length;return 0}function resize(b,more){var len=b.length;var new_len=len;while((b.position+more|0)>new_len){new_len=new_len<<1}var new_buffer=Caml_bytes.caml_create_bytes(new_len);Bytes.blit(b.buffer,0,new_buffer,0,b.position);b.buffer=new_buffer;b.length=new_len;return 0}function add_char(b,c){var pos=b.position;if(pos>=b.length){resize(b,1)}b.buffer[pos]=c;b.position=pos+1|0;return 0}function add_utf_8_uchar(b,u){var u$1=u;if(u$1<0){throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",90,19]]}if(u$1<=127){return add_char(b,u$1)}else if(u$1<=2047){var pos=b.position;if((pos+2|0)>b.length){resize(b,2)}b.buffer[pos]=192|u$1>>>6;b.buffer[pos+1|0]=128|u$1&63;b.position=pos+2|0;return 0}else if(u$1<=65535){var pos$1=b.position;if((pos$1+3|0)>b.length){resize(b,3)}b.buffer[pos$1]=224|u$1>>>12;b.buffer[pos$1+1|0]=128|u$1>>>6&63;b.buffer[pos$1+2|0]=128|u$1&63;b.position=pos$1+3|0;return 0}else if(u$1<=1114111){var pos$2=b.position;if((pos$2+4|0)>b.length){resize(b,4)}b.buffer[pos$2]=240|u$1>>>18;b.buffer[pos$2+1|0]=128|u$1>>>12&63;b.buffer[pos$2+2|0]=128|u$1>>>6&63;b.buffer[pos$2+3|0]=128|u$1&63;b.position=pos$2+4|0;return 0}else{throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",123,8]]}}function add_utf_16be_uchar(b,u){var u$1=u;if(u$1<0){throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",126,19]]}if(u$1<=65535){var pos=b.position;if((pos+2|0)>b.length){resize(b,2)}b.buffer[pos]=u$1>>>8;b.buffer[pos+1|0]=u$1&255;b.position=pos+2|0;return 0}else if(u$1<=1114111){var u$prime=u$1-65536|0;var hi=55296|u$prime>>>10;var lo=56320|u$prime&1023;var pos$1=b.position;if((pos$1+4|0)>b.length){resize(b,4)}b.buffer[pos$1]=hi>>>8;b.buffer[pos$1+1|0]=hi&255;b.buffer[pos$1+2|0]=lo>>>8;b.buffer[pos$1+3|0]=lo&255;b.position=pos$1+4|0;return 0}else{throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",144,8]]}}function add_utf_16le_uchar(b,u){var u$1=u;if(u$1<0){throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",147,19]]}if(u$1<=65535){var pos=b.position;if((pos+2|0)>b.length){resize(b,2)}b.buffer[pos]=u$1&255;b.buffer[pos+1|0]=u$1>>>8;b.position=pos+2|0;return 0}else if(u$1<=1114111){var u$prime=u$1-65536|0;var hi=55296|u$prime>>>10;var lo=56320|u$prime&1023;var pos$1=b.position;if((pos$1+4|0)>b.length){resize(b,4)}b.buffer[pos$1]=hi&255;b.buffer[pos$1+1|0]=hi>>>8;b.buffer[pos$1+2|0]=lo&255;b.buffer[pos$1+3|0]=lo>>>8;b.position=pos$1+4|0;return 0}else{throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",165,8]]}}function add_substring(b,s,offset,len){if(offset<0||len<0||offset>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.add_substring/add_subbytes"]}var new_position=b.position+len|0;if(new_position>b.length){resize(b,len)}Bytes.blit_string(s,offset,b.buffer,b.position,len);b.position=new_position;return 0}function add_subbytes(b,s,offset,len){return add_substring(b,Caml_bytes.bytes_to_string(s),offset,len)}function add_string(b,s){var len=s.length;var new_position=b.position+len|0;if(new_position>b.length){resize(b,len)}Bytes.blit_string(s,0,b.buffer,b.position,len);b.position=new_position;return 0}function add_bytes(b,s){return add_string(b,Caml_bytes.bytes_to_string(s))}function add_buffer(b,bs){return add_subbytes(b,bs.buffer,0,bs.position)}function add_channel(b,ic,len){if(len<0){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.add_channel"]}if((b.position+len|0)>b.length){resize(b,len)}var b$1=b;var ic$1=ic;var _len=len;while(true){var len$1=_len;if(len$1>0){var n=Pervasives.input(ic$1,b$1.buffer,b$1.position,len$1);b$1.position=b$1.position+n|0;if(n===0){throw Caml_builtin_exceptions.end_of_file}_len=len$1-n|0;continue}else{return 0}}}function output_buffer(oc,b){return Pervasives.output(oc,b.buffer,0,b.position)}function closing(param){if(param!==40){if(param!==123){throw[Caml_builtin_exceptions.assert_failure,["buffer.ml",216,9]]}else{return 125}}else{return 41}}function advance_to_closing(opening,closing,k,s,start){var _k=k;var _i=start;var lim=s.length;while(true){var i=_i;var k$1=_k;if(i>=lim){throw Caml_builtin_exceptions.not_found}if(Caml_string.get(s,i)===opening){_i=i+1|0;_k=k$1+1|0;continue}else if(Caml_string.get(s,i)===closing){if(k$1===0){return i}else{_i=i+1|0;_k=k$1-1|0;continue}}else{_i=i+1|0;continue}}}function advance_to_non_alpha(s,start){var _i=start;var lim=s.length;while(true){var i=_i;if(i>=lim){return lim}else{var match=Caml_string.get(s,i);if(match>=91){if(match>=97){if(match>=123){return i}}else if(match!==95){return i}}else if(match>=58){if(match<65){return i}}else if(match<48){return i}_i=i+1|0;continue}}}function find_ident(s,start,lim){if(start>=lim){throw Caml_builtin_exceptions.not_found}var c=Caml_string.get(s,start);if(c!==40&&c!==123){var stop=advance_to_non_alpha(s,start+1|0);return[$$String.sub(s,start,stop-start|0),stop]}var new_start=start+1|0;var stop$1=advance_to_closing(c,closing(c),0,s,new_start);return[$$String.sub(s,new_start,(stop$1-start|0)-1|0),stop$1+1|0]}function add_substitute(b,f,s){var lim=s.length;var _previous=32;var _i=0;while(true){var i=_i;var previous=_previous;if(i<lim){var current=Caml_string.get(s,i);if(current!==36){if(previous===92){add_char(b,92);add_char(b,current);_i=i+1|0;_previous=32;continue}else if(current!==92){add_char(b,current);_i=i+1|0;_previous=current;continue}else{_i=i+1|0;_previous=current;continue}}else if(previous===92){add_char(b,current);_i=i+1|0;_previous=32;continue}else{var j=i+1|0;var match=find_ident(s,j,lim);add_string(b,Curry._1(f,match[0]));_i=match[1];_previous=32;continue}}else if(previous===92){return add_char(b,previous)}else{return 0}}}function truncate(b,len){if(len<0||len>b.position){throw[Caml_builtin_exceptions.invalid_argument,"Buffer.truncate"]}b.position=len;return 0}exports.create=create;exports.contents=contents;exports.to_bytes=to_bytes;exports.sub=sub;exports.blit=blit;exports.nth=nth;exports.length=length;exports.clear=clear;exports.reset=reset;exports.add_char=add_char;exports.add_utf_8_uchar=add_utf_8_uchar;exports.add_utf_16le_uchar=add_utf_16le_uchar;exports.add_utf_16be_uchar=add_utf_16be_uchar;exports.add_string=add_string;exports.add_bytes=add_bytes;exports.add_substring=add_substring;exports.add_subbytes=add_subbytes;exports.add_substitute=add_substitute;exports.add_buffer=add_buffer;exports.add_channel=add_channel;exports.output_buffer=output_buffer;exports.truncate=truncate},{"./bytes.js":4,"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_string.js":20,"./curry.js":27,"./pervasives.js":36,"./string.js":39}],4:[function(require,module,exports){"use strict";var Char=require("./char.js");var Curry=require("./curry.js");var Caml_bytes=require("./caml_bytes.js");var Caml_primitive=require("./caml_primitive.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function make(n,c){var s=Caml_bytes.caml_create_bytes(n);Caml_bytes.caml_fill_bytes(s,0,n,c);return s}function init(n,f){var s=Caml_bytes.caml_create_bytes(n);for(var i=0,i_finish=n-1|0;i<=i_finish;++i){s[i]=Curry._1(f,i)}return s}var empty=[];function copy(s){var len=s.length;var r=Caml_bytes.caml_create_bytes(len);Caml_bytes.caml_blit_bytes(s,0,r,0,len);return r}function to_string(b){return Caml_bytes.bytes_to_string(copy(b))}function of_string(s){return copy(Caml_bytes.bytes_of_string(s))}function sub(s,ofs,len){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"String.sub / Bytes.sub"]}var r=Caml_bytes.caml_create_bytes(len);Caml_bytes.caml_blit_bytes(s,ofs,r,0,len);return r}function sub_string(b,ofs,len){return Caml_bytes.bytes_to_string(sub(b,ofs,len))}function $plus$plus(a,b){var c=a+b|0;var match=a<0;var match$1=b<0;var match$2=c<0;if(match){if(match$1&&!match$2){throw[Caml_builtin_exceptions.invalid_argument,"Bytes.extend"]}else{return c}}else if(match$1){return c}else{if(match$2){throw[Caml_builtin_exceptions.invalid_argument,"Bytes.extend"]}return c}}function extend(s,left,right){var len=$plus$plus($plus$plus(s.length,left),right);var r=Caml_bytes.caml_create_bytes(len);var match=left<0?[-left|0,0]:[0,left];var dstoff=match[1];var srcoff=match[0];var cpylen=Caml_primitive.caml_int_min(s.length-srcoff|0,len-dstoff|0);if(cpylen>0){Caml_bytes.caml_blit_bytes(s,srcoff,r,dstoff,cpylen)}return r}function fill(s,ofs,len,c){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"String.fill / Bytes.fill"]}return Caml_bytes.caml_fill_bytes(s,ofs,len,c)}function blit(s1,ofs1,s2,ofs2,len){if(len<0||ofs1<0||ofs1>(s1.length-len|0)||ofs2<0||ofs2>(s2.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Bytes.blit"]}return Caml_bytes.caml_blit_bytes(s1,ofs1,s2,ofs2,len)}function blit_string(s1,ofs1,s2,ofs2,len){if(len<0||ofs1<0||ofs1>(s1.length-len|0)||ofs2<0||ofs2>(s2.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"String.blit / Bytes.blit_string"]}return Caml_bytes.caml_blit_string(s1,ofs1,s2,ofs2,len)}function iter(f,a){for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){Curry._1(f,a[i])}return 0}function iteri(f,a){for(var i=0,i_finish=a.length-1|0;i<=i_finish;++i){Curry._2(f,i,a[i])}return 0}function ensure_ge(x,y){if(x>=y){return x}else{throw[Caml_builtin_exceptions.invalid_argument,"Bytes.concat"]}}function sum_lengths(_acc,seplen,_param){while(true){var param=_param;var acc=_acc;if(param){var tl=param[1];var hd=param[0];if(tl){_param=tl;_acc=ensure_ge((hd.length+seplen|0)+acc|0,acc);continue}else{return hd.length+acc|0}}else{return acc}}}function concat(sep,l){if(l){var seplen=sep.length;var dst=Caml_bytes.caml_create_bytes(sum_lengths(0,seplen,l));var _pos=0;var sep$1=sep;var seplen$1=seplen;var _param=l;while(true){var param=_param;var pos=_pos;if(param){var tl=param[1];var hd=param[0];if(tl){Caml_bytes.caml_blit_bytes(hd,0,dst,pos,hd.length);Caml_bytes.caml_blit_bytes(sep$1,0,dst,pos+hd.length|0,seplen$1);_param=tl;_pos=(pos+hd.length|0)+seplen$1|0;continue}else{Caml_bytes.caml_blit_bytes(hd,0,dst,pos,hd.length);return dst}}else{return dst}}}else{return empty}}function cat(s1,s2){var l1=s1.length;var l2=s2.length;var r=Caml_bytes.caml_create_bytes(l1+l2|0);Caml_bytes.caml_blit_bytes(s1,0,r,0,l1);Caml_bytes.caml_blit_bytes(s2,0,r,l1,l2);return r}function is_space(param){var switcher=param-9|0;if(switcher>4||switcher<0){return switcher===23}else{return switcher!==2}}function trim(s){var len=s.length;var i=0;while(i<len&&is_space(s[i])){i=i+1|0}var j=len-1|0;while(j>=i&&is_space(s[j])){j=j-1|0}if(j>=i){return sub(s,i,(j-i|0)+1|0)}else{return empty}}function escaped(s){var n=0;for(var i=0,i_finish=s.length-1|0;i<=i_finish;++i){var match=s[i];var tmp;if(match>=32){var switcher=match-34|0;tmp=switcher>58||switcher<0?switcher>=93?4:1:switcher>57||switcher<1?2:1}else{tmp=match>=11?match!==13?4:2:match>=8?2:4}n=n+tmp|0}if(n===s.length){return copy(s)}else{var s$prime=Caml_bytes.caml_create_bytes(n);n=0;for(var i$1=0,i_finish$1=s.length-1|0;i$1<=i_finish$1;++i$1){var c=s[i$1];var exit=0;if(c>=35){if(c!==92){if(c>=127){exit=1}else{s$prime[n]=c}}else{exit=2}}else if(c>=32){if(c>=34){exit=2}else{s$prime[n]=c}}else if(c>=14){exit=1}else{switch(c){case 8:s$prime[n]=92;n=n+1|0;s$prime[n]=98;break;case 9:s$prime[n]=92;n=n+1|0;s$prime[n]=116;break;case 10:s$prime[n]=92;n=n+1|0;s$prime[n]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:exit=1;break;case 13:s$prime[n]=92;n=n+1|0;s$prime[n]=114;break}}switch(exit){case 1:s$prime[n]=92;n=n+1|0;s$prime[n]=48+(c/100|0)|0;n=n+1|0;s$prime[n]=48+(c/10|0)%10|0;n=n+1|0;s$prime[n]=48+c%10|0;break;case 2:s$prime[n]=92;n=n+1|0;s$prime[n]=c;break}n=n+1|0}return s$prime}}function map(f,s){var l=s.length;if(l===0){return s}else{var r=Caml_bytes.caml_create_bytes(l);for(var i=0,i_finish=l-1|0;i<=i_finish;++i){r[i]=Curry._1(f,s[i])}return r}}function mapi(f,s){var l=s.length;if(l===0){return s}else{var r=Caml_bytes.caml_create_bytes(l);for(var i=0,i_finish=l-1|0;i<=i_finish;++i){r[i]=Curry._2(f,i,s[i])}return r}}function uppercase_ascii(s){return map(Char.uppercase_ascii,s)}function lowercase_ascii(s){return map(Char.lowercase_ascii,s)}function apply1(f,s){if(s.length===0){return s}else{var r=copy(s);r[0]=Curry._1(f,s[0]);return r}}function capitalize_ascii(s){return apply1(Char.uppercase_ascii,s)}function uncapitalize_ascii(s){return apply1(Char.lowercase_ascii,s)}function index_rec(s,lim,_i,c){while(true){var i=_i;if(i>=lim){throw Caml_builtin_exceptions.not_found}if(s[i]===c){return i}else{_i=i+1|0;continue}}}function index(s,c){return index_rec(s,s.length,0,c)}function index_rec_opt(s,lim,_i,c){while(true){var i=_i;if(i>=lim){return}else if(s[i]===c){return i}else{_i=i+1|0;continue}}}function index_opt(s,c){return index_rec_opt(s,s.length,0,c)}function index_from(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.index_from / Bytes.index_from"]}return index_rec(s,l,i,c)}function index_from_opt(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.index_from_opt / Bytes.index_from_opt"]}return index_rec_opt(s,l,i,c)}function rindex_rec(s,_i,c){while(true){var i=_i;if(i<0){throw Caml_builtin_exceptions.not_found}if(s[i]===c){return i}else{_i=i-1|0;continue}}}function rindex(s,c){return rindex_rec(s,s.length-1|0,c)}function rindex_from(s,i,c){if(i<-1||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rindex_from / Bytes.rindex_from"]}return rindex_rec(s,i,c)}function rindex_rec_opt(s,_i,c){while(true){var i=_i;if(i<0){return}else if(s[i]===c){return i}else{_i=i-1|0;continue}}}function rindex_opt(s,c){return rindex_rec_opt(s,s.length-1|0,c)}function rindex_from_opt(s,i,c){if(i<-1||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rindex_from_opt / Bytes.rindex_from_opt"]}return rindex_rec_opt(s,i,c)}function contains_from(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.contains_from / Bytes.contains_from"]}try{index_rec(s,l,i,c);return true}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return false}else{throw exn}}}function contains(s,c){return contains_from(s,0,c)}function rcontains_from(s,i,c){if(i<0||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rcontains_from / Bytes.rcontains_from"]}try{rindex_rec(s,i,c);return true}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return false}else{throw exn}}}var compare=Caml_primitive.caml_bytes_compare;function uppercase(s){return map(Char.uppercase,s)}function lowercase(s){return map(Char.lowercase,s)}function capitalize(s){return apply1(Char.uppercase,s)}function uncapitalize(s){return apply1(Char.lowercase,s)}var equal=Caml_primitive.caml_bytes_equal;var unsafe_to_string=Caml_bytes.bytes_to_string;var unsafe_of_string=Caml_bytes.bytes_of_string;exports.make=make;exports.init=init;exports.empty=empty;exports.copy=copy;exports.of_string=of_string;exports.to_string=to_string;exports.sub=sub;exports.sub_string=sub_string;exports.extend=extend;exports.fill=fill;exports.blit=blit;exports.blit_string=blit_string;exports.concat=concat;exports.cat=cat;exports.iter=iter;exports.iteri=iteri;exports.map=map;exports.mapi=mapi;exports.trim=trim;exports.escaped=escaped;exports.index=index;exports.index_opt=index_opt;exports.rindex=rindex;exports.rindex_opt=rindex_opt;exports.index_from=index_from;exports.index_from_opt=index_from_opt;exports.rindex_from=rindex_from;exports.rindex_from_opt=rindex_from_opt;exports.contains=contains;exports.contains_from=contains_from;exports.rcontains_from=rcontains_from;exports.uppercase=uppercase;exports.lowercase=lowercase;exports.capitalize=capitalize;exports.uncapitalize=uncapitalize;exports.uppercase_ascii=uppercase_ascii;exports.lowercase_ascii=lowercase_ascii;exports.capitalize_ascii=capitalize_ascii;exports.uncapitalize_ascii=uncapitalize_ascii;exports.compare=compare;exports.equal=equal;exports.unsafe_to_string=unsafe_to_string;exports.unsafe_of_string=unsafe_of_string},{"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_primitive.js":19,"./char.js":26,"./curry.js":27}],5:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function caml_array_sub(x,offset,len){var result=new Array(len);var j=0;var i=offset;while(j<len){result[j]=x[i];j=j+1|0;i=i+1|0}return result}function len(_acc,_l){while(true){var l=_l;var acc=_acc;if(l){_l=l[1];_acc=l[0].length+acc|0;continue}else{return acc}}}function fill(arr,_i,_l){while(true){var l=_l;var i=_i;if(l){var x=l[0];var l$1=x.length;var k=i;var j=0;while(j<l$1){arr[k]=x[j];k=k+1|0;j=j+1|0}_l=l[1];_i=k;continue}else{return 0}}}function caml_array_concat(l){var v=len(0,l);var result=new Array(v);fill(result,0,l);return result}function caml_array_set(xs,index,newval){if(index<0||index>=xs.length){throw[Caml_builtin_exceptions.invalid_argument,"index out of bounds"]}xs[index]=newval;return 0}function caml_array_get(xs,index){if(index<0||index>=xs.length){throw[Caml_builtin_exceptions.invalid_argument,"index out of bounds"]}return xs[index]}function caml_make_vect(len,init){var b=new Array(len);for(var i=0,i_finish=len-1|0;i<=i_finish;++i){b[i]=init}return b}function caml_make_float_vect(len){var b=new Array(len);for(var i=0,i_finish=len-1|0;i<=i_finish;++i){b[i]=0}return b}function caml_array_blit(a1,i1,a2,i2,len){if(i2<=i1){for(var j=0,j_finish=len-1|0;j<=j_finish;++j){a2[j+i2|0]=a1[j+i1|0]}return 0}else{for(var j$1=len-1|0;j$1>=0;--j$1){a2[j$1+i2|0]=a1[j$1+i1|0]}return 0}}function caml_array_dup(prim){return prim.slice(0)}exports.caml_array_dup=caml_array_dup;exports.caml_array_sub=caml_array_sub;exports.caml_array_concat=caml_array_concat;exports.caml_make_vect=caml_make_vect;exports.caml_make_float_vect=caml_make_float_vect;exports.caml_array_blit=caml_array_blit;exports.caml_array_get=caml_array_get;exports.caml_array_set=caml_array_set},{"./caml_builtin_exceptions.js":6}],6:[function(require,module,exports){"use strict";var out_of_memory=["Out_of_memory",0];var sys_error=["Sys_error",-1];var failure=["Failure",-2];var invalid_argument=["Invalid_argument",-3];var end_of_file=["End_of_file",-4];var division_by_zero=["Division_by_zero",-5];var not_found=["Not_found",-6];var match_failure=["Match_failure",-7];var stack_overflow=["Stack_overflow",-8];var sys_blocked_io=["Sys_blocked_io",-9];var assert_failure=["Assert_failure",-10];var undefined_recursive_module=["Undefined_recursive_module",-11];out_of_memory.tag=248;sys_error.tag=248;failure.tag=248;invalid_argument.tag=248;end_of_file.tag=248;division_by_zero.tag=248;not_found.tag=248;match_failure.tag=248;stack_overflow.tag=248;sys_blocked_io.tag=248;assert_failure.tag=248;undefined_recursive_module.tag=248;exports.out_of_memory=out_of_memory;exports.sys_error=sys_error;exports.failure=failure;exports.invalid_argument=invalid_argument;exports.end_of_file=end_of_file;exports.division_by_zero=division_by_zero;exports.not_found=not_found;exports.match_failure=match_failure;exports.stack_overflow=stack_overflow;exports.sys_blocked_io=sys_blocked_io;exports.assert_failure=assert_failure;exports.undefined_recursive_module=undefined_recursive_module},{}],7:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function get(s,i){if(i<0||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"index out of bounds"]}return s[i]}function caml_fill_bytes(s,i,l,c){if(l>0){for(var k=i,k_finish=(l+i|0)-1|0;k<=k_finish;++k){s[k]=c}return 0}else{return 0}}function caml_create_bytes(len){if(len<0){throw[Caml_builtin_exceptions.invalid_argument,"String.create"]}var result=new Array(len);for(var i=0,i_finish=len-1|0;i<=i_finish;++i){result[i]=0}return result}function caml_blit_bytes(s1,i1,s2,i2,len){if(len>0){if(s1===s2){var s1$1=s1;var i1$1=i1;var i2$1=i2;var len$1=len;if(i1$1<i2$1){var range_a=(s1$1.length-i2$1|0)-1|0;var range_b=len$1-1|0;var range=range_a>range_b?range_b:range_a;for(var j=range;j>=0;--j){s1$1[i2$1+j|0]=s1$1[i1$1+j|0]}return 0}else if(i1$1>i2$1){var range_a$1=(s1$1.length-i1$1|0)-1|0;var range_b$1=len$1-1|0;var range$1=range_a$1>range_b$1?range_b$1:range_a$1;for(var k=0;k<=range$1;++k){s1$1[i2$1+k|0]=s1$1[i1$1+k|0]}return 0}else{return 0}}else{var off1=s1.length-i1|0;if(len<=off1){for(var i=0,i_finish=len-1|0;i<=i_finish;++i){s2[i2+i|0]=s1[i1+i|0]}return 0}else{for(var i$1=0,i_finish$1=off1-1|0;i$1<=i_finish$1;++i$1){s2[i2+i$1|0]=s1[i1+i$1|0]}for(var i$2=off1,i_finish$2=len-1|0;i$2<=i_finish$2;++i$2){s2[i2+i$2|0]=0}return 0}}}else{return 0}}function bytes_to_string(a){var bytes=a;var i=0;var len=a.length;var s="";var s_len=len;if(i===0&&len<=4096&&len===bytes.length){return String.fromCharCode.apply(null,bytes)}else{var offset=0;while(s_len>0){var next=s_len<1024?s_len:1024;var tmp_bytes=new Array(next);caml_blit_bytes(bytes,offset,tmp_bytes,0,next);s=s+String.fromCharCode.apply(null,tmp_bytes);s_len=s_len-next|0;offset=offset+next|0}return s}}function caml_blit_string(s1,i1,s2,i2,len){if(len>0){var off1=s1.length-i1|0;if(len<=off1){for(var i=0,i_finish=len-1|0;i<=i_finish;++i){s2[i2+i|0]=s1.charCodeAt(i1+i|0)}return 0}else{for(var i$1=0,i_finish$1=off1-1|0;i$1<=i_finish$1;++i$1){s2[i2+i$1|0]=s1.charCodeAt(i1+i$1|0)}for(var i$2=off1,i_finish$2=len-1|0;i$2<=i_finish$2;++i$2){s2[i2+i$2|0]=0}return 0}}else{return 0}}function bytes_of_string(s){var len=s.length;var res=new Array(len);for(var i=0,i_finish=len-1|0;i<=i_finish;++i){
res[i]=s.charCodeAt(i)}return res}exports.caml_create_bytes=caml_create_bytes;exports.caml_fill_bytes=caml_fill_bytes;exports.get=get;exports.bytes_to_string=bytes_to_string;exports.caml_blit_bytes=caml_blit_bytes;exports.caml_blit_string=caml_blit_string;exports.bytes_of_string=bytes_of_string},{"./caml_builtin_exceptions.js":6}],8:[function(require,module,exports){"use strict";var id={contents:0};function caml_set_oo_id(b){b[1]=id.contents;id.contents=id.contents+1;return b}function caml_fresh_oo_id(param){id.contents=id.contents+1;return id.contents}function create(str){var v_001=caml_fresh_oo_id(0);var v=[str,v_001];v.tag=248;return v}function caml_is_extension(e){if(e===undefined){return false}else if(e.tag===248){return true}else{var slot=e[0];if(slot!==undefined){return slot.tag===248}else{return false}}}exports.caml_set_oo_id=caml_set_oo_id;exports.caml_fresh_oo_id=caml_fresh_oo_id;exports.create=create;exports.caml_is_extension=caml_is_extension},{}],9:[function(require,module,exports){(function(global){"use strict";function getGlobalThis(){if(typeof globalThis!=="undefined")return globalThis;if(typeof self!=="undefined")return self;if(typeof window!=="undefined")return window;if(typeof global!=="undefined")return global;if(typeof this!=="undefined")return this;throw new Error("Unable to locate global `this`")}function resolve(s){var myGlobal=getGlobalThis();if(myGlobal[s]===undefined){throw new Error(s+" not polyfilled by BuckleScript yet\n")}return myGlobal[s]}function register(s,fn){var myGlobal=getGlobalThis();myGlobal[s]=fn;return 0}exports.getGlobalThis=getGlobalThis;exports.resolve=resolve;exports.register=register}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],10:[function(require,module,exports){"use strict";var Caml_int32=require("./caml_int32.js");var Caml_int64=require("./caml_int64.js");var Caml_utils=require("./caml_utils.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function parse_digit(c){if(c>=65){if(c>=97){if(c>=123){return-1}else{return c-87|0}}else if(c>=91){return-1}else{return c-55|0}}else if(c>57||c<48){return-1}else{return c-48|0}}function int_of_string_base(param){switch(param){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}function parse_sign_and_base(s){var sign=1;var base=2;var i=0;var match=s.charCodeAt(i);switch(match){case 43:i=i+1|0;break;case 44:break;case 45:sign=-1;i=i+1|0;break;default:}if(s[i]==="0"){var match$1=s.charCodeAt(i+1|0);if(match$1>=89){if(match$1>=111){if(match$1<121){switch(match$1-111|0){case 0:base=0;i=i+2|0;break;case 6:i=i+2|0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 8:break;case 9:base=1;i=i+2|0;break}}}else if(match$1===98){base=3;i=i+2|0}}else if(match$1!==66){if(match$1>=79){switch(match$1-79|0){case 0:base=0;i=i+2|0;break;case 6:i=i+2|0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 8:break;case 9:base=1;i=i+2|0;break}}}else{base=3;i=i+2|0}}return[i,sign,base]}function caml_int_of_string(s){var match=parse_sign_and_base(s);var i=match[0];var base=int_of_string_base(match[2]);var threshold=4294967295;var len=s.length;var c=i<len?s.charCodeAt(i):0;var d=parse_digit(c);if(d<0||d>=base){throw[Caml_builtin_exceptions.failure,"int_of_string"]}var aux=function(_acc,_k){while(true){var k=_k;var acc=_acc;if(k===len){return acc}else{var a=s.charCodeAt(k);if(a===95){_k=k+1|0;continue}else{var v=parse_digit(a);if(v<0||v>=base){throw[Caml_builtin_exceptions.failure,"int_of_string"]}var acc$1=base*acc+v;if(acc$1>threshold){throw[Caml_builtin_exceptions.failure,"int_of_string"]}_k=k+1|0;_acc=acc$1;continue}}}};var res=match[1]*aux(d,i+1|0);var or_res=res|0;if(base===10&&res!==or_res){throw[Caml_builtin_exceptions.failure,"int_of_string"]}return or_res}function caml_int64_of_string(s){var match=parse_sign_and_base(s);var hbase=match[2];var i=match[0];var base=Caml_int64.of_int32(int_of_string_base(hbase));var sign=Caml_int64.of_int32(match[1]);var threshold;switch(hbase){case 0:threshold={hi:536870911,lo:4294967295};break;case 1:threshold={hi:268435455,lo:4294967295};break;case 2:threshold={hi:429496729,lo:2576980377};break;case 3:threshold={hi:2147483647,lo:4294967295};break}var len=s.length;var c=i<len?s.charCodeAt(i):0;var d=Caml_int64.of_int32(parse_digit(c));if(Caml_int64.lt(d,{hi:0,lo:0})||Caml_int64.ge(d,base)){throw[Caml_builtin_exceptions.failure,"int64_of_string"]}var aux=function(_acc,_k){while(true){var k=_k;var acc=_acc;if(k===len){return acc}else{var a=s.charCodeAt(k);if(a===95){_k=k+1|0;continue}else{var v=Caml_int64.of_int32(parse_digit(a));if(Caml_int64.lt(v,{hi:0,lo:0})||Caml_int64.ge(v,base)||Caml_int64.gt(acc,threshold)){throw[Caml_builtin_exceptions.failure,"int64_of_string"]}var acc$1=Caml_int64.add(Caml_int64.mul(base,acc),v);_k=k+1|0;_acc=acc$1;continue}}}};var res=Caml_int64.mul(sign,aux(d,i+1|0));var or_res=Caml_int64.or_(res,{hi:0,lo:0});if(Caml_int64.eq(base,{hi:0,lo:10})&&Caml_int64.neq(res,or_res)){throw[Caml_builtin_exceptions.failure,"int64_of_string"]}return or_res}function int_of_base(param){switch(param){case 0:return 8;case 1:return 16;case 2:return 10}}function lowercase(c){if(c>=65&&c<=90||c>=192&&c<=214||c>=216&&c<=222){return c+32|0}else{return c}}function parse_format(fmt){var len=fmt.length;if(len>31){throw[Caml_builtin_exceptions.invalid_argument,"format_int: format too long"]}var f={justify:"+",signstyle:"-",filter:" ",alternate:false,base:2,signedconv:false,width:0,uppercase:false,sign:1,prec:-1,conv:"f"};var _i=0;while(true){var i=_i;if(i>=len){return f}else{var c=fmt.charCodeAt(i);var exit=0;if(c>=69){if(c>=88){if(c>=121){exit=1}else{switch(c-88|0){case 0:f.base=1;f.uppercase=true;_i=i+1|0;continue;case 13:case 14:case 15:exit=5;break;case 12:case 17:exit=4;break;case 23:f.base=0;_i=i+1|0;continue;case 29:f.base=2;_i=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:exit=1;break;case 32:f.base=1;_i=i+1|0;continue}}}else if(c>=72){exit=1}else{f.signedconv=true;f.uppercase=true;f.conv=String.fromCharCode(lowercase(c));_i=i+1|0;continue}}else{switch(c){case 35:f.alternate=true;_i=i+1|0;continue;case 32:case 43:exit=2;break;case 45:f.justify="-";_i=i+1|0;continue;case 46:f.prec=0;var j=i+1|0;while(function(j){return function(){var w=fmt.charCodeAt(j)-48|0;return w>=0&&w<=9}}(j)()){f.prec=(Caml_int32.imul(f.prec,10)+fmt.charCodeAt(j)|0)-48|0;j=j+1|0};_i=j;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:exit=1;break;case 48:f.filter="0";_i=i+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:exit=3;break;default:exit=1}}switch(exit){case 1:_i=i+1|0;continue;case 2:f.signstyle=String.fromCharCode(c);_i=i+1|0;continue;case 3:f.width=0;var j$1=i;while(function(j$1){return function(){var w=fmt.charCodeAt(j$1)-48|0;return w>=0&&w<=9}}(j$1)()){f.width=(Caml_int32.imul(f.width,10)+fmt.charCodeAt(j$1)|0)-48|0;j$1=j$1+1|0};_i=j$1;continue;case 4:f.signedconv=true;f.base=2;_i=i+1|0;continue;case 5:f.signedconv=true;f.conv=String.fromCharCode(c);_i=i+1|0;continue}}}}function finish_formatting(config,rawbuffer){var justify=config.justify;var signstyle=config.signstyle;var filter=config.filter;var alternate=config.alternate;var base=config.base;var signedconv=config.signedconv;var width=config.width;var uppercase=config.uppercase;var sign=config.sign;var len=rawbuffer.length;if(signedconv&&(sign<0||signstyle!=="-")){len=len+1|0}if(alternate){if(base===0){len=len+1|0}else if(base===1){len=len+2|0}}var buffer="";if(justify==="+"&&filter===" "){for(var i=len,i_finish=width-1|0;i<=i_finish;++i){buffer=buffer+filter}}if(signedconv){if(sign<0){buffer=buffer+"-"}else if(signstyle!=="-"){buffer=buffer+signstyle}}if(alternate&&base===0){buffer=buffer+"0"}if(alternate&&base===1){buffer=buffer+"0x"}if(justify==="+"&&filter==="0"){for(var i$1=len,i_finish$1=width-1|0;i$1<=i_finish$1;++i$1){buffer=buffer+filter}}buffer=uppercase?buffer+rawbuffer.toUpperCase():buffer+rawbuffer;if(justify==="-"){for(var i$2=len,i_finish$2=width-1|0;i$2<=i_finish$2;++i$2){buffer=buffer+" "}}return buffer}function caml_format_int(fmt,i){if(fmt==="%d"){return String(i)}else{var f=parse_format(fmt);var f$1=f;var i$1=i;var i$2=i$1<0?f$1.signedconv?(f$1.sign=-1,-i$1):i$1>>>0:i$1;var s=i$2.toString(int_of_base(f$1.base));if(f$1.prec>=0){f$1.filter=" ";var n=f$1.prec-s.length|0;if(n>0){s=Caml_utils.repeat(n,"0")+s}}return finish_formatting(f$1,s)}}function caml_int64_format(fmt,x){var f=parse_format(fmt);var x$1=f.signedconv&&Caml_int64.lt(x,{hi:0,lo:0})?(f.sign=-1,Caml_int64.neg(x)):x;var s="";var match=f.base;switch(match){case 0:var wbase={hi:0,lo:8};var cvtbl="01234567";if(Caml_int64.lt(x$1,{hi:0,lo:0})){var y=Caml_int64.discard_sign(x$1);var match$1=Caml_int64.div_mod(y,wbase);var quotient=Caml_int64.add({hi:268435456,lo:0},match$1[0]);var modulus=match$1[1];s=String.fromCharCode(cvtbl.charCodeAt(Caml_int64.to_int32(modulus)))+s;while(Caml_int64.neq(quotient,{hi:0,lo:0})){var match$2=Caml_int64.div_mod(quotient,wbase);quotient=match$2[0];modulus=match$2[1];s=String.fromCharCode(cvtbl.charCodeAt(Caml_int64.to_int32(modulus)))+s}}else{var match$3=Caml_int64.div_mod(x$1,wbase);var quotient$1=match$3[0];var modulus$1=match$3[1];s=String.fromCharCode(cvtbl.charCodeAt(Caml_int64.to_int32(modulus$1)))+s;while(Caml_int64.neq(quotient$1,{hi:0,lo:0})){var match$4=Caml_int64.div_mod(quotient$1,wbase);quotient$1=match$4[0];modulus$1=match$4[1];s=String.fromCharCode(cvtbl.charCodeAt(Caml_int64.to_int32(modulus$1)))+s}}break;case 1:s=Caml_int64.to_hex(x$1)+s;break;case 2:var wbase$1={hi:0,lo:10};var cvtbl$1="0123456789";if(Caml_int64.lt(x$1,{hi:0,lo:0})){var y$1=Caml_int64.discard_sign(x$1);var match$5=Caml_int64.div_mod(y$1,wbase$1);var match$6=Caml_int64.div_mod(Caml_int64.add({hi:0,lo:8},match$5[1]),wbase$1);var quotient$2=Caml_int64.add(Caml_int64.add({hi:214748364,lo:3435973836},match$5[0]),match$6[0]);var modulus$2=match$6[1];s=String.fromCharCode(cvtbl$1.charCodeAt(Caml_int64.to_int32(modulus$2)))+s;while(Caml_int64.neq(quotient$2,{hi:0,lo:0})){var match$7=Caml_int64.div_mod(quotient$2,wbase$1);quotient$2=match$7[0];modulus$2=match$7[1];s=String.fromCharCode(cvtbl$1.charCodeAt(Caml_int64.to_int32(modulus$2)))+s}}else{var match$8=Caml_int64.div_mod(x$1,wbase$1);var quotient$3=match$8[0];var modulus$3=match$8[1];s=String.fromCharCode(cvtbl$1.charCodeAt(Caml_int64.to_int32(modulus$3)))+s;while(Caml_int64.neq(quotient$3,{hi:0,lo:0})){var match$9=Caml_int64.div_mod(quotient$3,wbase$1);quotient$3=match$9[0];modulus$3=match$9[1];s=String.fromCharCode(cvtbl$1.charCodeAt(Caml_int64.to_int32(modulus$3)))+s}}break}if(f.prec>=0){f.filter=" ";var n=f.prec-s.length|0;if(n>0){s=Caml_utils.repeat(n,"0")+s}}return finish_formatting(f,s)}function caml_format_float(fmt,x){var f=parse_format(fmt);var prec=f.prec<0?6:f.prec;var x$1=x<0?(f.sign=-1,-x):x;var s="";if(isNaN(x$1)){s="nan";f.filter=" "}else if(isFinite(x$1)){var match=f.conv;switch(match){case"e":s=x$1.toExponential(prec);var i=s.length;if(s[i-3|0]==="e"){s=s.slice(0,i-1|0)+("0"+s.slice(i-1|0))}break;case"f":s=x$1.toFixed(prec);break;case"g":var prec$1=prec!==0?prec:1;s=x$1.toExponential(prec$1-1|0);var j=s.indexOf("e");var exp=Number(s.slice(j+1|0))|0;if(exp<-4||x$1>=1e21||x$1.toFixed().length>prec$1){var i$1=j-1|0;while(s[i$1]==="0"){i$1=i$1-1|0}if(s[i$1]==="."){i$1=i$1-1|0}s=s.slice(0,i$1+1|0)+s.slice(j);var i$2=s.length;if(s[i$2-3|0]==="e"){s=s.slice(0,i$2-1|0)+("0"+s.slice(i$2-1|0))}}else{var p=prec$1;if(exp<0){p=p-(exp+1|0)|0;s=x$1.toFixed(p)}else{while(function(){s=x$1.toFixed(p);return s.length>(prec$1+1|0)}()){p=p-1|0}}if(p!==0){var k=s.length-1|0;while(s[k]==="0"){k=k-1|0}if(s[k]==="."){k=k-1|0}s=s.slice(0,k+1|0)}}break;default:}}else{s="inf";f.filter=" "}return finish_formatting(f,s)}function caml_hexstring_of_float(x,prec,style){if(!isFinite(x)){if(isNaN(x))return"nan";return x>0?"infinity":"-infinity"}var sign=x==0&&1/x==-Infinity?1:x>=0?0:1;if(sign)x=-x;var exp=0;if(x==0){}else if(x<1){while(x<1&&exp>-1022){x*=2;exp--}}else{while(x>=2){x/=2;exp++}}var exp_sign=exp<0?"":"+";var sign_str="";if(sign)sign_str="-";else{switch(style){case 43:sign_str="+";break;case 32:sign_str=" ";break;default:break}}if(prec>=0&&prec<13){var cst=Math.pow(2,prec*4);x=Math.round(x*cst)/cst}var x_str=x.toString(16);if(prec>=0){var idx=x_str.indexOf(".");if(idx<0){x_str+="."+"0".repeat(prec)}else{var size=idx+1+prec;if(x_str.length<size)x_str+="0".repeat(size-x_str.length);else x_str=x_str.substr(0,size)}}return sign_str+"0x"+x_str+"p"+exp_sign+exp.toString(10)}function float_of_string(s,exn){var res=+s;if(s.length>0&&res===res)return res;s=s.replace(/_/g,"");res=+s;if(s.length>0&&res===res||/^[+-]?nan$/i.test(s)){return res}var m=/^ *([+-]?)0x([0-9a-f]+)\.?([0-9a-f]*)p([+-]?[0-9]+)/i.exec(s);if(m){var m3=m[3].replace(/0+$/,"");var mantissa=parseInt(m[1]+m[2]+m3,16);var exponent=(m[4]|0)-4*m3.length;res=mantissa*Math.pow(2,exponent);return res}if(/^\+?inf(inity)?$/i.test(s))return Infinity;if(/^-inf(inity)?$/i.test(s))return-Infinity;throw exn}function caml_float_of_string(s){return float_of_string(s,[Caml_builtin_exceptions.failure,"float_of_string"])}var caml_nativeint_format=caml_format_int;var caml_int32_format=caml_format_int;var caml_int32_of_string=caml_int_of_string;var caml_nativeint_of_string=caml_int_of_string;exports.caml_format_float=caml_format_float;exports.caml_hexstring_of_float=caml_hexstring_of_float;exports.caml_format_int=caml_format_int;exports.caml_nativeint_format=caml_nativeint_format;exports.caml_int32_format=caml_int32_format;exports.caml_float_of_string=caml_float_of_string;exports.caml_int64_format=caml_int64_format;exports.caml_int_of_string=caml_int_of_string;exports.caml_int32_of_string=caml_int32_of_string;exports.caml_int64_of_string=caml_int64_of_string;exports.caml_nativeint_of_string=caml_nativeint_of_string},{"./caml_builtin_exceptions.js":6,"./caml_int32.js":11,"./caml_int64.js":12,"./caml_utils.js":22}],11:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function div(x,y){if(y===0){throw Caml_builtin_exceptions.division_by_zero}return x/y|0}function mod_(x,y){if(y===0){throw Caml_builtin_exceptions.division_by_zero}return x%y}function caml_bswap16(x){return(x&255)<<8|(x&65280)>>>8}function caml_int32_bswap(x){return(x&255)<<24|(x&65280)<<8|(x&16711680)>>>8|(x&4278190080)>>>24}var imul=Math.imul||function(x,y){y|=0;return((x>>16)*y<<16)+(x&65535)*y|0};var caml_nativeint_bswap=caml_int32_bswap;exports.div=div;exports.mod_=mod_;exports.caml_bswap16=caml_bswap16;exports.caml_int32_bswap=caml_int32_bswap;exports.caml_nativeint_bswap=caml_nativeint_bswap;exports.imul=imul},{"./caml_builtin_exceptions.js":6}],12:[function(require,module,exports){"use strict";var Caml_int32=require("./caml_int32.js");var Caml_utils=require("./caml_utils.js");var Caml_primitive=require("./caml_primitive.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");var min_int={hi:-2147483648,lo:0};var max_int={hi:2147483647,lo:1};var one={hi:0,lo:1};var zero={hi:0,lo:0};var neg_one={hi:-1,lo:4294967295};function neg_signed(x){return(x&2147483648)!==0}function add(param,param$1){var other_low_=param$1.lo;var this_low_=param.lo;var lo=this_low_+other_low_&4294967295;var overflow=neg_signed(this_low_)&&(neg_signed(other_low_)||!neg_signed(lo))||neg_signed(other_low_)&&!neg_signed(lo)?1:0;var hi=param.hi+param$1.hi+overflow&4294967295;return{hi:hi,lo:lo>>>0}}function not(param){var hi=param.hi^-1;var lo=param.lo^-1;return{hi:hi,lo:lo>>>0}}function eq(x,y){if(x.hi===y.hi){return x.lo===y.lo}else{return false}}function equal_null(x,y){if(y!==null){return eq(x,y)}else{return false}}function equal_undefined(x,y){if(y!==undefined){return eq(x,y)}else{return false}}function equal_nullable(x,y){if(y==null){return false}else{return eq(x,y)}}function neg(x){if(eq(x,min_int)){return min_int}else{return add(not(x),one)}}function sub(x,y){return add(x,neg(y))}function lsl_(x,numBits){if(numBits===0){return x}else{var lo=x.lo;if(numBits>=32){return{hi:lo<<(numBits-32|0),lo:0}}else{var hi=lo>>>(32-numBits|0)|x.hi<<numBits;return{hi:hi,lo:lo<<numBits>>>0}}}}function lsr_(x,numBits){if(numBits===0){return x}else{var hi=x.hi;var offset=numBits-32|0;if(offset===0){return{hi:0,lo:hi>>>0}}else if(offset>0){var lo=hi>>>offset;return{hi:0,lo:lo>>>0}}else{var hi$1=hi>>>numBits;var lo$1=hi<<(-offset|0)|x.lo>>>numBits;return{hi:hi$1,lo:lo$1>>>0}}}}function asr_(x,numBits){if(numBits===0){return x}else{var hi=x.hi;if(numBits<32){var hi$1=hi>>numBits;var lo=hi<<(32-numBits|0)|x.lo>>>numBits;return{hi:hi$1,lo:lo>>>0}}else{var lo$1=hi>>(numBits-32|0);return{hi:hi>=0?0:-1,lo:lo$1>>>0}}}}function is_zero(param){if(param.hi!==0||param.lo!==0){return false}else{return true}}function mul(_this,_other){while(true){var other=_other;var $$this=_this;var lo;var this_hi=$$this.hi;var exit=0;var exit$1=0;var exit$2=0;if(this_hi!==0||$$this.lo!==0){exit$2=4}else{return zero}if(exit$2===4){if(other.hi!==0||other.lo!==0){exit$1=3}else{return zero}}if(exit$1===3){if(this_hi!==-2147483648||$$this.lo!==0){exit=2}else{lo=other.lo}}if(exit===2){var other_hi=other.hi;var lo$1=$$this.lo;var exit$3=0;if(other_hi!==-2147483648||other.lo!==0){exit$3=3}else{lo=lo$1}if(exit$3===3){var other_lo=other.lo;if(this_hi<0){if(other_hi<0){_other=neg(other);_this=neg($$this);continue}else{return neg(mul(neg($$this),other))}}else if(other_hi<0){return neg(mul($$this,neg(other)))}else{var a48=this_hi>>>16;var a32=this_hi&65535;var a16=lo$1>>>16;var a00=lo$1&65535;var b48=other_hi>>>16;var b32=other_hi&65535;var b16=other_lo>>>16;var b00=other_lo&65535;var c48=0;var c32=0;var c16=0;var c00=a00*b00;c16=(c00>>>16)+a16*b00;c32=c16>>>16;c16=(c16&65535)+a00*b16;c32=c32+(c16>>>16)+a32*b00;c48=c32>>>16;c32=(c32&65535)+a16*b16;c48=c48+(c32>>>16);c32=(c32&65535)+a00*b32;c48=c48+(c32>>>16);c32=c32&65535;c48=c48+(a48*b00+a32*b16+a16*b32+a00*b48)&65535;var hi=c32|c48<<16;var lo$2=c00&65535|(c16&65535)<<16;return{hi:hi,lo:lo$2>>>0}}}}if((lo&1)===0){return zero}else{return min_int}}}function swap(param){var hi=Caml_int32.caml_int32_bswap(param.lo);var lo=Caml_int32.caml_int32_bswap(param.hi);return{hi:hi,lo:lo>>>0}}function xor(param,param$1){return{hi:param.hi^param$1.hi,lo:(param.lo^param$1.lo)>>>0}}function or_(param,param$1){return{hi:param.hi|param$1.hi,lo:(param.lo|param$1.lo)>>>0}}function and_(param,param$1){return{hi:param.hi&param$1.hi,lo:(param.lo&param$1.lo)>>>0}}function ge(param,param$1){var other_hi=param$1.hi;var hi=param.hi;if(hi>other_hi){return true}else if(hi<other_hi){return false}else{return param.lo>=param$1.lo}}function neq(x,y){return!eq(x,y)}function lt(x,y){return!ge(x,y)}function gt(x,y){if(x.hi>y.hi){return true}else if(x.hi<y.hi){return false}else{return x.lo>y.lo}}function le(x,y){return!gt(x,y)}function min(x,y){if(ge(x,y)){return y}else{return x}}function max(x,y){if(gt(x,y)){return x}else{return y}}function to_float(param){return param.hi*4294967296+param.lo}function of_float(x){if(isNaN(x)||!isFinite(x)){return zero}else if(x<=-0x8000000000000000){return min_int}else if(x+1>=0x8000000000000000){return max_int}else if(x<0){return neg(of_float(-x))}else{var hi=x/4294967296|0;var lo=x%4294967296|0;return{hi:hi,lo:lo>>>0}}}function div(_self,_other){while(true){var other=_other;var self=_self;var self_hi=self.hi;var exit=0;var exit$1=0;if(other.hi!==0||other.lo!==0){exit$1=2}else{throw Caml_builtin_exceptions.division_by_zero}if(exit$1===2){if(self_hi!==-2147483648){if(self_hi!==0||self.lo!==0){exit=1}else{return zero}}else if(self.lo!==0){exit=1}else if(eq(other,one)||eq(other,neg_one)){return self}else if(eq(other,min_int)){return one}else{var other_hi=other.hi;var half_this=asr_(self,1);var approx=lsl_(div(half_this,other),1);if(approx.hi===0&&approx.lo===0){if(other_hi<0){return one}else{return neg(one)}}var y=mul(other,approx);var rem=add(self,neg(y));return add(approx,div(rem,other))}}if(exit===1){var other_hi$1=other.hi;if(other_hi$1===-2147483648&&other.lo===0){return zero}if(self_hi<0){if(other_hi$1<0){_other=neg(other);_self=neg(self);continue}else{return neg(div(neg(self),other))}}else if(other_hi$1<0){return neg(div(self,neg(other)))}else{var res=zero;var rem$1=self;while(ge(rem$1,other)){var approx$1=Caml_primitive.caml_float_max(1,Math.floor(to_float(rem$1)/to_float(other)));var log2=Math.ceil(Math.log(approx$1)/Math.LN2);var delta=log2<=48?1:Math.pow(2,log2-48);var approxRes=of_float(approx$1);var approxRem=mul(approxRes,other);while(approxRem.hi<0||gt(approxRem,rem$1)){approx$1=approx$1-delta;approxRes=of_float(approx$1);approxRem=mul(approxRes,other)}if(is_zero(approxRes)){approxRes=one}res=add(res,approxRes);rem$1=add(rem$1,neg(approxRem))}return res}}}}function mod_(self,other){var y=mul(div(self,other),other);return add(self,neg(y))}function div_mod(self,other){var quotient=div(self,other);var y=mul(quotient,other);return[quotient,add(self,neg(y))]}function compare(self,other){var v=Caml_primitive.caml_nativeint_compare(self.hi,other.hi);if(v===0){return Caml_primitive.caml_nativeint_compare(self.lo,other.lo)}else{return v}}function of_int32(lo){return{hi:lo<0?-1:0,lo:lo>>>0}}function to_int32(x){return x.lo|0}function to_hex(x){var x_lo=x.lo;var x_hi=x.hi;var aux=function(v){return(v>>>0).toString(16)};if(x_hi===0&&x_lo===0){return"0"}if(x_lo!==0){if(x_hi!==0){var lo=aux(x_lo);var pad=8-lo.length|0;if(pad<=0){return aux(x_hi)+lo}else{return aux(x_hi)+(Caml_utils.repeat(pad,"0")+lo)}}else{return aux(x_lo)}}else{return aux(x_hi)+"00000000"}}function discard_sign(x){return{hi:2147483647&x.hi,lo:x.lo}}function float_of_bits(x){return function(lo,hi){return new Float64Array(new Int32Array([lo,hi]).buffer)[0]}(x.lo,x.hi)}function bits_of_float(x){var buf=new Int32Array(new Float64Array([x]).buffer);return{hi:buf[1],lo:buf[0]>>>0}}function get64(s,i){var hi=s.charCodeAt(i+4|0)<<32|s.charCodeAt(i+5|0)<<40|s.charCodeAt(i+6|0)<<48|s.charCodeAt(i+7|0)<<56;var lo=s.charCodeAt(i)|s.charCodeAt(i+1|0)<<8|s.charCodeAt(i+2|0)<<16|s.charCodeAt(i+3|0)<<24;return{hi:hi,lo:lo>>>0}}exports.min_int=min_int;exports.max_int=max_int;exports.one=one;exports.zero=zero;exports.not=not;exports.of_int32=of_int32;exports.to_int32=to_int32;exports.add=add;exports.neg=neg;exports.sub=sub;exports.lsl_=lsl_;exports.lsr_=lsr_;exports.asr_=asr_;exports.is_zero=is_zero;exports.mul=mul;exports.xor=xor;exports.or_=or_;exports.and_=and_;exports.swap=swap;exports.ge=ge;exports.eq=eq;exports.neq=neq;exports.lt=lt;exports.gt=gt;exports.le=le;exports.equal_null=equal_null;exports.equal_undefined=equal_undefined;exports.equal_nullable=equal_nullable;exports.min=min;exports.max=max;exports.to_float=to_float;exports.of_float=of_float;exports.div=div;exports.mod_=mod_;exports.compare=compare;exports.float_of_bits=float_of_bits;exports.bits_of_float=bits_of_float;exports.get64=get64;exports.div_mod=div_mod;exports.to_hex=to_hex;exports.discard_sign=discard_sign},{"./caml_builtin_exceptions.js":6,"./caml_int32.js":11,"./caml_primitive.js":19,"./caml_utils.js":22}],13:[function(require,module,exports){(function(process){"use strict";var Curry=require("./curry.js");var stdout={buffer:"",output:function(param,s){var v=s.length-1|0;if(typeof process!=="undefined"&&process.stdout&&process.stdout.write){return process.stdout.write(s)}else if(s[v]==="\n"){console.log(s.slice(0,v));return 0}else{console.log(s);return 0}}};var stderr={buffer:"",output:function(param,s){var v=s.length-1|0;if(s[v]==="\n"){console.log(s.slice(0,v));return 0}else{console.log(s);return 0}}};function caml_ml_flush(oc){if(oc.buffer!==""){Curry._2(oc.output,oc,oc.buffer);oc.buffer="";return 0}else{return 0}}function caml_ml_output(oc,str,offset,len){var str$1=offset===0&&len===str.length?str:str.slice(offset,len);if(typeof process!=="undefined"&&process.stdout&&process.stdout.write&&oc===stdout){return process.stdout.write(str$1)}else{var id=str$1.lastIndexOf("\n");if(id<0){oc.buffer=oc.buffer+str$1;return 0}else{oc.buffer=oc.buffer+str$1.slice(0,id+1|0);caml_ml_flush(oc);oc.buffer=oc.buffer+str$1.slice(id+1|0);return 0}}}function caml_ml_output_char(oc,$$char){return caml_ml_output(oc,String.fromCharCode($$char),0,1)}function caml_ml_out_channels_list(param){return[stdout,[stderr,0]]}var stdin=undefined;exports.stdin=stdin;exports.stdout=stdout;exports.stderr=stderr;exports.caml_ml_flush=caml_ml_flush;exports.caml_ml_output=caml_ml_output;exports.caml_ml_output_char=caml_ml_output_char;exports.caml_ml_out_channels_list=caml_ml_out_channels_list}).call(this,require("_process"))},{"./curry.js":27,_process:51}],14:[function(require,module,exports){"use strict";var Caml_option=require("./caml_option.js");var Caml_exceptions=require("./caml_exceptions.js");var $$Error=Caml_exceptions.create("Caml_js_exceptions.Error");function internalToOCamlException(e){if(Caml_exceptions.caml_is_extension(e)){return e}else{return[$$Error,e]}}function caml_as_js_exn(exn){if(exn[0]===$$Error){return Caml_option.some(exn[1])}}exports.$$Error=$$Error;exports.internalToOCamlException=internalToOCamlException;exports.caml_as_js_exn=caml_as_js_exn},{"./caml_exceptions.js":8,"./caml_option.js":18}],15:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function caml_lex_array(s){var l=s.length/2;var a=new Array(l);for(var i=0;i<l;i++)a[i]=(s.charCodeAt(2*i)|s.charCodeAt(2*i+1)<<8)<<16>>16;return a}function caml_lex_engine_aux(tbl,start_state,lexbuf,exn){var lex_buffer="lex_buffer";var lex_buffer_len="lex_buffer_len";var lex_start_pos="lex_start_pos";var lex_curr_pos="lex_curr_pos";var lex_last_pos="lex_last_pos";var lex_last_action="lex_last_action";var lex_eof_reached="lex_eof_reached";var lex_base="lex_base";var lex_backtrk="lex_backtrk";var lex_default="lex_default";var lex_trans="lex_trans";var lex_check="lex_check";if(!tbl.processed){tbl.lex_base=caml_lex_array(tbl[lex_base]);tbl.lex_backtrk=caml_lex_array(tbl[lex_backtrk]);tbl.lex_check=caml_lex_array(tbl[lex_check]);tbl.lex_trans=caml_lex_array(tbl[lex_trans]);tbl.lex_default=caml_lex_array(tbl[lex_default]);tbl.processed=true}var c;var state=start_state;var buffer=lexbuf[lex_buffer];if(state>=0){lexbuf[lex_last_pos]=lexbuf[lex_start_pos]=lexbuf[lex_curr_pos];lexbuf[lex_last_action]=-1}else{state=-state-1}for(;;){var base=tbl.lex_base[state];if(base<0)return-base-1;var backtrk=tbl.lex_backtrk[state];if(backtrk>=0){lexbuf[lex_last_pos]=lexbuf[lex_curr_pos];lexbuf[lex_last_action]=backtrk}if(lexbuf[lex_curr_pos]>=lexbuf[lex_buffer_len]){if(lexbuf[lex_eof_reached]===0)return-state-1;else c=256}else{c=buffer[lexbuf[lex_curr_pos]];lexbuf[lex_curr_pos]++}if(tbl.lex_check[base+c]===state){state=tbl.lex_trans[base+c]}else{state=tbl.lex_default[state]}if(state<0){lexbuf[lex_curr_pos]=lexbuf[lex_last_pos];if(lexbuf[lex_last_action]==-1)throw exn;else return lexbuf[lex_last_action]}else{if(c==256)lexbuf[lex_eof_reached]=0}}}var empty_token_lit="lexing: empty token";function caml_lex_engine(tbls,i,buf){return caml_lex_engine_aux(tbls,i,buf,[Caml_builtin_exceptions.failure,empty_token_lit])}function caml_lex_run_mem(s,i,mem,curr_pos){for(;;){var dst=s.charCodeAt(i);i++;if(dst==255)return;var src=s.charCodeAt(i);i++;if(src==255)mem[dst]=curr_pos;else mem[dst]=mem[src]}}function caml_lex_run_tag(s,i,mem){for(;;){var dst=s.charCodeAt(i);i++;if(dst==255)return;var src=s.charCodeAt(i);i++;if(src==255)mem[dst]=-1;else mem[dst]=mem[src]}}function caml_new_lex_engine_aux(tbl,start_state,lexbuf,exn){var lex_buffer="lex_buffer";var lex_buffer_len="lex_buffer_len";var lex_start_pos="lex_start_pos";var lex_curr_pos="lex_curr_pos";var lex_last_pos="lex_last_pos";var lex_last_action="lex_last_action";var lex_eof_reached="lex_eof_reached";var lex_mem="lex_mem";var lex_base="lex_base";var lex_backtrk="lex_backtrk";var lex_default="lex_default";var lex_trans="lex_trans";var lex_check="lex_check";var lex_base_code="lex_base_code";var lex_backtrk_code="lex_backtrk_code";var lex_default_code="lex_default_code";var lex_trans_code="lex_trans_code";var lex_check_code="lex_check_code";var lex_code="lex_code";if(!tbl.processed){tbl.lex_base=caml_lex_array(tbl[lex_base]);tbl.lex_backtrk=caml_lex_array(tbl[lex_backtrk]);tbl.lex_check=caml_lex_array(tbl[lex_check]);tbl.lex_trans=caml_lex_array(tbl[lex_trans]);tbl.lex_default=caml_lex_array(tbl[lex_default]);tbl.lex_base_code=caml_lex_array(tbl[lex_base_code]);tbl.lex_backtrk_code=caml_lex_array(tbl[lex_backtrk_code]);tbl.lex_check_code=caml_lex_array(tbl[lex_check_code]);tbl.lex_trans_code=caml_lex_array(tbl[lex_trans_code]);tbl.lex_default_code=caml_lex_array(tbl[lex_default_code]);tbl.processed=true}var c,state=start_state;var buffer=lexbuf[lex_buffer];if(state>=0){lexbuf[lex_last_pos]=lexbuf[lex_start_pos]=lexbuf[lex_curr_pos];lexbuf[lex_last_action]=-1}else{state=-state-1}for(;;){var base=tbl.lex_base[state];if(base<0){var pc_off=tbl.lex_base_code[state];caml_lex_run_tag(tbl.lex_code,pc_off,lexbuf[lex_mem]);return-base-1}var backtrk=tbl.lex_backtrk[state];if(backtrk>=0){var pc_off=tbl.lex_backtrk_code[state];caml_lex_run_tag(tbl.lex_code,pc_off,lexbuf[lex_mem]);lexbuf[lex_last_pos]=lexbuf[lex_curr_pos];lexbuf[lex_last_action]=backtrk}if(lexbuf[lex_curr_pos]>=lexbuf[lex_buffer_len]){if(lexbuf[lex_eof_reached]==0)return-state-1;else c=256}else{c=buffer[lexbuf[lex_curr_pos]];lexbuf[lex_curr_pos]++}var pstate=state;if(tbl.lex_check[base+c]==state)state=tbl.lex_trans[base+c];else state=tbl.lex_default[state];if(state<0){lexbuf[lex_curr_pos]=lexbuf[lex_last_pos];if(lexbuf[lex_last_action]==-1)throw exn;else return lexbuf[lex_last_action]}else{var base_code=tbl.lex_base_code[pstate],pc_off;if(tbl.lex_check_code[base_code+c]==pstate)pc_off=tbl.lex_trans_code[base_code+c];else pc_off=tbl.lex_default_code[pstate];if(pc_off>0)caml_lex_run_mem(tbl.lex_code,pc_off,lexbuf[lex_mem],lexbuf[lex_curr_pos]);if(c==256)lexbuf[lex_eof_reached]=0}}}function caml_new_lex_engine(tbl,i,buf){return caml_new_lex_engine_aux(tbl,i,buf,[Caml_builtin_exceptions.failure,empty_token_lit])}exports.caml_lex_engine=caml_lex_engine;exports.caml_new_lex_engine=caml_new_lex_engine},{"./caml_builtin_exceptions.js":6}],16:[function(require,module,exports){"use strict";function cmn(q,a,b,x,s,t){var a$1=((a+q|0)+x|0)+t|0;return(a$1<<s|a$1>>>(32-s|0)|0)+b|0}function f(a,b,c,d,x,s,t){return cmn(b&c|(b^-1)&d,a,b,x,s,t)}function g(a,b,c,d,x,s,t){return cmn(b&d|c&(d^-1),a,b,x,s,t)}function h(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}function i(a,b,c,d,x,s,t){return cmn(c^(b|d^-1),a,b,x,s,t)}function cycle(x,k){var a=x[0];var b=x[1];var c=x[2];var d=x[3];a=f(a,b,c,d,k[0],7,-680876936);d=f(d,a,b,c,k[1],12,-389564586);c=f(c,d,a,b,k[2],17,606105819);b=f(b,c,d,a,k[3],22,-1044525330);a=f(a,b,c,d,k[4],7,-176418897);d=f(d,a,b,c,k[5],12,1200080426);c=f(c,d,a,b,k[6],17,-1473231341);b=f(b,c,d,a,k[7],22,-45705983);a=f(a,b,c,d,k[8],7,1770035416);d=f(d,a,b,c,k[9],12,-1958414417);c=f(c,d,a,b,k[10],17,-42063);b=f(b,c,d,a,k[11],22,-1990404162);a=f(a,b,c,d,k[12],7,1804603682);d=f(d,a,b,c,k[13],12,-40341101);c=f(c,d,a,b,k[14],17,-1502002290);b=f(b,c,d,a,k[15],22,1236535329);a=g(a,b,c,d,k[1],5,-165796510);d=g(d,a,b,c,k[6],9,-1069501632);c=g(c,d,a,b,k[11],14,643717713);b=g(b,c,d,a,k[0],20,-373897302);a=g(a,b,c,d,k[5],5,-701558691);d=g(d,a,b,c,k[10],9,38016083);c=g(c,d,a,b,k[15],14,-660478335);b=g(b,c,d,a,k[4],20,-405537848);a=g(a,b,c,d,k[9],5,568446438);d=g(d,a,b,c,k[14],9,-1019803690);c=g(c,d,a,b,k[3],14,-187363961);b=g(b,c,d,a,k[8],20,1163531501);a=g(a,b,c,d,k[13],5,-1444681467);d=g(d,a,b,c,k[2],9,-51403784);c=g(c,d,a,b,k[7],14,1735328473);b=g(b,c,d,a,k[12],20,-1926607734);a=h(a,b,c,d,k[5],4,-378558);d=h(d,a,b,c,k[8],11,-2022574463);c=h(c,d,a,b,k[11],16,1839030562);b=h(b,c,d,a,k[14],23,-35309556);a=h(a,b,c,d,k[1],4,-1530992060)
;d=h(d,a,b,c,k[4],11,1272893353);c=h(c,d,a,b,k[7],16,-155497632);b=h(b,c,d,a,k[10],23,-1094730640);a=h(a,b,c,d,k[13],4,681279174);d=h(d,a,b,c,k[0],11,-358537222);c=h(c,d,a,b,k[3],16,-722521979);b=h(b,c,d,a,k[6],23,76029189);a=h(a,b,c,d,k[9],4,-640364487);d=h(d,a,b,c,k[12],11,-421815835);c=h(c,d,a,b,k[15],16,530742520);b=h(b,c,d,a,k[2],23,-995338651);a=i(a,b,c,d,k[0],6,-198630844);d=i(d,a,b,c,k[7],10,1126891415);c=i(c,d,a,b,k[14],15,-1416354905);b=i(b,c,d,a,k[5],21,-57434055);a=i(a,b,c,d,k[12],6,1700485571);d=i(d,a,b,c,k[3],10,-1894986606);c=i(c,d,a,b,k[10],15,-1051523);b=i(b,c,d,a,k[1],21,-2054922799);a=i(a,b,c,d,k[8],6,1873313359);d=i(d,a,b,c,k[15],10,-30611744);c=i(c,d,a,b,k[6],15,-1560198380);b=i(b,c,d,a,k[13],21,1309151649);a=i(a,b,c,d,k[4],6,-145523070);d=i(d,a,b,c,k[11],10,-1120210379);c=i(c,d,a,b,k[2],15,718787259);b=i(b,c,d,a,k[9],21,-343485551);x[0]=a+x[0]|0;x[1]=b+x[1]|0;x[2]=c+x[2]|0;x[3]=d+x[3]|0;return 0}var state=[1732584193,-271733879,-1732584194,271733878];var md5blk=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function caml_md5_string(s,start,len){var s$1=s.slice(start,len);var n=s$1.length;state[0]=1732584193;state[1]=-271733879;state[2]=-1732584194;state[3]=271733878;for(var i=0;i<=15;++i){md5blk[i]=0}var i_end=n/64|0;for(var i$1=1;i$1<=i_end;++i$1){for(var j=0;j<=15;++j){var k=((i$1<<6)-64|0)+(j<<2)|0;md5blk[j]=((s$1.charCodeAt(k)+(s$1.charCodeAt(k+1|0)<<8)|0)+(s$1.charCodeAt(k+2|0)<<16)|0)+(s$1.charCodeAt(k+3|0)<<24)|0}cycle(state,md5blk)}var s_tail=s$1.slice(i_end<<6);for(var kk=0;kk<=15;++kk){md5blk[kk]=0}var i_end$1=s_tail.length-1|0;for(var i$2=0;i$2<=i_end$1;++i$2){md5blk[i$2/4|0]=md5blk[i$2/4|0]|s_tail.charCodeAt(i$2)<<(i$2%4<<3)}var i$3=i_end$1+1|0;md5blk[i$3/4|0]=md5blk[i$3/4|0]|128<<(i$3%4<<3);if(i$3>55){cycle(state,md5blk);for(var i$4=0;i$4<=15;++i$4){md5blk[i$4]=0}}md5blk[14]=n<<3;cycle(state,md5blk);return String.fromCharCode(state[0]&255,state[0]>>8&255,state[0]>>16&255,state[0]>>24&255,state[1]&255,state[1]>>8&255,state[1]>>16&255,state[1]>>24&255,state[2]&255,state[2]>>8&255,state[2]>>16&255,state[2]>>24&255,state[3]&255,state[3]>>8&255,state[3]>>16&255,state[3]>>24&255)}exports.caml_md5_string=caml_md5_string},{}],17:[function(require,module,exports){"use strict";var Block=require("./block.js");var Caml_primitive=require("./caml_primitive.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function for_in(o,foo){for(var x in o){foo(x)}}function caml_obj_block(tag,size){var v=new Array(size);v.tag=tag;return v}function caml_obj_dup(x){if(Array.isArray(x)){var len=x.length|0;var v=new Array(len);for(var i=0,i_finish=len-1|0;i<=i_finish;++i){v[i]=x[i]}v.tag=x.tag|0;return v}else{return Object.assign({},x)}}function caml_obj_truncate(x,new_size){var len=x.length|0;if(new_size<=0||new_size>len){throw[Caml_builtin_exceptions.invalid_argument,"Obj.truncate"]}if(len!==new_size){for(var i=new_size,i_finish=len-1|0;i<=i_finish;++i){x[i]=0}x.length=new_size;return 0}else{return 0}}function caml_lazy_make_forward(x){return Block.__(250,[x])}function caml_lazy_make(fn){var block=[fn];block.tag=246;return block}function caml_update_dummy(x,y){for(var k in y){x[k]=y[k]}return 0}function caml_compare(_a,_b){while(true){var b=_b;var a=_a;if(a===b){return 0}else{var a_type=typeof a;var b_type=typeof b;switch(a_type){case"boolean":if(b_type==="boolean"){return Caml_primitive.caml_bool_compare(a,b)}break;case"function":if(b_type==="function"){throw[Caml_builtin_exceptions.invalid_argument,"compare: functional value"]}break;case"number":if(b_type==="number"){return Caml_primitive.caml_int_compare(a,b)}break;case"string":if(b_type==="string"){return Caml_primitive.caml_string_compare(a,b)}else{return 1}case"undefined":return-1;default:}switch(b_type){case"string":return-1;case"undefined":return 1;default:if(a_type==="boolean"){return 1}else if(b_type==="boolean"){return-1}else if(a_type==="function"){return 1}else if(b_type==="function"){return-1}else if(a_type==="number"){if(b===null||b.tag===256){return 1}else{return-1}}else if(b_type==="number"){if(a===null||a.tag===256){return-1}else{return 1}}else if(a===null){if(b.tag===256){return 1}else{return-1}}else if(b===null){if(a.tag===256){return-1}else{return 1}}else{var tag_a=a.tag|0;var tag_b=b.tag|0;if(tag_a===250){_a=a[0];continue}else if(tag_b===250){_b=b[0];continue}else if(tag_a===256){if(tag_b===256){return Caml_primitive.caml_int_compare(a[1],b[1])}else{return-1}}else if(tag_a===248){return Caml_primitive.caml_int_compare(a[1],b[1])}else{if(tag_a===251){throw[Caml_builtin_exceptions.invalid_argument,"equal: abstract value"]}if(tag_a!==tag_b){if(tag_a<tag_b){return-1}else{return 1}}else{var len_a=a.length|0;var len_b=b.length|0;if(len_a===len_b){if(Array.isArray(a)){var a$1=a;var b$1=b;var _i=0;var same_length=len_a;while(true){var i=_i;if(i===same_length){return 0}else{var res=caml_compare(a$1[i],b$1[i]);if(res!==0){return res}else{_i=i+1|0;continue}}}}else if(a instanceof Date&&b instanceof Date){return a-b}else{var a$2=a;var b$2=b;var min_key_lhs={contents:undefined};var min_key_rhs={contents:undefined};var do_key=function(param,key){var min_key=param[2];var b=param[1];if(!b.hasOwnProperty(key)||caml_compare(param[0][key],b[key])>0){var match=min_key.contents;if(match!==undefined&&key>=match){return 0}else{min_key.contents=key;return 0}}else{return 0}};var partial_arg=[a$2,b$2,min_key_rhs];var do_key_a=function(partial_arg){return function do_key_a(param){return do_key(partial_arg,param)}}(partial_arg);var partial_arg$1=[b$2,a$2,min_key_lhs];var do_key_b=function(partial_arg$1){return function do_key_b(param){return do_key(partial_arg$1,param)}}(partial_arg$1);for_in(a$2,do_key_a);for_in(b$2,do_key_b);var match=min_key_lhs.contents;var match$1=min_key_rhs.contents;if(match!==undefined){if(match$1!==undefined){return Caml_primitive.caml_string_compare(match,match$1)}else{return-1}}else if(match$1!==undefined){return 1}else{return 0}}}else if(len_a<len_b){var a$3=a;var b$3=b;var _i$1=0;var short_length=len_a;while(true){var i$1=_i$1;if(i$1===short_length){return-1}else{var res$1=caml_compare(a$3[i$1],b$3[i$1]);if(res$1!==0){return res$1}else{_i$1=i$1+1|0;continue}}}}else{var a$4=a;var b$4=b;var _i$2=0;var short_length$1=len_b;while(true){var i$2=_i$2;if(i$2===short_length$1){return 1}else{var res$2=caml_compare(a$4[i$2],b$4[i$2]);if(res$2!==0){return res$2}else{_i$2=i$2+1|0;continue}}}}}}}}}}}function caml_equal(_a,_b){while(true){var b=_b;var a=_a;if(a===b){return true}else{var a_type=typeof a;if(a_type==="string"||a_type==="number"||a_type==="boolean"||a_type==="undefined"||a===null){return false}else{var b_type=typeof b;if(a_type==="function"||b_type==="function"){throw[Caml_builtin_exceptions.invalid_argument,"equal: functional value"]}if(b_type==="number"||b_type==="undefined"||b===null){return false}else{var tag_a=a.tag|0;var tag_b=b.tag|0;if(tag_a===250){_a=a[0];continue}else if(tag_b===250){_b=b[0];continue}else if(tag_a===248){return a[1]===b[1]}else{if(tag_a===251){throw[Caml_builtin_exceptions.invalid_argument,"equal: abstract value"]}if(tag_a!==tag_b){return false}else if(tag_a===256){return a[1]===b[1]}else{var len_a=a.length|0;var len_b=b.length|0;if(len_a===len_b){if(Array.isArray(a)){var a$1=a;var b$1=b;var _i=0;var same_length=len_a;while(true){var i=_i;if(i===same_length){return true}else if(caml_equal(a$1[i],b$1[i])){_i=i+1|0;continue}else{return false}}}else if(a instanceof Date&&b instanceof Date){return!(a>b||a<b)}else{var a$2=a;var b$2=b;var result={contents:true};var do_key_a=function(b$2,result){return function do_key_a(key){if(b$2.hasOwnProperty(key)){return 0}else{result.contents=false;return 0}}}(b$2,result);var do_key_b=function(a$2,b$2,result){return function do_key_b(key){if(!a$2.hasOwnProperty(key)||!caml_equal(b$2[key],a$2[key])){result.contents=false;return 0}else{return 0}}}(a$2,b$2,result);for_in(a$2,do_key_a);if(result.contents){for_in(b$2,do_key_b)}return result.contents}}else{return false}}}}}}}}function caml_equal_null(x,y){if(y!==null){return caml_equal(x,y)}else{return x===y}}function caml_equal_undefined(x,y){if(y!==undefined){return caml_equal(x,y)}else{return x===y}}function caml_equal_nullable(x,y){if(y==null){return x===y}else{return caml_equal(x,y)}}function caml_notequal(a,b){return!caml_equal(a,b)}function caml_greaterequal(a,b){return caml_compare(a,b)>=0}function caml_greaterthan(a,b){return caml_compare(a,b)>0}function caml_lessequal(a,b){return caml_compare(a,b)<=0}function caml_lessthan(a,b){return caml_compare(a,b)<0}function caml_min(x,y){if(caml_compare(x,y)<=0){return x}else{return y}}function caml_max(x,y){if(caml_compare(x,y)>=0){return x}else{return y}}function caml_obj_set_tag(prim,prim$1){prim.tag=prim$1;return 0}exports.caml_obj_block=caml_obj_block;exports.caml_obj_dup=caml_obj_dup;exports.caml_obj_truncate=caml_obj_truncate;exports.caml_lazy_make_forward=caml_lazy_make_forward;exports.caml_lazy_make=caml_lazy_make;exports.caml_update_dummy=caml_update_dummy;exports.caml_compare=caml_compare;exports.caml_equal=caml_equal;exports.caml_equal_null=caml_equal_null;exports.caml_equal_undefined=caml_equal_undefined;exports.caml_equal_nullable=caml_equal_nullable;exports.caml_notequal=caml_notequal;exports.caml_greaterequal=caml_greaterequal;exports.caml_greaterthan=caml_greaterthan;exports.caml_lessthan=caml_lessthan;exports.caml_lessequal=caml_lessequal;exports.caml_min=caml_min;exports.caml_max=caml_max;exports.caml_obj_set_tag=caml_obj_set_tag},{"./block.js":2,"./caml_builtin_exceptions.js":6,"./caml_primitive.js":19}],18:[function(require,module,exports){"use strict";var undefinedHeader=[];function some(x){if(x===undefined){var block=[undefinedHeader,0];block.tag=256;return block}else if(x!==null&&x[0]===undefinedHeader){var nid=x[1]+1|0;var block$1=[undefinedHeader,nid];block$1.tag=256;return block$1}else{return x}}function nullable_to_opt(x){if(x===null||x===undefined){return}else{return some(x)}}function undefined_to_opt(x){if(x===undefined){return}else{return some(x)}}function null_to_opt(x){if(x===null){return}else{return some(x)}}function valFromOption(x){if(x!==null&&x[0]===undefinedHeader){var depth=x[1];if(depth===0){return}else{return[undefinedHeader,depth-1|0]}}else{return x}}function option_get(x){if(x===undefined){return}else{return valFromOption(x)}}function option_get_unwrap(x){if(x===undefined){return}else{return valFromOption(x)[1]}}exports.nullable_to_opt=nullable_to_opt;exports.undefined_to_opt=undefined_to_opt;exports.null_to_opt=null_to_opt;exports.valFromOption=valFromOption;exports.some=some;exports.option_get=option_get;exports.option_get_unwrap=option_get_unwrap},{}],19:[function(require,module,exports){"use strict";function caml_int_compare(x,y){if(x<y){return-1}else if(x===y){return 0}else{return 1}}function caml_bool_compare(x,y){if(x){if(y){return 0}else{return 1}}else if(y){return-1}else{return 0}}function caml_float_compare(x,y){if(x===y){return 0}else if(x<y){return-1}else if(x>y||x===x){return 1}else if(y===y){return-1}else{return 0}}function caml_string_compare(s1,s2){if(s1===s2){return 0}else if(s1<s2){return-1}else{return 1}}function caml_bytes_compare_aux(s1,s2,_off,len,def){while(true){var off=_off;if(off<len){var a=s1[off];var b=s2[off];if(a>b){return 1}else if(a<b){return-1}else{_off=off+1|0;continue}}else{return def}}}function caml_bytes_compare(s1,s2){var len1=s1.length;var len2=s2.length;if(len1===len2){return caml_bytes_compare_aux(s1,s2,0,len1,0)}else if(len1<len2){return caml_bytes_compare_aux(s1,s2,0,len1,-1)}else{return caml_bytes_compare_aux(s1,s2,0,len2,1)}}function caml_bytes_equal(s1,s2){var len1=s1.length;var len2=s2.length;if(len1===len2){var s1$1=s1;var s2$1=s2;var _off=0;var len=len1;while(true){var off=_off;if(off===len){return true}else{var a=s1$1[off];var b=s2$1[off];if(a===b){_off=off+1|0;continue}else{return false}}}}else{return false}}function caml_bool_min(x,y){if(x){return y}else{return x}}function caml_int_min(x,y){if(x<y){return x}else{return y}}function caml_float_min(x,y){if(x<y){return x}else{return y}}function caml_string_min(x,y){if(x<y){return x}else{return y}}function caml_nativeint_min(x,y){if(x<y){return x}else{return y}}function caml_int32_min(x,y){if(x<y){return x}else{return y}}function caml_bool_max(x,y){if(x){return x}else{return y}}function caml_int_max(x,y){if(x>y){return x}else{return y}}function caml_float_max(x,y){if(x>y){return x}else{return y}}function caml_string_max(x,y){if(x>y){return x}else{return y}}function caml_nativeint_max(x,y){if(x>y){return x}else{return y}}function caml_int32_max(x,y){if(x>y){return x}else{return y}}var caml_nativeint_compare=caml_int_compare;var caml_int32_compare=caml_int_compare;exports.caml_bytes_compare=caml_bytes_compare;exports.caml_bytes_equal=caml_bytes_equal;exports.caml_int_compare=caml_int_compare;exports.caml_bool_compare=caml_bool_compare;exports.caml_float_compare=caml_float_compare;exports.caml_nativeint_compare=caml_nativeint_compare;exports.caml_string_compare=caml_string_compare;exports.caml_int32_compare=caml_int32_compare;exports.caml_bool_min=caml_bool_min;exports.caml_int_min=caml_int_min;exports.caml_float_min=caml_float_min;exports.caml_string_min=caml_string_min;exports.caml_nativeint_min=caml_nativeint_min;exports.caml_int32_min=caml_int32_min;exports.caml_bool_max=caml_bool_max;exports.caml_int_max=caml_int_max;exports.caml_float_max=caml_float_max;exports.caml_string_max=caml_string_max;exports.caml_nativeint_max=caml_nativeint_max;exports.caml_int32_max=caml_int32_max},{}],20:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function caml_string_get(s,i){if(i>=s.length||i<0){throw[Caml_builtin_exceptions.invalid_argument,"index out of bounds"]}return s.charCodeAt(i)}function caml_string_get16(s,i){return s.charCodeAt(i)+(s.charCodeAt(i+1|0)<<8)|0}function caml_string_get32(s,i){return((s.charCodeAt(i)+(s.charCodeAt(i+1|0)<<8)|0)+(s.charCodeAt(i+2|0)<<16)|0)+(s.charCodeAt(i+3|0)<<24)|0}function get(s,i){if(i<0||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"index out of bounds"]}return s.charCodeAt(i)}exports.caml_string_get=caml_string_get;exports.caml_string_get16=caml_string_get16;exports.caml_string_get32=caml_string_get32;exports.get=get},{"./caml_builtin_exceptions.js":6}],21:[function(require,module,exports){(function(process){"use strict";var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function caml_sys_getenv(s){if(typeof process==="undefined"||process.env===undefined){throw Caml_builtin_exceptions.not_found}var match=process.env[s];if(match!==undefined){return match}else{throw Caml_builtin_exceptions.not_found}}function caml_sys_time(param){if(typeof process==="undefined"||process.uptime===undefined){return-1}else{return process.uptime()}}function caml_sys_random_seed(param){return[((Date.now()|0)^4294967295)*Math.random()|0]}function caml_sys_system_command(_cmd){return 127}function caml_sys_getcwd(param){if(typeof process==="undefined"){return"/"}else{return process.cwd()}}function caml_sys_get_argv(param){if(typeof process==="undefined"){return["",[""]]}else{var argv=process.argv;if(argv==null){return["",[""]]}else{return[argv[0],argv]}}}function caml_sys_exit(exit_code){if(typeof process!=="undefined"){return process.exit(exit_code)}else{return 0}}function caml_sys_is_directory(_s){throw[Caml_builtin_exceptions.failure,"caml_sys_is_directory not implemented"]}function caml_sys_file_exists(_s){throw[Caml_builtin_exceptions.failure,"caml_sys_file_exists not implemented"]}exports.caml_sys_getenv=caml_sys_getenv;exports.caml_sys_time=caml_sys_time;exports.caml_sys_random_seed=caml_sys_random_seed;exports.caml_sys_system_command=caml_sys_system_command;exports.caml_sys_getcwd=caml_sys_getcwd;exports.caml_sys_get_argv=caml_sys_get_argv;exports.caml_sys_exit=caml_sys_exit;exports.caml_sys_is_directory=caml_sys_is_directory;exports.caml_sys_file_exists=caml_sys_file_exists}).call(this,require("_process"))},{"./caml_builtin_exceptions.js":6,_process:51}],22:[function(require,module,exports){"use strict";function repeat(count,self){if(self.repeat){return self.repeat(count)}if(self.length==0||count==0){return""}if(self.length*count>=1<<28){throw new RangeError("repeat count must not overflow maximum string size")}var rpt="";for(;;){if((count&1)==1){rpt+=self}count>>>=1;if(count==0){break}self+=self}return rpt}exports.repeat=repeat},{}],23:[function(require,module,exports){"use strict";var Char=require("./char.js");var Block=require("./block.js");var Bytes=require("./bytes.js");var Curry=require("./curry.js");var $$Buffer=require("./buffer.js");var $$String=require("./string.js");var Caml_io=require("./caml_io.js");var Caml_obj=require("./caml_obj.js");var Caml_bytes=require("./caml_bytes.js");var Caml_int32=require("./caml_int32.js");var Pervasives=require("./pervasives.js");var Caml_format=require("./caml_format.js");var Caml_string=require("./caml_string.js");var Caml_primitive=require("./caml_primitive.js");var Caml_exceptions=require("./caml_exceptions.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");var CamlinternalFormatBasics=require("./camlinternalFormatBasics.js");function create_char_set(param){return Bytes.make(32,0)}function add_in_char_set(char_set,c){var str_ind=c>>>3;var mask=1<<(c&7);char_set[str_ind]=Pervasives.char_of_int(Caml_bytes.get(char_set,str_ind)|mask);return 0}var freeze_char_set=Bytes.to_string;function rev_char_set(char_set){var char_set$prime=Bytes.make(32,0);for(var i=0;i<=31;++i){char_set$prime[i]=Pervasives.char_of_int(Caml_string.get(char_set,i)^255)}return Caml_bytes.bytes_to_string(char_set$prime)}function is_in_char_set(char_set,c){var str_ind=c>>>3;var mask=1<<(c&7);return(Caml_string.get(char_set,str_ind)&mask)!==0}function pad_of_pad_opt(pad_opt){if(pad_opt!==undefined){return Block.__(0,[1,pad_opt])}else{return 0}}function prec_of_prec_opt(prec_opt){if(prec_opt!==undefined){return[prec_opt]}else{return 0}}function param_format_of_ignored_format(ign,fmt){if(typeof ign==="number"){switch(ign){case 0:return[Block.__(0,[fmt])];case 1:return[Block.__(1,[fmt])];case 2:return[Block.__(19,[fmt])];case 3:return[Block.__(22,[fmt])]}}else{switch(ign.tag|0){case 0:return[Block.__(2,[pad_of_pad_opt(ign[0]),fmt])];case 1:return[Block.__(3,[pad_of_pad_opt(ign[0]),fmt])];case 2:return[Block.__(4,[ign[0],pad_of_pad_opt(ign[1]),0,fmt])];case 3:return[Block.__(5,[ign[0],pad_of_pad_opt(ign[1]),0,fmt])];case 4:return[Block.__(6,[ign[0],pad_of_pad_opt(ign[1]),0,fmt])];case 5:return[Block.__(7,[ign[0],pad_of_pad_opt(ign[1]),0,fmt])];case 6:return[Block.__(8,[0,pad_of_pad_opt(ign[0]),prec_of_prec_opt(ign[1]),fmt])];case 7:return[Block.__(9,[pad_of_pad_opt(ign[0]),fmt])];case 8:return[Block.__(13,[ign[0],ign[1],fmt])];case 9:return[Block.__(14,[ign[0],ign[1],fmt])];case 10:return[Block.__(20,[ign[0],ign[1],fmt])];case 11:return[Block.__(21,[ign[0],fmt])]}}}function buffer_check_size(buf,overhead){var len=buf.bytes.length;var min_len=buf.ind+overhead|0;if(min_len>len){var new_len=Caml_primitive.caml_int_max(len<<1,min_len);var new_str=Caml_bytes.caml_create_bytes(new_len);Bytes.blit(buf.bytes,0,new_str,0,len);buf.bytes=new_str;return 0}else{return 0}}function buffer_add_char(buf,c){buffer_check_size(buf,1);buf.bytes[buf.ind]=c;buf.ind=buf.ind+1|0;return 0}function buffer_add_string(buf,s){var str_len=s.length;buffer_check_size(buf,str_len);$$String.blit(s,0,buf.bytes,buf.ind,str_len);buf.ind=buf.ind+str_len|0;return 0}function buffer_contents(buf){return Bytes.sub_string(buf.bytes,0,buf.ind)}function char_of_iconv(iconv){switch(iconv){case 0:case 1:case 2:return 100;case 3:case 4:case 5:return 105;case 6:case 7:return 120;case 8:case 9:return 88;case 10:case 11:return 111;case 12:return 117}}function char_of_fconv(fconv){switch(fconv){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}function char_of_counter(counter){switch(counter){case 0:return 108;case 1:return 110;case 2:return 78}}function bprint_char_set(buf,char_set){var print_char=function(buf,i){var c=Pervasives.char_of_int(i);if(c!==37){if(c!==64){return buffer_add_char(buf,c)}else{buffer_add_char(buf,37);return buffer_add_char(buf,64)}}else{buffer_add_char(buf,37);return buffer_add_char(buf,37)}};var print_out=function(set,_i){while(true){var i=_i;if(i<256){if(is_in_char_set(set,Pervasives.char_of_int(i))){var set$1=set;var i$1=i;var match=Pervasives.char_of_int(i$1);var switcher=match-45|0;if(switcher>48||switcher<0){if(switcher>=210){return print_char(buf,255)}else{return print_second(set$1,i$1+1|0)}}else if(switcher>47||switcher<1){return print_out(set$1,i$1+1|0)}else{return print_second(set$1,i$1+1|0)}}else{_i=i+1|0;continue}}else{return 0}}};var print_second=function(set,i){if(is_in_char_set(set,Pervasives.char_of_int(i))){var match=Pervasives.char_of_int(i);var switcher=match-45|0;if(switcher>48||switcher<0){if(switcher>=210){print_char(buf,254);return print_char(buf,255)}}else if((switcher>47||switcher<1)&&!is_in_char_set(set,Pervasives.char_of_int(i+1|0))){print_char(buf,i-1|0);return print_out(set,i+1|0)}if(is_in_char_set(set,Pervasives.char_of_int(i+1|0))){var set$1=set;var i$1=i-1|0;var _j=i+2|0;while(true){var j=_j;if(j===256||!is_in_char_set(set$1,Pervasives.char_of_int(j))){print_char(buf,i$1);print_char(buf,45);print_char(buf,j-1|0);if(j<256){return print_out(set$1,j+1|0)}else{return 0}}else{_j=j+1|0;continue}}}else{print_char(buf,i-1|0);print_char(buf,i);return print_out(set,i+2|0)}}else{print_char(buf,i-1|0);return print_out(set,i+1|0)}};var print_start=function(set){var is_alone=function(c){var before=Char.chr(c-1|0);var after=Char.chr(c+1|0);if(is_in_char_set(set,c)){return!(is_in_char_set(set,before)&&is_in_char_set(set,after))}else{return false}};if(is_alone(93)){buffer_add_char(buf,93)}print_out(set,1);if(is_alone(45)){return buffer_add_char(buf,45)}else{return 0}};buffer_add_char(buf,91);print_start(is_in_char_set(char_set,0)?(buffer_add_char(buf,94),rev_char_set(char_set)):char_set);return buffer_add_char(buf,93)}function bprint_padty(buf,padty){switch(padty){case 0:return buffer_add_char(buf,45);case 1:return 0;case 2:return buffer_add_char(buf,48)}}function bprint_ignored_flag(buf,ign_flag){if(ign_flag){return buffer_add_char(buf,95)}else{return 0}}function bprint_pad_opt(buf,pad_opt){if(pad_opt!==undefined){return buffer_add_string(buf,String(pad_opt))}else{return 0}}function bprint_padding(buf,pad){if(typeof pad==="number"){return 0}else{bprint_padty(buf,pad[0]);if(pad.tag){return buffer_add_char(buf,42)}else{return buffer_add_string(buf,String(pad[1]))}}}function bprint_precision(buf,prec){if(typeof prec==="number"){if(prec!==0){return buffer_add_string(buf,".*")}else{return 0}}else{buffer_add_char(buf,46);return buffer_add_string(buf,String(prec[0]))}}function bprint_iconv_flag(buf,iconv){switch(iconv){case 1:case 4:return buffer_add_char(buf,43);case 2:case 5:return buffer_add_char(buf,32);case 7:case 9:case 11:return buffer_add_char(buf,35);case 0:case 3:case 6:case 8:case 10:case 12:return 0}}function bprint_int_fmt(buf,ign_flag,iconv,pad,prec){buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_iconv_flag(buf,iconv);bprint_padding(buf,pad);bprint_precision(buf,prec);return buffer_add_char(buf,char_of_iconv(iconv))}function bprint_altint_fmt(buf,ign_flag,iconv,pad,prec,c){buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_iconv_flag(buf,iconv);bprint_padding(buf,pad);bprint_precision(buf,prec);buffer_add_char(buf,c);return buffer_add_char(buf,char_of_iconv(iconv))}function bprint_fconv_flag(buf,fconv){switch(fconv){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return 0;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return buffer_add_char(buf,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:return buffer_add_char(buf,32)}}function bprint_float_fmt(buf,ign_flag,fconv,pad,prec){buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_fconv_flag(buf,fconv);bprint_padding(buf,pad);bprint_precision(buf,prec);return buffer_add_char(buf,char_of_fconv(fconv))}function string_of_formatting_lit(formatting_lit){if(typeof formatting_lit==="number"){switch(formatting_lit){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}}else{switch(formatting_lit.tag|0){case 0:case 1:return formatting_lit[0];case 2:return"@"+Caml_bytes.bytes_to_string(Bytes.make(1,formatting_lit[0]))}}}function string_of_formatting_gen(formatting_gen){return formatting_gen[0][1]}function bprint_char_literal(buf,chr){if(chr!==37){return buffer_add_char(buf,chr)}else{return buffer_add_string(buf,"%%")}}function bprint_string_literal(buf,str){for(var i=0,i_finish=str.length-1|0;i<=i_finish;++i){bprint_char_literal(buf,Caml_string.get(str,i))}return 0}function bprint_fmtty(buf,_fmtty){while(true){var fmtty=_fmtty;if(typeof fmtty==="number"){return 0}else{switch(fmtty.tag|0){case 0:buffer_add_string(buf,"%c");_fmtty=fmtty[0];continue;case 1:buffer_add_string(buf,"%s");_fmtty=fmtty[0];continue;case 2:buffer_add_string(buf,"%i");_fmtty=fmtty[0];continue;case 3:buffer_add_string(buf,"%li");_fmtty=fmtty[0];continue;case 4:buffer_add_string(buf,"%ni");_fmtty=fmtty[0];continue;case 5:buffer_add_string(buf,"%Li");_fmtty=fmtty[0];continue;case 6:buffer_add_string(buf,"%f");_fmtty=fmtty[0];continue;case 7:buffer_add_string(buf,"%B");_fmtty=fmtty[0];continue;case 8:buffer_add_string(buf,"%{");bprint_fmtty(buf,fmtty[0]);buffer_add_string(buf,"%}");_fmtty=fmtty[1];continue;case 9:buffer_add_string(buf,"%(");bprint_fmtty(buf,fmtty[0]);buffer_add_string(buf,"%)");_fmtty=fmtty[2];continue;case 10:buffer_add_string(buf,"%a");_fmtty=fmtty[0];continue;case 11:buffer_add_string(buf,"%t");_fmtty=fmtty[0];continue;case 12:buffer_add_string(buf,"%?");_fmtty=fmtty[0];continue;case 13:buffer_add_string(buf,"%r");_fmtty=fmtty[0];continue;case 14:buffer_add_string(buf,"%_r");_fmtty=fmtty[0];continue}}}}function int_of_custom_arity(param){if(param){return 1+int_of_custom_arity(param[0])|0}else{return 0}}function bprint_fmt(buf,fmt){var _fmt=fmt;var _ign_flag=false;while(true){var ign_flag=_ign_flag;var fmt$1=_fmt;if(typeof fmt$1==="number"){return 0}else{switch(fmt$1.tag|0){case 0:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,99);_ign_flag=false;_fmt=fmt$1[0];continue;case 1:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,67);_ign_flag=false;_fmt=fmt$1[0];continue;case 2:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_padding(buf,fmt$1[0]);buffer_add_char(buf,115);_ign_flag=false;_fmt=fmt$1[1];continue;case 3:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_padding(buf,fmt$1[0]);buffer_add_char(buf,83);_ign_flag=false;_fmt=fmt$1[1];continue;case 4:bprint_int_fmt(buf,ign_flag,fmt$1[0],fmt$1[1],fmt$1[2]);_ign_flag=false;_fmt=fmt$1[3];continue;case 5:bprint_altint_fmt(buf,ign_flag,fmt$1[0],fmt$1[1],fmt$1[2],108);_ign_flag=false;_fmt=fmt$1[3];continue;case 6:bprint_altint_fmt(buf,ign_flag,fmt$1[0],fmt$1[1],fmt$1[2],110);_ign_flag=false;_fmt=fmt$1[3];continue;case 7:bprint_altint_fmt(buf,ign_flag,fmt$1[0],fmt$1[1],fmt$1[2],76);_ign_flag=false;_fmt=fmt$1[3];continue;case 8:bprint_float_fmt(buf,ign_flag,fmt$1[0],fmt$1[1],fmt$1[2]);_ign_flag=false;_fmt=fmt$1[3];continue;case 9:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_padding(buf,fmt$1[0]);buffer_add_char(buf,66);_ign_flag=false;_fmt=fmt$1[1];continue;case 10:buffer_add_string(buf,"%!");_fmt=fmt$1[0];continue;case 11:bprint_string_literal(buf,fmt$1[0]);_fmt=fmt$1[1];continue;case 12:bprint_char_literal(buf,fmt$1[0]);_fmt=fmt$1[1];continue;case 13:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_pad_opt(buf,fmt$1[0]);buffer_add_char(buf,123);bprint_fmtty(buf,fmt$1[1]);buffer_add_char(buf,37);buffer_add_char(buf,125);_ign_flag=false;_fmt=fmt$1[2];continue;case 14:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_pad_opt(buf,fmt$1[0]);buffer_add_char(buf,40);bprint_fmtty(buf,fmt$1[1]);buffer_add_char(buf,37);buffer_add_char(buf,41);_ign_flag=false;_fmt=fmt$1[2];continue;case 15:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,97);_ign_flag=false;_fmt=fmt$1[0];continue;case 16:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,116);_ign_flag=false;_fmt=fmt$1[0];continue;case 17:bprint_string_literal(buf,string_of_formatting_lit(fmt$1[0]));_fmt=fmt$1[1];continue;case 18:bprint_string_literal(buf,"@{");bprint_string_literal(buf,string_of_formatting_gen(fmt$1[0]));_fmt=fmt$1[1];continue;case 19:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,114);_ign_flag=false;_fmt=fmt$1[0];continue;case 20:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_pad_opt(buf,fmt$1[0]);bprint_char_set(buf,fmt$1[1]);_ign_flag=false;_fmt=fmt$1[2];continue;case 21:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,char_of_counter(fmt$1[0]));_ign_flag=false;_fmt=fmt$1[1];continue;case 22:buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);bprint_string_literal(buf,"0c");_ign_flag=false;_fmt=fmt$1[0];continue;case 23:var match=param_format_of_ignored_format(fmt$1[0],fmt$1[1]);_ign_flag=true;_fmt=match[0];continue;case 24:for(var _i=1,_i_finish=int_of_custom_arity(fmt$1[0]);_i<=_i_finish;++_i){buffer_add_char(buf,37);bprint_ignored_flag(buf,ign_flag);buffer_add_char(buf,63)}_ign_flag=false;_fmt=fmt$1[2];continue}}}}function string_of_fmt(fmt){var buf={ind:0,bytes:Caml_bytes.caml_create_bytes(16)};bprint_fmt(buf,fmt);return buffer_contents(buf)}function symm(param){if(typeof param==="number"){return 0}else{switch(param.tag|0){case 0:return Block.__(0,[symm(param[0])]);case 1:return Block.__(1,[symm(param[0])]);case 2:return Block.__(2,[symm(param[0])]);case 3:return Block.__(3,[symm(param[0])]);case 4:return Block.__(4,[symm(param[0])]);case 5:return Block.__(5,[symm(param[0])]);case 6:return Block.__(6,[symm(param[0])]);case 7:return Block.__(7,[symm(param[0])]);case 8:return Block.__(8,[param[0],symm(param[1])]);case 9:return Block.__(9,[param[1],param[0],symm(param[2])]);case 10:return Block.__(10,[symm(param[0])]);case 11:return Block.__(11,[symm(param[0])]);case 12:return Block.__(12,[symm(param[0])]);case 13:return Block.__(13,[symm(param[0])]);case 14:return Block.__(14,[symm(param[0])])}}}function fmtty_rel_det(param){if(typeof param==="number"){return[function(param){return 0},function(param){return 0},function(param){return 0},function(param){return 0}]}else{switch(param.tag|0){case 0:var match=fmtty_rel_det(param[0]);var af=match[1];var fa=match[0];return[function(param){Curry._1(fa,0);return 0},function(param){Curry._1(af,0);return 0},match[2],match[3]];case 1:var match$1=fmtty_rel_det(param[0]);var af$1=match$1[1];var fa$1=match$1[0];return[function(param){Curry._1(fa$1,0);return 0},function(param){Curry._1(af$1,0);return 0},match$1[2],match$1[3]];case 2:var match$2=fmtty_rel_det(param[0]);var af$2=match$2[1];var fa$2=match$2[0];return[function(param){Curry._1(fa$2,0);return 0},function(param){Curry._1(af$2,0);return 0},match$2[2],match$2[3]];case 3:var match$3=fmtty_rel_det(param[0]);var af$3=match$3[1];var fa$3=match$3[0];return[function(param){Curry._1(fa$3,0);return 0},function(param){Curry._1(af$3,0);return 0},match$3[2],match$3[3]];case 4:var match$4=fmtty_rel_det(param[0]);var af$4=match$4[1];var fa$4=match$4[0];return[function(param){Curry._1(fa$4,0);return 0},function(param){Curry._1(af$4,0);return 0},match$4[2],match$4[3]];case 5:var match$5=fmtty_rel_det(param[0]);var af$5=match$5[1];var fa$5=match$5[0];return[function(param){
Curry._1(fa$5,0);return 0},function(param){Curry._1(af$5,0);return 0},match$5[2],match$5[3]];case 6:var match$6=fmtty_rel_det(param[0]);var af$6=match$6[1];var fa$6=match$6[0];return[function(param){Curry._1(fa$6,0);return 0},function(param){Curry._1(af$6,0);return 0},match$6[2],match$6[3]];case 7:var match$7=fmtty_rel_det(param[0]);var af$7=match$7[1];var fa$7=match$7[0];return[function(param){Curry._1(fa$7,0);return 0},function(param){Curry._1(af$7,0);return 0},match$7[2],match$7[3]];case 8:var match$8=fmtty_rel_det(param[1]);var af$8=match$8[1];var fa$8=match$8[0];return[function(param){Curry._1(fa$8,0);return 0},function(param){Curry._1(af$8,0);return 0},match$8[2],match$8[3]];case 9:var match$9=fmtty_rel_det(param[2]);var de=match$9[3];var ed=match$9[2];var af$9=match$9[1];var fa$9=match$9[0];var ty=trans(symm(param[0]),param[1]);var match$10=fmtty_rel_det(ty);var jd=match$10[3];var dj=match$10[2];var ga=match$10[1];var ag=match$10[0];return[function(param){Curry._1(fa$9,0);Curry._1(ag,0);return 0},function(param){Curry._1(ga,0);Curry._1(af$9,0);return 0},function(param){Curry._1(ed,0);Curry._1(dj,0);return 0},function(param){Curry._1(jd,0);Curry._1(de,0);return 0}];case 10:var match$11=fmtty_rel_det(param[0]);var af$10=match$11[1];var fa$10=match$11[0];return[function(param){Curry._1(fa$10,0);return 0},function(param){Curry._1(af$10,0);return 0},match$11[2],match$11[3]];case 11:var match$12=fmtty_rel_det(param[0]);var af$11=match$12[1];var fa$11=match$12[0];return[function(param){Curry._1(fa$11,0);return 0},function(param){Curry._1(af$11,0);return 0},match$12[2],match$12[3]];case 12:var match$13=fmtty_rel_det(param[0]);var af$12=match$13[1];var fa$12=match$13[0];return[function(param){Curry._1(fa$12,0);return 0},function(param){Curry._1(af$12,0);return 0},match$13[2],match$13[3]];case 13:var match$14=fmtty_rel_det(param[0]);var de$1=match$14[3];var ed$1=match$14[2];var af$13=match$14[1];var fa$13=match$14[0];return[function(param){Curry._1(fa$13,0);return 0},function(param){Curry._1(af$13,0);return 0},function(param){Curry._1(ed$1,0);return 0},function(param){Curry._1(de$1,0);return 0}];case 14:var match$15=fmtty_rel_det(param[0]);var de$2=match$15[3];var ed$2=match$15[2];var af$14=match$15[1];var fa$14=match$15[0];return[function(param){Curry._1(fa$14,0);return 0},function(param){Curry._1(af$14,0);return 0},function(param){Curry._1(ed$2,0);return 0},function(param){Curry._1(de$2,0);return 0}]}}}function trans(ty1,ty2){var exit=0;if(typeof ty1==="number"){if(typeof ty2==="number"){return 0}else{switch(ty2.tag|0){case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break;default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",846,23]]}}}else{switch(ty1.tag|0){case 0:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 0:return Block.__(0,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 1:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 1:return Block.__(1,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 2:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 2:return Block.__(2,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 3:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 3:return Block.__(3,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 4:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 4:return Block.__(4,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 5:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 5:return Block.__(5,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 6:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 6:return Block.__(6,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 7:if(typeof ty2==="number"){exit=8}else{switch(ty2.tag|0){case 7:return Block.__(7,[trans(ty1[0],ty2[0])]);case 8:exit=6;break;case 9:exit=7;break;case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break}}break;case 8:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",832,26]]}else{switch(ty2.tag|0){case 8:return Block.__(8,[trans(ty1[0],ty2[0]),trans(ty1[1],ty2[1])]);case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break;default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",832,26]]}}break;case 9:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",842,28]]}else{switch(ty2.tag|0){case 8:exit=6;break;case 9:var ty=trans(symm(ty1[1]),ty2[0]);var match=fmtty_rel_det(ty);Curry._1(match[1],0);Curry._1(match[3],0);return Block.__(9,[ty1[0],ty2[1],trans(ty1[2],ty2[2])]);case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:exit=5;break;default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",842,28]]}}break;case 10:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",810,21]]}else if(ty2.tag===10){return Block.__(10,[trans(ty1[0],ty2[0])])}else{throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",810,21]]}case 11:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",814,21]]}else{switch(ty2.tag|0){case 10:exit=1;break;case 11:return Block.__(11,[trans(ty1[0],ty2[0])]);default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",814,21]]}}break;case 12:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",818,19]]}else{switch(ty2.tag|0){case 10:exit=1;break;case 11:exit=2;break;case 12:return Block.__(12,[trans(ty1[0],ty2[0])]);default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",818,19]]}}break;case 13:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",822,22]]}else{switch(ty2.tag|0){case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:return Block.__(13,[trans(ty1[0],ty2[0])]);default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",822,22]]}}break;case 14:if(typeof ty2==="number"){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",827,30]]}else{switch(ty2.tag|0){case 10:exit=1;break;case 11:exit=2;break;case 12:exit=3;break;case 13:exit=4;break;case 14:return Block.__(14,[trans(ty1[0],ty2[0])]);default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",827,30]]}}break}}switch(exit){case 1:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",811,21]];case 2:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",815,21]];case 3:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",819,19]];case 4:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",823,22]];case 5:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",828,30]];case 6:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",833,26]];case 7:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",843,28]];case 8:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",847,23]]}}function fmtty_of_formatting_gen(formatting_gen){return fmtty_of_fmt(formatting_gen[0][0])}function fmtty_of_fmt(_fmtty){while(true){var fmtty=_fmtty;if(typeof fmtty==="number"){return 0}else{switch(fmtty.tag|0){case 2:case 3:break;case 4:var ty_rest=fmtty_of_fmt(fmtty[3]);var prec_ty=fmtty_of_precision_fmtty(fmtty[2],Block.__(2,[ty_rest]));return fmtty_of_padding_fmtty(fmtty[1],prec_ty);case 5:var ty_rest$1=fmtty_of_fmt(fmtty[3]);var prec_ty$1=fmtty_of_precision_fmtty(fmtty[2],Block.__(3,[ty_rest$1]));return fmtty_of_padding_fmtty(fmtty[1],prec_ty$1);case 6:var ty_rest$2=fmtty_of_fmt(fmtty[3]);var prec_ty$2=fmtty_of_precision_fmtty(fmtty[2],Block.__(4,[ty_rest$2]));return fmtty_of_padding_fmtty(fmtty[1],prec_ty$2);case 7:var ty_rest$3=fmtty_of_fmt(fmtty[3]);var prec_ty$3=fmtty_of_precision_fmtty(fmtty[2],Block.__(5,[ty_rest$3]));return fmtty_of_padding_fmtty(fmtty[1],prec_ty$3);case 8:var ty_rest$4=fmtty_of_fmt(fmtty[3]);var prec_ty$4=fmtty_of_precision_fmtty(fmtty[2],Block.__(6,[ty_rest$4]));return fmtty_of_padding_fmtty(fmtty[1],prec_ty$4);case 9:return fmtty_of_padding_fmtty(fmtty[0],Block.__(7,[fmtty_of_fmt(fmtty[1])]));case 10:_fmtty=fmtty[0];continue;case 13:return Block.__(8,[fmtty[1],fmtty_of_fmt(fmtty[2])]);case 14:var ty=fmtty[1];return Block.__(9,[ty,ty,fmtty_of_fmt(fmtty[2])]);case 15:return Block.__(10,[fmtty_of_fmt(fmtty[0])]);case 16:return Block.__(11,[fmtty_of_fmt(fmtty[0])]);case 11:case 12:case 17:_fmtty=fmtty[1];continue;case 18:return CamlinternalFormatBasics.concat_fmtty(fmtty_of_formatting_gen(fmtty[0]),fmtty_of_fmt(fmtty[1]));case 19:return Block.__(13,[fmtty_of_fmt(fmtty[0])]);case 20:return Block.__(1,[fmtty_of_fmt(fmtty[2])]);case 21:return Block.__(2,[fmtty_of_fmt(fmtty[1])]);case 23:var ign=fmtty[0];var fmt=fmtty[1];if(typeof ign==="number"){if(ign===2){return Block.__(14,[fmtty_of_fmt(fmt)])}else{return fmtty_of_fmt(fmt)}}else if(ign.tag===9){return CamlinternalFormatBasics.concat_fmtty(ign[1],fmtty_of_fmt(fmt))}else{return fmtty_of_fmt(fmt)}case 24:return fmtty_of_custom(fmtty[0],fmtty_of_fmt(fmtty[2]));default:return Block.__(0,[fmtty_of_fmt(fmtty[0])])}}return fmtty_of_padding_fmtty(fmtty[0],Block.__(1,[fmtty_of_fmt(fmtty[1])]))}}function fmtty_of_custom(arity,fmtty){if(arity){return Block.__(12,[fmtty_of_custom(arity[0],fmtty)])}else{return fmtty}}function fmtty_of_padding_fmtty(pad,fmtty){if(typeof pad==="number"||!pad.tag){return fmtty}else{return Block.__(2,[fmtty])}}function fmtty_of_precision_fmtty(prec,fmtty){if(typeof prec==="number"&&prec!==0){return Block.__(2,[fmtty])}else{return fmtty}}var Type_mismatch=Caml_exceptions.create("CamlinternalFormat.Type_mismatch");function type_padding(pad,fmtty){if(typeof pad==="number"){return[0,fmtty]}else if(pad.tag){if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===2){return[Block.__(1,[pad[0]]),fmtty[0]]}else{throw Type_mismatch}}else{return[Block.__(0,[pad[0],pad[1]]),fmtty]}}function type_padprec(pad,prec,fmtty){var match=type_padding(pad,fmtty);if(typeof prec==="number"){if(prec!==0){var match$1=match[1];if(typeof match$1==="number"){throw Type_mismatch}else if(match$1.tag===2){return[match[0],1,match$1[0]]}else{throw Type_mismatch}}else{return[match[0],0,match[1]]}}else{return[match[0],[prec[0]],match[1]]}}function type_ignored_format_substitution(sub_fmtty,fmt,fmtty){if(typeof sub_fmtty==="number"){return[0,type_format_gen(fmt,fmtty)]}else{switch(sub_fmtty.tag|0){case 0:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag){throw Type_mismatch}else{var match=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(0,[match[0]]),match[1]]}case 1:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===1){var match$1=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(1,[match$1[0]]),match$1[1]]}else{throw Type_mismatch}case 2:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===2){var match$2=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(2,[match$2[0]]),match$2[1]]}else{throw Type_mismatch}case 3:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===3){var match$3=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(3,[match$3[0]]),match$3[1]]}else{throw Type_mismatch}case 4:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===4){var match$4=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(4,[match$4[0]]),match$4[1]]}else{throw Type_mismatch}case 5:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===5){var match$5=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(5,[match$5[0]]),match$5[1]]}else{throw Type_mismatch}case 6:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===6){var match$6=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(6,[match$6[0]]),match$6[1]]}else{throw Type_mismatch}case 7:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===7){var match$7=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(7,[match$7[0]]),match$7[1]]}else{throw Type_mismatch}case 8:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===8){var sub2_fmtty$prime=fmtty[0];if(Caml_obj.caml_notequal([sub_fmtty[0]],[sub2_fmtty$prime])){throw Type_mismatch}var match$8=type_ignored_format_substitution(sub_fmtty[1],fmt,fmtty[1]);return[Block.__(8,[sub2_fmtty$prime,match$8[0]]),match$8[1]]}else{throw Type_mismatch}case 9:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===9){var sub2_fmtty$prime$1=fmtty[1];var sub1_fmtty$prime=fmtty[0];if(Caml_obj.caml_notequal([CamlinternalFormatBasics.erase_rel(sub_fmtty[0])],[CamlinternalFormatBasics.erase_rel(sub1_fmtty$prime)])){throw Type_mismatch}if(Caml_obj.caml_notequal([CamlinternalFormatBasics.erase_rel(sub_fmtty[1])],[CamlinternalFormatBasics.erase_rel(sub2_fmtty$prime$1)])){throw Type_mismatch}var sub_fmtty$prime=trans(symm(sub1_fmtty$prime),sub2_fmtty$prime$1);var match$9=fmtty_rel_det(sub_fmtty$prime);Curry._1(match$9[1],0);Curry._1(match$9[3],0);var match$10=type_ignored_format_substitution(CamlinternalFormatBasics.erase_rel(sub_fmtty[2]),fmt,fmtty[2]);return[Block.__(9,[sub1_fmtty$prime,sub2_fmtty$prime$1,symm(match$10[0])]),match$10[1]]}else{throw Type_mismatch}case 10:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===10){var match$11=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(10,[match$11[0]]),match$11[1]]}else{throw Type_mismatch}case 11:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===11){var match$12=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(11,[match$12[0]]),match$12[1]]}else{throw Type_mismatch}case 12:throw Type_mismatch;case 13:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===13){var match$13=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(13,[match$13[0]]),match$13[1]]}else{throw Type_mismatch}case 14:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===14){var match$14=type_ignored_format_substitution(sub_fmtty[0],fmt,fmtty[0]);return[Block.__(14,[match$14[0]]),match$14[1]]}else{throw Type_mismatch}}}}function type_format_gen(fmt,fmtty){if(typeof fmt==="number"){return[0,fmtty]}else{switch(fmt.tag|0){case 0:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag){throw Type_mismatch}else{var match=type_format_gen(fmt[0],fmtty[0]);return[Block.__(0,[match[0]]),match[1]]}case 1:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag){throw Type_mismatch}else{var match$1=type_format_gen(fmt[0],fmtty[0]);return[Block.__(1,[match$1[0]]),match$1[1]]}case 2:var match$2=type_padding(fmt[0],fmtty);var match$3=match$2[1];if(typeof match$3==="number"){throw Type_mismatch}else if(match$3.tag===1){var match$4=type_format_gen(fmt[1],match$3[0]);return[Block.__(2,[match$2[0],match$4[0]]),match$4[1]]}else{throw Type_mismatch}case 3:var match$5=type_padding(fmt[0],fmtty);var match$6=match$5[1];if(typeof match$6==="number"){throw Type_mismatch}else if(match$6.tag===1){var match$7=type_format_gen(fmt[1],match$6[0]);return[Block.__(3,[match$5[0],match$7[0]]),match$7[1]]}else{throw Type_mismatch}case 4:var match$8=type_padprec(fmt[1],fmt[2],fmtty);var match$9=match$8[2];if(typeof match$9==="number"){throw Type_mismatch}else if(match$9.tag===2){var match$10=type_format_gen(fmt[3],match$9[0]);return[Block.__(4,[fmt[0],match$8[0],match$8[1],match$10[0]]),match$10[1]]}else{throw Type_mismatch}case 5:var match$11=type_padprec(fmt[1],fmt[2],fmtty);var match$12=match$11[2];if(typeof match$12==="number"){throw Type_mismatch}else if(match$12.tag===3){var match$13=type_format_gen(fmt[3],match$12[0]);return[Block.__(5,[fmt[0],match$11[0],match$11[1],match$13[0]]),match$13[1]]}else{throw Type_mismatch}case 6:var match$14=type_padprec(fmt[1],fmt[2],fmtty);var match$15=match$14[2];if(typeof match$15==="number"){throw Type_mismatch}else if(match$15.tag===4){var match$16=type_format_gen(fmt[3],match$15[0]);return[Block.__(6,[fmt[0],match$14[0],match$14[1],match$16[0]]),match$16[1]]}else{throw Type_mismatch}case 7:var match$17=type_padprec(fmt[1],fmt[2],fmtty);var match$18=match$17[2];if(typeof match$18==="number"){throw Type_mismatch}else if(match$18.tag===5){var match$19=type_format_gen(fmt[3],match$18[0]);return[Block.__(7,[fmt[0],match$17[0],match$17[1],match$19[0]]),match$19[1]]}else{throw Type_mismatch}case 8:var match$20=type_padprec(fmt[1],fmt[2],fmtty);var match$21=match$20[2];if(typeof match$21==="number"){throw Type_mismatch}else if(match$21.tag===6){var match$22=type_format_gen(fmt[3],match$21[0]);return[Block.__(8,[fmt[0],match$20[0],match$20[1],match$22[0]]),match$22[1]]}else{throw Type_mismatch}case 9:var match$23=type_padding(fmt[0],fmtty);var match$24=match$23[1];if(typeof match$24==="number"){throw Type_mismatch}else if(match$24.tag===7){var match$25=type_format_gen(fmt[1],match$24[0]);return[Block.__(9,[match$23[0],match$25[0]]),match$25[1]]}else{throw Type_mismatch}case 10:var match$26=type_format_gen(fmt[0],fmtty);return[Block.__(10,[match$26[0]]),match$26[1]];case 11:var match$27=type_format_gen(fmt[1],fmtty);return[Block.__(11,[fmt[0],match$27[0]]),match$27[1]];case 12:var match$28=type_format_gen(fmt[1],fmtty);return[Block.__(12,[fmt[0],match$28[0]]),match$28[1]];case 13:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===8){var sub_fmtty$prime=fmtty[0];if(Caml_obj.caml_notequal([fmt[1]],[sub_fmtty$prime])){throw Type_mismatch}var match$29=type_format_gen(fmt[2],fmtty[1]);return[Block.__(13,[fmt[0],sub_fmtty$prime,match$29[0]]),match$29[1]]}else{throw Type_mismatch}case 14:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===9){var sub_fmtty1=fmtty[0];if(Caml_obj.caml_notequal([CamlinternalFormatBasics.erase_rel(fmt[1])],[CamlinternalFormatBasics.erase_rel(sub_fmtty1)])){throw Type_mismatch}var match$30=type_format_gen(fmt[2],CamlinternalFormatBasics.erase_rel(fmtty[2]));return[Block.__(14,[fmt[0],sub_fmtty1,match$30[0]]),match$30[1]]}else{throw Type_mismatch}case 15:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===10){var match$31=type_format_gen(fmt[0],fmtty[0]);return[Block.__(15,[match$31[0]]),match$31[1]]}else{throw Type_mismatch}case 16:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===11){var match$32=type_format_gen(fmt[0],fmtty[0]);return[Block.__(16,[match$32[0]]),match$32[1]]}else{throw Type_mismatch}case 17:var match$33=type_format_gen(fmt[1],fmtty);return[Block.__(17,[fmt[0],match$33[0]]),match$33[1]];case 18:var formatting_gen=fmt[0];var fmt0=fmt[1];var fmtty0=fmtty;if(formatting_gen.tag){var match$34=formatting_gen[0];var match$35=type_format_gen(match$34[0],fmtty0);var match$36=type_format_gen(fmt0,match$35[1]);return[Block.__(18,[Block.__(1,[[match$35[0],match$34[1]]]),match$36[0]]),match$36[1]]}else{var match$37=formatting_gen[0];var match$38=type_format_gen(match$37[0],fmtty0);var match$39=type_format_gen(fmt0,match$38[1]);return[Block.__(18,[Block.__(0,[[match$38[0],match$37[1]]]),match$39[0]]),match$39[1]]}case 19:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===13){var match$40=type_format_gen(fmt[0],fmtty[0]);return[Block.__(19,[match$40[0]]),match$40[1]]}else{throw Type_mismatch}case 20:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===1){var match$41=type_format_gen(fmt[2],fmtty[0]);return[Block.__(20,[fmt[0],fmt[1],match$41[0]]),match$41[1]]}else{throw Type_mismatch}case 21:if(typeof fmtty==="number"){throw Type_mismatch}else if(fmtty.tag===2){var match$42=type_format_gen(fmt[1],fmtty[0]);return[Block.__(21,[fmt[0],match$42[0]]),match$42[1]]}else{throw Type_mismatch}case 23:var ign=fmt[0];var fmt$1=fmt[1];var fmtty$1=fmtty;if(typeof ign==="number"){if(ign===2){if(typeof fmtty$1==="number"){throw Type_mismatch}else if(fmtty$1.tag===14){var match$43=type_format_gen(fmt$1,fmtty$1[0]);return[Block.__(23,[2,match$43[0]]),match$43[1]]}else{throw Type_mismatch}}else{return type_ignored_param_one(ign,fmt$1,fmtty$1)}}else{switch(ign.tag|0){case 8:return type_ignored_param_one(Block.__(8,[ign[0],ign[1]]),fmt$1,fmtty$1);case 9:var match$44=type_ignored_format_substitution(ign[1],fmt$1,fmtty$1);var match$45=match$44[1];return[Block.__(23,[Block.__(9,[ign[0],match$44[0]]),match$45[0]]),match$45[1]];default:return type_ignored_param_one(ign,fmt$1,fmtty$1)}}case 22:case 24:throw Type_mismatch}}}function type_ignored_param_one(ign,fmt,fmtty){var match=type_format_gen(fmt,fmtty);return[Block.__(23,[ign,match[0]]),match[1]]}function type_format(fmt,fmtty){var match=type_format_gen(fmt,fmtty);if(typeof match[1]==="number"){return match[0]}else{throw Type_mismatch}}function recast(fmt,fmtty){return type_format(fmt,CamlinternalFormatBasics.erase_rel(symm(fmtty)))}function fix_padding(padty,width,str){var len=str.length;var width$1=Pervasives.abs(width);var padty$1=width<0?0:padty;if(width$1<=len){return str}else{var res=Bytes.make(width$1,padty$1===2?48:32);switch(padty$1){case 0:$$String.blit(str,0,res,0,len);break;case 1:$$String.blit(str,0,res,width$1-len|0,len);break;case 2:if(len>0&&(Caml_string.get(str,0)===43||Caml_string.get(str,0)===45||Caml_string.get(str,0)===32)){res[0]=Caml_string.get(str,0);$$String.blit(str,1,res,(width$1-len|0)+1|0,len-1|0)}else if(len>1&&Caml_string.get(str,0)===48&&(Caml_string.get(str,1)===120||Caml_string.get(str,1)===88)){res[1]=Caml_string.get(str,1);$$String.blit(str,2,res,(width$1-len|0)+2|0,len-2|0)}else{$$String.blit(str,0,res,width$1-len|0,len)}break}return Caml_bytes.bytes_to_string(res)}}function fix_int_precision(prec,str){var prec$1=Pervasives.abs(prec);var len=str.length;var c=Caml_string.get(str,0);var exit=0;if(c>=58){if(c>=71){if(c>102||c<97){return str}else{exit=2}}else if(c>=65){exit=2}else{return str}}else if(c!==32){if(c>=43){switch(c-43|0){case 0:case 2:exit=1;break;case 1:case 3:case 4:return str;case 5:if((prec$1+2|0)>len&&len>1&&(Caml_string.get(str,1)===120||Caml_string.get(str,1)===88)){var res=Bytes.make(prec$1+2|0,48);res[1]=Caml_string.get(str,1);$$String.blit(str,2,res,(prec$1-len|0)+4|0,len-2|0);return Caml_bytes.bytes_to_string(res)}else{exit=2}break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:exit=2;break}}else{return str}}else{exit=1}switch(exit){case 1:if((prec$1+1|0)>len){var res$1=Bytes.make(prec$1+1|0,48);res$1[0]=c;$$String.blit(str,1,res$1,(prec$1-len|0)+2|0,len-1|0);return Caml_bytes.bytes_to_string(res$1)}else{return str}case 2:if(prec$1>len){var res$2=Bytes.make(prec$1,48);$$String.blit(str,0,res$2,prec$1-len|0,len);return Caml_bytes.bytes_to_string(res$2)}else{return str}}}function string_to_caml_string(str){var str$1=$$String.escaped(str);var l=str$1.length;var res=Bytes.make(l+2|0,34);Caml_bytes.caml_blit_string(str$1,0,res,1,l);return Caml_bytes.bytes_to_string(res)}function format_of_iconv(param){switch(param){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}function format_of_iconvL(param){switch(param){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}function format_of_iconvl(param){switch(param){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}function format_of_iconvn(param){switch(param){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}function format_of_fconv(fconv,prec){if(fconv===15){return"%.12g"}else{var prec$1=Pervasives.abs(prec);var symb=char_of_fconv(fconv);var buf={ind:0,bytes:Caml_bytes.caml_create_bytes(16)};buffer_add_char(buf,37);bprint_fconv_flag(buf,fconv);buffer_add_char(buf,46);buffer_add_string(buf,String(prec$1));buffer_add_char(buf,symb);return buffer_contents(buf)}}function convert_int(iconv,n){return Caml_format.caml_format_int(format_of_iconv(iconv),n)}function convert_int32(iconv,n){return Caml_format.caml_int32_format(format_of_iconvl(iconv),n)}function convert_nativeint(iconv,n){return Caml_format.caml_nativeint_format(format_of_iconvn(iconv),n)}function convert_int64(iconv,n){return Caml_format.caml_int64_format(format_of_iconvL(iconv),n)}function convert_float(fconv,prec,x){if(fconv>=16){var sign;if(fconv>=17){switch(fconv-17|0){case 2:sign=45;break;case 0:case 3:sign=43;break;case 1:case 4:sign=32;break}}else{sign=45}var str=Caml_format.caml_hexstring_of_float(x,prec,sign);if(fconv>=19){return Caml_bytes.bytes_to_string(Bytes.uppercase_ascii(Caml_bytes.bytes_of_string(str)))}else{return str}}else{var str$1=Caml_format.caml_format_float(format_of_fconv(fconv,prec),x);if(fconv!==15){return str$1}else{var len=str$1.length;var is_valid=function(_i){while(true){var i=_i;if(i===len){return false}else{var match=Caml_string.get(str$1,i);var switcher=match-46|0;if(switcher>23||switcher<0){if(switcher!==55){_i=i+1|0;continue}else{return true}}else if(switcher>22||switcher<1){return true}else{_i=i+1|0;continue}}}};var match=Pervasives.classify_float(x);if(match!==3){if(match>=4){return"nan"}else if(is_valid(0)){return str$1}else{return str$1+"."}}else if(x<0){return"neg_infinity"}else{return"infinity"}}}}function format_caml_char(c){var str=Char.escaped(c);var l=str.length;var res=Bytes.make(l+2|0,39);Caml_bytes.caml_blit_string(str,0,res,1,l);return Caml_bytes.bytes_to_string(res)}function string_of_fmtty(fmtty){var buf={ind:0,bytes:Caml_bytes.caml_create_bytes(16)};bprint_fmtty(buf,fmtty);return buffer_contents(buf)}function make_printf(_k,o,_acc,_fmt){while(true){var fmt=_fmt;var acc=_acc;var k=_k;if(typeof fmt==="number"){return Curry._2(k,o,acc)}else{switch(fmt.tag|0){case 0:var rest=fmt[0];return function(k,acc,rest){return function(c){var new_acc=Block.__(5,[acc,c]);return make_printf(k,o,new_acc,rest)}}(k,acc,rest);case 1:var rest$1=fmt[0];return function(k,acc,rest$1){return function(c){var new_acc_001=format_caml_char(c);var new_acc=Block.__(4,[acc,new_acc_001]);return make_printf(k,o,new_acc,rest$1)}}(k,acc,rest$1);case 2:return make_padding(k,o,acc,fmt[1],fmt[0],function(str){return str});case 3:return make_padding(k,o,acc,fmt[1],fmt[0],string_to_caml_string);case 4:return make_int_padding_precision(k,o,acc,fmt[3],fmt[1],fmt[2],convert_int,fmt[0]);case 5:return make_int_padding_precision(k,o,acc,fmt[3],fmt[1],fmt[2],convert_int32,fmt[0]);case 6:return make_int_padding_precision(k,o,acc,fmt[3],fmt[1],fmt[2],convert_nativeint,fmt[0]);case 7:return make_int_padding_precision(k,o,acc,fmt[3],fmt[1],fmt[2],convert_int64,fmt[0]);case 8:var k$1=k;var o$1=o;var acc$1=acc;var fmt$1=fmt[3];var pad=fmt[1];var prec=fmt[2];var fconv=fmt[0];if(typeof pad==="number"){if(typeof prec==="number"){if(prec!==0){return function(k$1,o$1,acc$1,fmt$1,fconv){return function(p,x){var str=convert_float(fconv,p,x);return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv)}else{return function(k$1,o$1,acc$1,fmt$1,fconv){return function(x){var str=convert_float(fconv,-6,x);return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv)}}else{var p=prec[0];return function(k$1,o$1,acc$1,fmt$1,fconv,p){return function(x){var str=convert_float(fconv,p,x);return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,p)}}else if(pad.tag){var padty=pad[0];if(typeof prec==="number"){if(prec!==0){return function(k$1,o$1,acc$1,fmt$1,fconv,padty){return function(w,p,x){var str=fix_padding(padty,w,convert_float(fconv,p,x));return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty)}else{return function(k$1,o$1,acc$1,fmt$1,fconv,padty){return function(w,x){var str=convert_float(fconv,-6,x);var str$prime=fix_padding(padty,w,str);return make_printf(k$1,o$1,Block.__(4,[acc$1,str$prime]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty)}}else{var p$1=prec[0];return function(k$1,o$1,acc$1,fmt$1,fconv,padty,p$1){return function(w,x){var str=fix_padding(padty,w,convert_float(fconv,p$1,x));return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty,p$1)}}else{var w=pad[1];var padty$1=pad[0];if(typeof prec==="number"){if(prec!==0){return function(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w){return function(p,x){var str=fix_padding(padty$1,w,convert_float(fconv,p,x));return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w)}else{return function(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w){return function(x){var str=convert_float(fconv,-6,x);var str$prime=fix_padding(padty$1,w,str);return make_printf(k$1,o$1,Block.__(4,[acc$1,str$prime]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w)}}else{var p$2=prec[0];return function(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w,p$2){return function(x){var str=fix_padding(padty$1,w,convert_float(fconv,p$2,x));return make_printf(k$1,o$1,Block.__(4,[acc$1,str]),fmt$1)}}(k$1,o$1,acc$1,fmt$1,fconv,padty$1,w,p$2)}}case 9:return make_padding(k,o,acc,fmt[1],fmt[0],Pervasives.string_of_bool);case 10:_fmt=fmt[0];_acc=Block.__(7,[acc]);continue;case 11:_fmt=fmt[1];_acc=Block.__(2,[acc,fmt[0]]);continue;case 12:_fmt=fmt[1];_acc=Block.__(3,[acc,fmt[0]]);continue;case 13:var rest$2=fmt[2];var ty=string_of_fmtty(fmt[1]);return function(k,acc,rest$2,ty){return function(str){return make_printf(k,o,Block.__(4,[acc,ty]),rest$2)}}(k,acc,rest$2,ty);case 14:var rest$3=fmt[2];var fmtty=fmt[1];return function(k,acc,fmtty,rest$3){return function(param){return make_printf(k,o,acc,CamlinternalFormatBasics.concat_fmt(recast(param[0],fmtty),rest$3))}}(k,acc,fmtty,rest$3);case 15:var rest$4=fmt[0];return function(k,acc,rest$4){return function(f,x){return make_printf(k,o,Block.__(6,[acc,function(o){return Curry._2(f,o,x)}]),rest$4)}}(k,acc,rest$4);case 16:var rest$5=fmt[0];return function(k,acc,rest$5){return function(f){return make_printf(k,o,Block.__(6,[acc,f]),rest$5)}}(k,acc,rest$5);case 17:_fmt=fmt[1];_acc=Block.__(0,[acc,fmt[0]]);continue;case 18:var match=fmt[0];if(match.tag){var rest$6=fmt[1];var k$prime=function(k,acc,rest$6){return function k$prime(koc,kacc){return make_printf(k,koc,Block.__(1,[acc,Block.__(1,[kacc])]),rest$6)}}(k,acc,rest$6);_fmt=match[0][0];_acc=0
;_k=k$prime;continue}else{var rest$7=fmt[1];var k$prime$1=function(k,acc,rest$7){return function k$prime$1(koc,kacc){return make_printf(k,koc,Block.__(1,[acc,Block.__(0,[kacc])]),rest$7)}}(k,acc,rest$7);_fmt=match[0][0];_acc=0;_k=k$prime$1;continue}case 19:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",1525,4]];case 20:var rest$8=fmt[2];var new_acc=Block.__(8,[acc,"Printf: bad conversion %["]);return function(k,rest$8,new_acc){return function(param){return make_printf(k,o,new_acc,rest$8)}}(k,rest$8,new_acc);case 21:var rest$9=fmt[1];return function(k,acc,rest$9){return function(n){var new_acc_001=Caml_format.caml_format_int("%u",n);var new_acc=Block.__(4,[acc,new_acc_001]);return make_printf(k,o,new_acc,rest$9)}}(k,acc,rest$9);case 22:var rest$10=fmt[0];return function(k,acc,rest$10){return function(c){var new_acc=Block.__(5,[acc,c]);return make_printf(k,o,new_acc,rest$10)}}(k,acc,rest$10);case 23:return make_ignored_param(k,o,acc,fmt[0],fmt[1]);case 24:return make_custom(k,o,acc,fmt[2],fmt[0],Curry._1(fmt[1],0))}}}}function make_ignored_param(k,o,acc,ign,fmt){if(typeof ign==="number"){if(ign===2){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",1593,39]]}else{return make_invalid_arg(k,o,acc,fmt)}}else if(ign.tag===9){return make_from_fmtty(k,o,acc,ign[1],fmt)}else{return make_invalid_arg(k,o,acc,fmt)}}function make_from_fmtty(k,o,acc,fmtty,fmt){if(typeof fmtty==="number"){return make_invalid_arg(k,o,acc,fmt)}else{switch(fmtty.tag|0){case 0:var rest=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest,fmt)};case 1:var rest$1=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$1,fmt)};case 2:var rest$2=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$2,fmt)};case 3:var rest$3=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$3,fmt)};case 4:var rest$4=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$4,fmt)};case 5:var rest$5=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$5,fmt)};case 6:var rest$6=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$6,fmt)};case 7:var rest$7=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$7,fmt)};case 8:var rest$8=fmtty[1];return function(param){return make_from_fmtty(k,o,acc,rest$8,fmt)};case 9:var rest$9=fmtty[2];var ty=trans(symm(fmtty[0]),fmtty[1]);return function(param){return make_from_fmtty(k,o,acc,CamlinternalFormatBasics.concat_fmtty(ty,rest$9),fmt)};case 10:var rest$10=fmtty[0];return function(param,param$1){return make_from_fmtty(k,o,acc,rest$10,fmt)};case 11:var rest$11=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$11,fmt)};case 12:var rest$12=fmtty[0];return function(param){return make_from_fmtty(k,o,acc,rest$12,fmt)};case 13:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",1616,31]];case 14:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",1617,31]]}}}function make_invalid_arg(k,o,acc,fmt){return make_printf(k,o,Block.__(8,[acc,"Printf: bad conversion %_"]),fmt)}function make_padding(k,o,acc,fmt,pad,trans){if(typeof pad==="number"){return function(x){var new_acc_001=Curry._1(trans,x);var new_acc=Block.__(4,[acc,new_acc_001]);return make_printf(k,o,new_acc,fmt)}}else if(pad.tag){var padty=pad[0];return function(w,x){var new_acc_001=fix_padding(padty,w,Curry._1(trans,x));var new_acc=Block.__(4,[acc,new_acc_001]);return make_printf(k,o,new_acc,fmt)}}else{var width=pad[1];var padty$1=pad[0];return function(x){var new_acc_001=fix_padding(padty$1,width,Curry._1(trans,x));var new_acc=Block.__(4,[acc,new_acc_001]);return make_printf(k,o,new_acc,fmt)}}}function make_int_padding_precision(k,o,acc,fmt,pad,prec,trans,iconv){if(typeof pad==="number"){if(typeof prec==="number"){if(prec!==0){return function(p,x){var str=fix_int_precision(p,Curry._2(trans,iconv,x));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}else{return function(x){var str=Curry._2(trans,iconv,x);return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}else{var p=prec[0];return function(x){var str=fix_int_precision(p,Curry._2(trans,iconv,x));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}else if(pad.tag){var padty=pad[0];if(typeof prec==="number"){if(prec!==0){return function(w,p,x){var str=fix_padding(padty,w,fix_int_precision(p,Curry._2(trans,iconv,x)));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}else{return function(w,x){var str=fix_padding(padty,w,Curry._2(trans,iconv,x));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}else{var p$1=prec[0];return function(w,x){var str=fix_padding(padty,w,fix_int_precision(p$1,Curry._2(trans,iconv,x)));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}else{var w=pad[1];var padty$1=pad[0];if(typeof prec==="number"){if(prec!==0){return function(p,x){var str=fix_padding(padty$1,w,fix_int_precision(p,Curry._2(trans,iconv,x)));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}else{return function(x){var str=fix_padding(padty$1,w,Curry._2(trans,iconv,x));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}else{var p$2=prec[0];return function(x){var str=fix_padding(padty$1,w,fix_int_precision(p$2,Curry._2(trans,iconv,x)));return make_printf(k,o,Block.__(4,[acc,str]),fmt)}}}}function make_custom(k,o,acc,rest,arity,f){if(arity){var arity$1=arity[0];return function(x){return make_custom(k,o,acc,rest,arity$1,Curry._1(f,x))}}else{return make_printf(k,o,Block.__(4,[acc,f]),rest)}}function make_iprintf(_k,o,_fmt){while(true){var fmt=_fmt;var k=_k;var exit=0;if(typeof fmt==="number"){return Curry._1(k,o)}else{switch(fmt.tag|0){case 2:var tmp=fmt[0];if(typeof tmp!=="number"&&tmp.tag){var partial_arg=make_iprintf(k,o,fmt[1]);var partial_arg$1=function(partial_arg){return function partial_arg$1(param){return partial_arg}}(partial_arg);return function(param){return partial_arg$1}}var partial_arg$2=make_iprintf(k,o,fmt[1]);return function(partial_arg$2){return function(param){return partial_arg$2}}(partial_arg$2);case 3:var tmp$1=fmt[0];if(typeof tmp$1!=="number"&&tmp$1.tag){var partial_arg$3=make_iprintf(k,o,fmt[1]);var partial_arg$4=function(partial_arg$3){return function partial_arg$4(param){return partial_arg$3}}(partial_arg$3);return function(param){return partial_arg$4}}var partial_arg$5=make_iprintf(k,o,fmt[1]);return function(partial_arg$5){return function(param){return partial_arg$5}}(partial_arg$5);case 9:var tmp$2=fmt[0];if(typeof tmp$2!=="number"&&tmp$2.tag){var partial_arg$6=make_iprintf(k,o,fmt[1]);var partial_arg$7=function(partial_arg$6){return function partial_arg$7(param){return partial_arg$6}}(partial_arg$6);return function(param){return partial_arg$7}}var partial_arg$8=make_iprintf(k,o,fmt[1]);return function(partial_arg$8){return function(param){return partial_arg$8}}(partial_arg$8);case 10:_fmt=fmt[0];continue;case 14:var rest=fmt[2];var fmtty=fmt[1];return function(k,fmtty,rest){return function(param){return make_iprintf(k,o,CamlinternalFormatBasics.concat_fmt(recast(param[0],fmtty),rest))}}(k,fmtty,rest);case 15:var partial_arg$9=make_iprintf(k,o,fmt[0]);var partial_arg$10=function(partial_arg$9){return function partial_arg$10(param){return partial_arg$9}}(partial_arg$9);return function(param){return partial_arg$10};case 11:case 12:case 17:exit=2;break;case 18:var match=fmt[0];if(match.tag){var rest$1=fmt[1];_fmt=match[0][0];_k=function(k,rest$1){return function(koc){return make_iprintf(k,koc,rest$1)}}(k,rest$1);continue}else{var rest$2=fmt[1];_fmt=match[0][0];_k=function(k,rest$2){return function(koc){return make_iprintf(k,koc,rest$2)}}(k,rest$2);continue}case 19:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",1797,8]];case 13:case 20:exit=3;break;case 21:var partial_arg$11=make_iprintf(k,o,fmt[1]);return function(partial_arg$11){return function(param){return partial_arg$11}}(partial_arg$11);case 0:case 1:case 16:case 22:exit=1;break;case 23:return make_ignored_param(function(k){return function(x,param){return Curry._1(k,x)}}(k),o,0,fmt[0],fmt[1]);case 24:return fn_of_custom_arity(k,o,fmt[2],fmt[0]);default:var k$1=k;var o$1=o;var fmt$1=fmt[3];var pad=fmt[1];var prec=fmt[2];if(typeof pad==="number"){if(typeof prec==="number"){if(prec!==0){var partial_arg$12=make_iprintf(k$1,o$1,fmt$1);var partial_arg$13=function(partial_arg$12){return function partial_arg$13(param){return partial_arg$12}}(partial_arg$12);return function(param){return partial_arg$13}}else{var partial_arg$14=make_iprintf(k$1,o$1,fmt$1);return function(partial_arg$14){return function(param){return partial_arg$14}}(partial_arg$14)}}else{var partial_arg$15=make_iprintf(k$1,o$1,fmt$1);return function(partial_arg$15){return function(param){return partial_arg$15}}(partial_arg$15)}}else if(pad.tag){if(typeof prec==="number"){if(prec!==0){var partial_arg$16=make_iprintf(k$1,o$1,fmt$1);var partial_arg$17=function(partial_arg$16){return function partial_arg$17(param){return partial_arg$16}}(partial_arg$16);var partial_arg$18=function(param){return partial_arg$17};return function(param){return partial_arg$18}}else{var partial_arg$19=make_iprintf(k$1,o$1,fmt$1);var partial_arg$20=function(partial_arg$19){return function partial_arg$20(param){return partial_arg$19}}(partial_arg$19);return function(param){return partial_arg$20}}}else{var partial_arg$21=make_iprintf(k$1,o$1,fmt$1);var partial_arg$22=function(partial_arg$21){return function partial_arg$22(param){return partial_arg$21}}(partial_arg$21);return function(param){return partial_arg$22}}}else if(typeof prec==="number"){if(prec!==0){var partial_arg$23=make_iprintf(k$1,o$1,fmt$1);var partial_arg$24=function(partial_arg$23){return function partial_arg$24(param){return partial_arg$23}}(partial_arg$23);return function(param){return partial_arg$24}}else{var partial_arg$25=make_iprintf(k$1,o$1,fmt$1);return function(partial_arg$25){return function(param){return partial_arg$25}}(partial_arg$25)}}else{var partial_arg$26=make_iprintf(k$1,o$1,fmt$1);return function(partial_arg$26){return function(param){return partial_arg$26}}(partial_arg$26)}}}switch(exit){case 1:var partial_arg$27=make_iprintf(k,o,fmt[0]);return function(partial_arg$27){return function(param){return partial_arg$27}}(partial_arg$27);case 2:_fmt=fmt[1];continue;case 3:var partial_arg$28=make_iprintf(k,o,fmt[2]);return function(partial_arg$28){return function(param){return partial_arg$28}}(partial_arg$28)}}}function fn_of_custom_arity(k,o,fmt,param){if(param){var partial_arg=fn_of_custom_arity(k,o,fmt,param[0]);return function(param){return partial_arg}}else{return make_iprintf(k,o,fmt)}}function output_acc(o,_acc){while(true){var acc=_acc;var exit=0;if(typeof acc==="number"){return 0}else{switch(acc.tag|0){case 0:var s=string_of_formatting_lit(acc[1]);output_acc(o,acc[0]);return Pervasives.output_string(o,s);case 1:var match=acc[1];var p=acc[0];output_acc(o,p);if(match.tag){Pervasives.output_string(o,"@[");_acc=match[0];continue}else{Pervasives.output_string(o,"@{");_acc=match[0];continue}case 2:case 4:exit=1;break;case 3:case 5:exit=2;break;case 6:output_acc(o,acc[0]);return Curry._1(acc[1],o);case 7:output_acc(o,acc[0]);return Caml_io.caml_ml_flush(o);case 8:output_acc(o,acc[0]);throw[Caml_builtin_exceptions.invalid_argument,acc[1]]}}switch(exit){case 1:output_acc(o,acc[0]);return Pervasives.output_string(o,acc[1]);case 2:output_acc(o,acc[0]);return Caml_io.caml_ml_output_char(o,acc[1])}}}function bufput_acc(b,_acc){while(true){var acc=_acc;var exit=0;if(typeof acc==="number"){return 0}else{switch(acc.tag|0){case 0:var s=string_of_formatting_lit(acc[1]);bufput_acc(b,acc[0]);return $$Buffer.add_string(b,s);case 1:var match=acc[1];var p=acc[0];bufput_acc(b,p);if(match.tag){$$Buffer.add_string(b,"@[");_acc=match[0];continue}else{$$Buffer.add_string(b,"@{");_acc=match[0];continue}case 2:case 4:exit=1;break;case 3:case 5:exit=2;break;case 6:bufput_acc(b,acc[0]);return Curry._1(acc[1],b);case 7:_acc=acc[0];continue;case 8:bufput_acc(b,acc[0]);throw[Caml_builtin_exceptions.invalid_argument,acc[1]]}}switch(exit){case 1:bufput_acc(b,acc[0]);return $$Buffer.add_string(b,acc[1]);case 2:bufput_acc(b,acc[0]);return $$Buffer.add_char(b,acc[1])}}}function strput_acc(b,_acc){while(true){var acc=_acc;var exit=0;if(typeof acc==="number"){return 0}else{switch(acc.tag|0){case 0:var s=string_of_formatting_lit(acc[1]);strput_acc(b,acc[0]);return $$Buffer.add_string(b,s);case 1:var match=acc[1];var p=acc[0];strput_acc(b,p);if(match.tag){$$Buffer.add_string(b,"@[");_acc=match[0];continue}else{$$Buffer.add_string(b,"@{");_acc=match[0];continue}case 2:case 4:exit=1;break;case 3:case 5:exit=2;break;case 6:strput_acc(b,acc[0]);return $$Buffer.add_string(b,Curry._1(acc[1],0));case 7:_acc=acc[0];continue;case 8:strput_acc(b,acc[0]);throw[Caml_builtin_exceptions.invalid_argument,acc[1]]}}switch(exit){case 1:strput_acc(b,acc[0]);return $$Buffer.add_string(b,acc[1]);case 2:strput_acc(b,acc[0]);return $$Buffer.add_char(b,acc[1])}}}function failwith_message(param){var buf=$$Buffer.create(256);var k=function(param,acc){strput_acc(buf,acc);var s=$$Buffer.contents(buf);throw[Caml_builtin_exceptions.failure,s]};return make_printf(k,0,0,param[0])}function open_box_of_string(str){if(str===""){return[0,4]}else{var len=str.length;var invalid_box=function(param){return Curry._1(failwith_message([Block.__(11,["invalid box description ",Block.__(3,[0,0])]),"invalid box description %S"]),str)};var parse_spaces=function(_i){while(true){var i=_i;if(i===len){return i}else{var match=Caml_string.get(str,i);if(match!==9){if(match!==32){return i}else{_i=i+1|0;continue}}else{_i=i+1|0;continue}}}};var parse_lword=function(i,_j){while(true){var j=_j;if(j===len){return j}else{var match=Caml_string.get(str,j);if(match>122||match<97){return j}else{_j=j+1|0;continue}}}};var parse_int=function(i,_j){while(true){var j=_j;if(j===len){return j}else{var match=Caml_string.get(str,j);if(match>=48){if(match>=58){return j}else{_j=j+1|0;continue}}else if(match!==45){return j}else{_j=j+1|0;continue}}}};var wstart=parse_spaces(0);var wend=parse_lword(wstart,wstart);var box_name=$$String.sub(str,wstart,wend-wstart|0);var nstart=parse_spaces(wend);var nend=parse_int(nstart,nstart);var indent;if(nstart===nend){indent=0}else{try{indent=Caml_format.caml_int_of_string($$String.sub(str,nstart,nend-nstart|0))}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){indent=invalid_box(0)}else{throw exn}}}var exp_end=parse_spaces(nend);if(exp_end!==len){invalid_box(0)}var box_type;switch(box_name){case"":case"b":box_type=4;break;case"h":box_type=0;break;case"hov":box_type=3;break;case"hv":box_type=2;break;case"v":box_type=1;break;default:box_type=invalid_box(0)}return[indent,box_type]}}function make_padding_fmt_ebb(pad,fmt){if(typeof pad==="number"){return[0,fmt]}else if(pad.tag){return[Block.__(1,[pad[0]]),fmt]}else{return[Block.__(0,[pad[0],pad[1]]),fmt]}}function make_precision_fmt_ebb(prec,fmt){if(typeof prec==="number"){if(prec!==0){return[1,fmt]}else{return[0,fmt]}}else{return[[prec[0]],fmt]}}function make_padprec_fmt_ebb(pad,prec,fmt){var match=make_precision_fmt_ebb(prec,fmt);var fmt$prime=match[1];var prec$1=match[0];if(typeof pad==="number"){return[0,prec$1,fmt$prime]}else if(pad.tag){return[Block.__(1,[pad[0]]),prec$1,fmt$prime]}else{return[Block.__(0,[pad[0],pad[1]]),prec$1,fmt$prime]}}function fmt_ebb_of_string(legacy_behavior,str){var legacy_behavior$1=legacy_behavior!==undefined?legacy_behavior:true;var invalid_format_message=function(str_ind,msg){return Curry._3(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", ",Block.__(2,[0,0])])])])])]),"invalid format %S: at character number %d, %s"]),str,str_ind,msg)};var invalid_format_without=function(str_ind,c,s){return Curry._4(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", '",Block.__(0,[Block.__(11,["' without ",Block.__(2,[0,0])])])])])])])]),"invalid format %S: at character number %d, '%c' without %s"]),str,str_ind,c,s)};var expected_character=function(str_ind,expected,read){return Curry._4(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", ",Block.__(2,[0,Block.__(11,[" expected, read ",Block.__(1,[0])])])])])])])]),"invalid format %S: at character number %d, %s expected, read %C"]),str,str_ind,expected,read)};var parse_after_at=function(str_ind,end_ind){if(str_ind===end_ind){return[Block.__(12,[64,0])]}else{var c=Caml_string.get(str,str_ind);if(c>=65){if(c>=94){switch(c){case 123:return parse_tag(true,str_ind+1|0,end_ind);case 124:break;case 125:var beg_ind=str_ind+1|0;var match=parse_literal(beg_ind,beg_ind,end_ind);return[Block.__(17,[1,match[0]])];default:}}else if(c>=91){switch(c-91|0){case 0:return parse_tag(false,str_ind+1|0,end_ind);case 1:break;case 2:var beg_ind$1=str_ind+1|0;var match$1=parse_literal(beg_ind$1,beg_ind$1,end_ind);return[Block.__(17,[0,match$1[0]])]}}}else if(c!==10){if(c>=32){switch(c-32|0){case 0:var beg_ind$2=str_ind+1|0;var match$2=parse_literal(beg_ind$2,beg_ind$2,end_ind);return[Block.__(17,[Block.__(0,["@ ",1,0]),match$2[0]])];case 5:if((str_ind+1|0)<end_ind&&Caml_string.get(str,str_ind+1|0)===37){var beg_ind$3=str_ind+2|0;var match$3=parse_literal(beg_ind$3,beg_ind$3,end_ind);return[Block.__(17,[6,match$3[0]])]}else{var match$4=parse_literal(str_ind,str_ind,end_ind);return[Block.__(12,[64,match$4[0]])]}case 12:var beg_ind$4=str_ind+1|0;var match$5=parse_literal(beg_ind$4,beg_ind$4,end_ind);return[Block.__(17,[Block.__(0,["@,",0,0]),match$5[0]])];case 14:var beg_ind$5=str_ind+1|0;var match$6=parse_literal(beg_ind$5,beg_ind$5,end_ind);return[Block.__(17,[4,match$6[0]])];case 27:var str_ind$1=str_ind+1|0;var end_ind$1=end_ind;var match$7;try{if(str_ind$1===end_ind$1||Caml_string.get(str,str_ind$1)!==60){throw Caml_builtin_exceptions.not_found}var str_ind_1=parse_spaces(str_ind$1+1|0,end_ind$1);var match$8=Caml_string.get(str,str_ind_1);var exit=0;if(match$8>=48){if(match$8>=58){throw Caml_builtin_exceptions.not_found}exit=1}else{if(match$8!==45){throw Caml_builtin_exceptions.not_found}exit=1}if(exit===1){var match$9=parse_integer(str_ind_1,end_ind$1);var width=match$9[1];var str_ind_3=parse_spaces(match$9[0],end_ind$1);var match$10=Caml_string.get(str,str_ind_3);var switcher=match$10-45|0;if(switcher>12||switcher<0){if(switcher!==17){throw Caml_builtin_exceptions.not_found}var s=$$String.sub(str,str_ind$1-2|0,(str_ind_3-str_ind$1|0)+3|0);match$7=[str_ind_3+1|0,Block.__(0,[s,width,0])]}else if(switcher===2||switcher===1){throw Caml_builtin_exceptions.not_found}else{var match$11=parse_integer(str_ind_3,end_ind$1);var str_ind_5=parse_spaces(match$11[0],end_ind$1);if(Caml_string.get(str,str_ind_5)!==62){throw Caml_builtin_exceptions.not_found}var s$1=$$String.sub(str,str_ind$1-2|0,(str_ind_5-str_ind$1|0)+3|0);match$7=[str_ind_5+1|0,Block.__(0,[s$1,width,match$11[1]])]}}}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn===Caml_builtin_exceptions.not_found||exn[0]===Caml_builtin_exceptions.failure){match$7=[str_ind$1,Block.__(0,["@;",1,0])]}else{throw exn}}var next_ind=match$7[0];var match$12=parse_literal(next_ind,next_ind,end_ind$1);return[Block.__(17,[match$7[1],match$12[0]])];case 28:var str_ind$2=str_ind+1|0;var end_ind$2=end_ind;var match$13;try{var str_ind_1$1=parse_spaces(str_ind$2,end_ind$2);var match$14=Caml_string.get(str,str_ind_1$1);var exit$1=0;if(match$14>=48){if(match$14>=58){match$13=undefined}else{exit$1=1}}else if(match$14!==45){match$13=undefined}else{exit$1=1}if(exit$1===1){var match$15=parse_integer(str_ind_1$1,end_ind$2);var str_ind_3$1=parse_spaces(match$15[0],end_ind$2);if(Caml_string.get(str,str_ind_3$1)!==62){throw Caml_builtin_exceptions.not_found}var s$2=$$String.sub(str,str_ind$2-2|0,(str_ind_3$1-str_ind$2|0)+3|0);match$13=[str_ind_3$1+1|0,Block.__(1,[s$2,match$15[1]])]}}catch(raw_exn$1){var exn$1=Caml_js_exceptions.internalToOCamlException(raw_exn$1);if(exn$1===Caml_builtin_exceptions.not_found||exn$1[0]===Caml_builtin_exceptions.failure){match$13=undefined}else{throw exn$1}}if(match$13!==undefined){var match$16=match$13;var next_ind$1=match$16[0];var match$17=parse_literal(next_ind$1,next_ind$1,end_ind$2);return[Block.__(17,[match$16[1],match$17[0]])]}else{var match$18=parse_literal(str_ind$2,str_ind$2,end_ind$2);return[Block.__(17,[Block.__(2,[60]),match$18[0]])]}case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 29:case 30:break;case 31:var beg_ind$6=str_ind+1|0;var match$19=parse_literal(beg_ind$6,beg_ind$6,end_ind);return[Block.__(17,[2,match$19[0]])];case 32:var beg_ind$7=str_ind+1|0;var match$20=parse_literal(beg_ind$7,beg_ind$7,end_ind);return[Block.__(17,[5,match$20[0]])]}}}else{var beg_ind$8=str_ind+1|0;var match$21=parse_literal(beg_ind$8,beg_ind$8,end_ind);return[Block.__(17,[3,match$21[0]])]}var beg_ind$9=str_ind+1|0;var match$22=parse_literal(beg_ind$9,beg_ind$9,end_ind);return[Block.__(17,[Block.__(2,[c]),match$22[0]])]}};var add_literal=function(lit_start,str_ind,fmt){var size=str_ind-lit_start|0;if(size!==0){if(size!==1){return[Block.__(11,[$$String.sub(str,lit_start,size),fmt])]}else{return[Block.__(12,[Caml_string.get(str,lit_start),fmt])]}}else{return[fmt]}};var parse_format=function(pct_ind,end_ind){var pct_ind$1=pct_ind;var str_ind=pct_ind+1|0;var end_ind$1=end_ind;if(str_ind===end_ind$1){invalid_format_message(end_ind$1,"unexpected end of format")}var match=Caml_string.get(str,str_ind);if(match!==95){return parse_flags(pct_ind$1,str_ind,end_ind$1,false)}else{return parse_flags(pct_ind$1,str_ind+1|0,end_ind$1,true)}};var parse_literal=function(lit_start,_str_ind,end_ind){while(true){var str_ind=_str_ind;if(str_ind===end_ind){return add_literal(lit_start,str_ind,0)}else{var match=Caml_string.get(str,str_ind);if(match!==37){if(match!==64){_str_ind=str_ind+1|0;continue}else{var match$1=parse_after_at(str_ind+1|0,end_ind);return add_literal(lit_start,str_ind,match$1[0])}}else{var match$2=parse_format(str_ind,end_ind);return add_literal(lit_start,str_ind,match$2[0])}}}};var parse_spaces=function(_str_ind,end_ind){while(true){var str_ind=_str_ind;if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}if(Caml_string.get(str,str_ind)===32){_str_ind=str_ind+1|0;continue}else{return str_ind}}};var parse_flags=function(pct_ind,str_ind,end_ind,ign){var zero={contents:false};var minus={contents:false};var plus={contents:false};var space={contents:false};var hash={contents:false};var set_flag=function(str_ind,flag){if(flag.contents&&!legacy_behavior$1){Curry._3(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", duplicate flag ",Block.__(1,[0])])])])])]),"invalid format %S: at character number %d, duplicate flag %C"]),str,str_ind,Caml_string.get(str,str_ind))}flag.contents=true;return 0};var _str_ind=str_ind;while(true){var str_ind$1=_str_ind;if(str_ind$1===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var match=Caml_string.get(str,str_ind$1);switch(match){case 32:set_flag(str_ind$1,space);_str_ind=str_ind$1+1|0;continue;case 35:set_flag(str_ind$1,hash);_str_ind=str_ind$1+1|0;continue;case 43:set_flag(str_ind$1,plus);_str_ind=str_ind$1+1|0;continue;case 45:set_flag(str_ind$1,minus);_str_ind=str_ind$1+1|0;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 46:case 47:break;case 48:set_flag(str_ind$1,zero);_str_ind=str_ind$1+1|0;continue;default:}var pct_ind$1=pct_ind;var str_ind$2=str_ind$1;var end_ind$1=end_ind;var zero$1=zero.contents;var minus$1=minus.contents;var plus$1=plus.contents;var hash$1=hash.contents;var space$1=space.contents;var ign$1=ign;if(str_ind$2===end_ind$1){invalid_format_message(end_ind$1,"unexpected end of format")}var padty=zero$1?minus$1?legacy_behavior$1?0:incompatible_flag(pct_ind$1,str_ind$2,45,"0"):2:minus$1?0:1;var match$1=Caml_string.get(str,str_ind$2);if(match$1>=48){if(match$1<58){var match$2=parse_positive(str_ind$2,end_ind$1,0);return parse_after_padding(pct_ind$1,match$2[0],end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,Block.__(0,[padty,match$2[1]]))}}else if(match$1===42){return parse_after_padding(pct_ind$1,str_ind$2+1|0,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,Block.__(1,[padty]))}switch(padty){case 0:if(!legacy_behavior$1){invalid_format_without(str_ind$2-1|0,45,"padding")}return parse_after_padding(pct_ind$1,str_ind$2,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,0);case 1:return parse_after_padding(pct_ind$1,str_ind$2,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,0);case 2:return parse_after_padding(pct_ind$1,str_ind$2,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,Block.__(0,[1,0]))}}};var search_subformat_end=function(_str_ind,end_ind,c){while(true){var str_ind=_str_ind;if(str_ind===end_ind){Curry._3(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[': unclosed sub-format, expected "',Block.__(12,[37,Block.__(0,[Block.__(11,['" at character number ',Block.__(4,[0,0,0,0])])])])])])]),'invalid format %S: unclosed sub-format, expected "%%%c" at character number %d']),str,c,end_ind)}var match=Caml_string.get(str,str_ind);if(match!==37){_str_ind=str_ind+1|0;continue}else{if((str_ind+1|0)===end_ind){invalid_format_message(end_ind,"unexpected end of format")}if(Caml_string.get(str,str_ind+1|0)===c){return str_ind}else{var match$1=Caml_string.get(str,str_ind+1|0);if(match$1>=95){if(match$1>=123){if(match$1<126){switch(match$1-123|0){case 0:var sub_end=search_subformat_end(str_ind+2|0,end_ind,125);_str_ind=sub_end+2|0;continue;case 1:break;case 2:return expected_character(str_ind+1|0,"character ')'",125)}}}else if(match$1<96){if((str_ind+2|0)===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var match$2=Caml_string.get(str,str_ind+2|0);if(match$2!==40){if(match$2!==123){_str_ind=str_ind+3|0;continue}else{var sub_end$1=search_subformat_end(str_ind+3|0,end_ind,125);_str_ind=sub_end$1+2|0;continue}}else{var sub_end$2=search_subformat_end(str_ind+3|0,end_ind,41);_str_ind=sub_end$2+2|0;continue}}}else if(match$1!==40){if(match$1===41){return expected_character(str_ind+1|0,"character '}'",41)}}else{var sub_end$3=search_subformat_end(str_ind+2|0,end_ind,41);_str_ind=sub_end$3+2|0;continue}_str_ind=str_ind+2|0;continue}}}};var parse_positive=function(_str_ind,end_ind,_acc){while(true){var acc=_acc;var str_ind=_str_ind;if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var c=Caml_string.get(str,str_ind);if(c>57||c<48){return[str_ind,acc]}else{var new_acc=Caml_int32.imul(acc,10)+(c-48|0)|0;_acc=new_acc;_str_ind=str_ind+1|0;continue}}};var check_open_box=function(fmt){if(typeof fmt==="number"||!(fmt.tag===11&&typeof fmt[1]==="number")){return 0}else{try{open_box_of_string(fmt[0]);return 0}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return 0}else{throw exn}}}};var parse_conversion=function(pct_ind,str_ind,end_ind,plus,hash,space,ign,pad,prec,padprec,symb){var plus_used=false;var hash_used=false;var space_used=false;var ign_used={contents:false};var pad_used={contents:false};var prec_used={contents:false};var get_int_pad=function(param){pad_used.contents=true;prec_used.contents=true;if(typeof prec==="number"&&prec===0){return pad}if(typeof pad==="number"){return 0}else if(pad.tag){if(pad[0]>=2){if(legacy_behavior$1){return Block.__(1,[1])}else{return incompatible_flag(pct_ind,str_ind,48,"precision")}}else{return pad}}else if(pad[0]>=2){if(legacy_behavior$1){return Block.__(0,[1,pad[1]])}else{return incompatible_flag(pct_ind,str_ind,48,"precision")}}else{return pad}};var check_no_0=function(symb,pad){if(typeof pad==="number"){return pad}else if(pad.tag){if(pad[0]>=2){if(legacy_behavior$1){return Block.__(1,[1])}else{return incompatible_flag(pct_ind,str_ind,symb,"0")}}else{return pad}}else if(pad[0]>=2){if(legacy_behavior$1){return Block.__(0,[1,pad[1]])}else{return incompatible_flag(pct_ind,str_ind,symb,"0")}}else{return pad}};var opt_of_pad=function(c,pad){if(typeof pad==="number"){return}else if(pad.tag){return incompatible_flag(pct_ind,str_ind,c,"'*'")}else{switch(pad[0]){case 0:if(legacy_behavior$1){return pad[1]}else{return incompatible_flag(pct_ind,str_ind,c,"'-'")}case 1:return pad[1];case 2:if(legacy_behavior$1){return pad[1]}else{return incompatible_flag(pct_ind,str_ind,c,"'0'")}}}};var get_prec_opt=function(param){prec_used.contents=true;if(typeof prec==="number"){if(prec!==0){return incompatible_flag(pct_ind,str_ind,95,"'*'")}else{return}}else{return prec[0]}};var fmt_result;var exit=0;var exit$1=0;var exit$2=0;if(symb>=124){exit$1=6}else{switch(symb){case 33:var match=parse_literal(str_ind,str_ind,end_ind);fmt_result=[Block.__(10,[match[0]])];break;case 40:var sub_end=search_subformat_end(str_ind,end_ind,41);var beg_ind=sub_end+2|0;var match$1=parse_literal(beg_ind,beg_ind,end_ind);var fmt_rest=match$1[0];var match$2=parse_literal(str_ind,str_ind,sub_end);var sub_fmtty=fmtty_of_fmt(match$2[0]);if(ign_used.contents=true,ign){var ignored_000=opt_of_pad(95,(pad_used.contents=true,pad));var ignored=Block.__(9,[ignored_000,sub_fmtty]);fmt_result=[Block.__(23,[ignored,fmt_rest])]}else{fmt_result=[Block.__(14,[opt_of_pad(40,(pad_used.contents=true,pad)),sub_fmtty,fmt_rest])]}break;case 44:fmt_result=parse_literal(str_ind,str_ind,end_ind);break;case 37:case 64:exit$1=4;break;case 67:var match$3=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$1=match$3[0];fmt_result=(ign_used.contents=true,ign)?[Block.__(23,[1,fmt_rest$1])]:[Block.__(1,[fmt_rest$1])];break;case 78:var match$4=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$2=match$4[0];if(ign_used.contents=true,ign){var ignored$1=Block.__(11,[2]);fmt_result=[Block.__(23,[ignored$1,fmt_rest$2])]}else{fmt_result=[Block.__(21,[2,fmt_rest$2])]}break;case 83:var pad$1=check_no_0(symb,(pad_used.contents=true,padprec));var match$5=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$3=match$5[0];if(ign_used.contents=true,ign){var ignored$2=Block.__(1,[opt_of_pad(95,(pad_used.contents=true,padprec))]);fmt_result=[Block.__(23,[ignored$2,fmt_rest$3])]}else{var match$6=make_padding_fmt_ebb(pad$1,fmt_rest$3);fmt_result=[Block.__(3,[match$6[0],match$6[1]])]}break;case 91:var match$7=parse_char_set(str_ind,end_ind);var char_set=match$7[1];var next_ind=match$7[0];var match$8=parse_literal(next_ind,next_ind,end_ind);var fmt_rest$4=match$8[0];if(ign_used.contents=true,ign){var ignored_000$1=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$3=Block.__(10,[ignored_000$1,char_set]);fmt_result=[Block.__(23,[ignored$3,fmt_rest$4])]}else{fmt_result=[Block.__(20,[opt_of_pad(91,(pad_used.contents=true,pad)),char_set,fmt_rest$4])]}break;case 32:case 35:case 43:case 45:case 95:exit$1=5;break;case 97:var match$9=parse_literal(str_ind,str_ind,end_ind);fmt_result=[Block.__(15,[match$9[0]])];break;case 66:case 98:exit$1=3;break;case 99:var char_format=function(fmt_rest){if(ign_used.contents=true,ign){return[Block.__(23,[0,fmt_rest])]}else{return[Block.__(0,[fmt_rest])]}};var scan_format=function(fmt_rest){if(ign_used.contents=true,ign){return[Block.__(23,[3,fmt_rest])]}else{return[Block.__(22,[fmt_rest])]}};var match$10=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$5=match$10[0];var match$11=opt_of_pad(99,(pad_used.contents=true,pad));fmt_result=match$11!==undefined?match$11!==0?legacy_behavior$1?char_format(fmt_rest$5):invalid_format_message(str_ind,"non-zero widths are unsupported for %c conversions"):scan_format(fmt_rest$5):char_format(fmt_rest$5);break;case 69:case 70:case 71:case 72:case 101:case 102:case 103:case 104:exit$1=2;break;case 76:case 108:case 110:exit$2=8;break
;case 114:var match$12=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$6=match$12[0];fmt_result=(ign_used.contents=true,ign)?[Block.__(23,[2,fmt_rest$6])]:[Block.__(19,[fmt_rest$6])];break;case 115:var pad$2=check_no_0(symb,(pad_used.contents=true,padprec));var match$13=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$7=match$13[0];if(ign_used.contents=true,ign){var ignored$4=Block.__(0,[opt_of_pad(95,(pad_used.contents=true,padprec))]);fmt_result=[Block.__(23,[ignored$4,fmt_rest$7])]}else{var match$14=make_padding_fmt_ebb(pad$2,fmt_rest$7);fmt_result=[Block.__(2,[match$14[0],match$14[1]])]}break;case 116:var match$15=parse_literal(str_ind,str_ind,end_ind);fmt_result=[Block.__(16,[match$15[0]])];break;case 88:case 100:case 105:case 111:case 117:case 120:exit$2=7;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 34:case 36:case 38:case 39:case 41:case 42:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:case 65:case 68:case 73:case 74:case 75:case 77:case 79:case 80:case 81:case 82:case 84:case 85:case 86:case 87:case 89:case 90:case 92:case 93:case 94:case 96:case 106:case 107:case 109:case 112:case 113:case 118:case 119:case 121:case 122:exit$1=6;break;case 123:var sub_end$1=search_subformat_end(str_ind,end_ind,125);var match$16=parse_literal(str_ind,str_ind,sub_end$1);var beg_ind$1=sub_end$1+2|0;var match$17=parse_literal(beg_ind$1,beg_ind$1,end_ind);var fmt_rest$8=match$17[0];var sub_fmtty$1=fmtty_of_fmt(match$16[0]);if(ign_used.contents=true,ign){var ignored_000$2=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$5=Block.__(8,[ignored_000$2,sub_fmtty$1]);fmt_result=[Block.__(23,[ignored$5,fmt_rest$8])]}else{fmt_result=[Block.__(13,[opt_of_pad(123,(pad_used.contents=true,pad)),sub_fmtty$1,fmt_rest$8])]}break}}switch(exit$2){case 7:plus_used=true;hash_used=true;space_used=true;var iconv=compute_int_conv(pct_ind,str_ind,plus,hash,space,symb);var match$18=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$9=match$18[0];if(ign_used.contents=true,ign){var ignored_001=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$6=Block.__(2,[iconv,ignored_001]);fmt_result=[Block.__(23,[ignored$6,fmt_rest$9])]}else{var match$19=make_padprec_fmt_ebb(get_int_pad(0),(prec_used.contents=true,prec),fmt_rest$9);fmt_result=[Block.__(4,[iconv,match$19[0],match$19[1],match$19[2]])]}break;case 8:if(str_ind===end_ind||!is_int_base(Caml_string.get(str,str_ind))){var match$20=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$10=match$20[0];var counter=counter_of_char(symb);if(ign_used.contents=true,ign){var ignored$7=Block.__(11,[counter]);fmt_result=[Block.__(23,[ignored$7,fmt_rest$10])]}else{fmt_result=[Block.__(21,[counter,fmt_rest$10])]}}else{exit$1=6}break}switch(exit$1){case 2:plus_used=true;space_used=true;var fconv=compute_float_conv(pct_ind,str_ind,plus,space,symb);var match$21=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$11=match$21[0];if(ign_used.contents=true,ign){var ignored_000$3=opt_of_pad(95,(pad_used.contents=true,pad));var ignored_001$1=get_prec_opt(0);var ignored$8=Block.__(6,[ignored_000$3,ignored_001$1]);fmt_result=[Block.__(23,[ignored$8,fmt_rest$11])]}else{var match$22=make_padprec_fmt_ebb((pad_used.contents=true,pad),(prec_used.contents=true,prec),fmt_rest$11);fmt_result=[Block.__(8,[fconv,match$22[0],match$22[1],match$22[2]])]}break;case 3:var pad$3=check_no_0(symb,(pad_used.contents=true,padprec));var match$23=parse_literal(str_ind,str_ind,end_ind);var fmt_rest$12=match$23[0];if(ign_used.contents=true,ign){var ignored$9=Block.__(7,[opt_of_pad(95,(pad_used.contents=true,padprec))]);fmt_result=[Block.__(23,[ignored$9,fmt_rest$12])]}else{var match$24=make_padding_fmt_ebb(pad$3,fmt_rest$12);fmt_result=[Block.__(9,[match$24[0],match$24[1]])]}break;case 4:var match$25=parse_literal(str_ind,str_ind,end_ind);fmt_result=[Block.__(12,[symb,match$25[0]])];break;case 5:fmt_result=Curry._3(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", flag ",Block.__(1,[Block.__(11,[" is only allowed after the '",Block.__(12,[37,Block.__(11,["', before padding and precision",0])])])])])])])])]),"invalid format %S: at character number %d, flag %C is only allowed after the '%%', before padding and precision"]),str,pct_ind,symb);break;case 6:if(symb>=108){if(symb>=111){exit=1}else{switch(symb-108|0){case 0:plus_used=true;hash_used=true;space_used=true;var iconv$1=compute_int_conv(pct_ind,str_ind+1|0,plus,hash,space,Caml_string.get(str,str_ind));var beg_ind$2=str_ind+1|0;var match$26=parse_literal(beg_ind$2,beg_ind$2,end_ind);var fmt_rest$13=match$26[0];if(ign_used.contents=true,ign){var ignored_001$2=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$10=Block.__(3,[iconv$1,ignored_001$2]);fmt_result=[Block.__(23,[ignored$10,fmt_rest$13])]}else{var match$27=make_padprec_fmt_ebb(get_int_pad(0),(prec_used.contents=true,prec),fmt_rest$13);fmt_result=[Block.__(5,[iconv$1,match$27[0],match$27[1],match$27[2]])]}break;case 1:exit=1;break;case 2:plus_used=true;hash_used=true;space_used=true;var iconv$2=compute_int_conv(pct_ind,str_ind+1|0,plus,hash,space,Caml_string.get(str,str_ind));var beg_ind$3=str_ind+1|0;var match$28=parse_literal(beg_ind$3,beg_ind$3,end_ind);var fmt_rest$14=match$28[0];if(ign_used.contents=true,ign){var ignored_001$3=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$11=Block.__(4,[iconv$2,ignored_001$3]);fmt_result=[Block.__(23,[ignored$11,fmt_rest$14])]}else{var match$29=make_padprec_fmt_ebb(get_int_pad(0),(prec_used.contents=true,prec),fmt_rest$14);fmt_result=[Block.__(6,[iconv$2,match$29[0],match$29[1],match$29[2]])]}break}}}else if(symb!==76){exit=1}else{plus_used=true;hash_used=true;space_used=true;var iconv$3=compute_int_conv(pct_ind,str_ind+1|0,plus,hash,space,Caml_string.get(str,str_ind));var beg_ind$4=str_ind+1|0;var match$30=parse_literal(beg_ind$4,beg_ind$4,end_ind);var fmt_rest$15=match$30[0];if(ign_used.contents=true,ign){var ignored_001$4=opt_of_pad(95,(pad_used.contents=true,pad));var ignored$12=Block.__(5,[iconv$3,ignored_001$4]);fmt_result=[Block.__(23,[ignored$12,fmt_rest$15])]}else{var match$31=make_padprec_fmt_ebb(get_int_pad(0),(prec_used.contents=true,prec),fmt_rest$15);fmt_result=[Block.__(7,[iconv$3,match$31[0],match$31[1],match$31[2]])]}}break}if(exit===1){fmt_result=Curry._3(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[', invalid conversion "',Block.__(12,[37,Block.__(0,[Block.__(12,[34,0])])])])])])])]),'invalid format %S: at character number %d, invalid conversion "%%%c"']),str,str_ind-1|0,symb)}if(!legacy_behavior$1){if(!plus_used&&plus){incompatible_flag(pct_ind,str_ind,symb,"'+'")}if(!hash_used&&hash){incompatible_flag(pct_ind,str_ind,symb,"'#'")}if(!space_used&&space){incompatible_flag(pct_ind,str_ind,symb,"' '")}if(!pad_used.contents&&Caml_obj.caml_notequal([pad],[0])){incompatible_flag(pct_ind,str_ind,symb,"`padding'")}if(!prec_used.contents&&Caml_obj.caml_notequal([prec],[0])){incompatible_flag(pct_ind,str_ind,ign?95:symb,"`precision'")}if(ign&&plus){incompatible_flag(pct_ind,str_ind,95,"'+'")}}if(!ign_used.contents&&ign){var exit$3=0;if(symb>=38){if(symb!==44){if(symb!==64||!legacy_behavior$1){exit$3=1}}else if(!legacy_behavior$1){exit$3=1}}else if(symb!==33){if(!(symb>=37&&legacy_behavior$1)){exit$3=1}}else if(!legacy_behavior$1){exit$3=1}if(exit$3===1){incompatible_flag(pct_ind,str_ind,symb,"'_'")}}return fmt_result};var parse_integer=function(str_ind,end_ind){if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var match=Caml_string.get(str,str_ind);if(match>=48){if(match>=58){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2814,11]]}return parse_positive(str_ind,end_ind,0)}else{if(match!==45){throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2814,11]]}if((str_ind+1|0)===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var c=Caml_string.get(str,str_ind+1|0);if(c>57||c<48){return expected_character(str_ind+1|0,"digit",c)}else{var match$1=parse_positive(str_ind+1|0,end_ind,0);return[match$1[0],-match$1[1]|0]}}};var incompatible_flag=function(pct_ind,str_ind,symb,option){var subfmt=$$String.sub(str,pct_ind,str_ind-pct_ind|0);return Curry._5(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": at character number ",Block.__(4,[0,0,0,Block.__(11,[", ",Block.__(2,[0,Block.__(11,[" is incompatible with '",Block.__(0,[Block.__(11,["' in sub-format ",Block.__(3,[0,0])])])])])])])])])]),"invalid format %S: at character number %d, %s is incompatible with '%c' in sub-format %S"]),str,pct_ind,option,symb,subfmt)};var parse_after_padding=function(pct_ind,str_ind,end_ind,minus,plus,hash,space,ign,pad){if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var symb=Caml_string.get(str,str_ind);if(symb!==46){return parse_conversion(pct_ind,str_ind+1|0,end_ind,plus,hash,space,ign,pad,0,pad,symb)}else{var pct_ind$1=pct_ind;var str_ind$1=str_ind+1|0;var end_ind$1=end_ind;var minus$1=minus;var plus$1=plus;var hash$1=hash;var space$1=space;var ign$1=ign;var pad$1=pad;if(str_ind$1===end_ind$1){invalid_format_message(end_ind$1,"unexpected end of format")}var parse_literal=function(minus,str_ind){var match=parse_positive(str_ind,end_ind$1,0);return parse_after_precision(pct_ind$1,match[0],end_ind$1,minus,plus$1,hash$1,space$1,ign$1,pad$1,[match[1]])};var symb$1=Caml_string.get(str,str_ind$1);var exit=0;if(symb$1>=48){if(symb$1<58){return parse_literal(minus$1,str_ind$1)}}else if(symb$1>=42){switch(symb$1-42|0){case 0:return parse_after_precision(pct_ind$1,str_ind$1+1|0,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,pad$1,1);case 1:case 3:exit=2;break;case 2:case 4:case 5:break}}if(exit===2&&legacy_behavior$1){return parse_literal(minus$1||symb$1===45,str_ind$1+1|0)}if(legacy_behavior$1){return parse_after_precision(pct_ind$1,str_ind$1,end_ind$1,minus$1,plus$1,hash$1,space$1,ign$1,pad$1,[0])}else{return invalid_format_without(str_ind$1-1|0,46,"precision")}}};var is_int_base=function(symb){switch(symb){case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 101:case 102:case 103:case 104:case 106:case 107:case 108:case 109:case 110:case 112:case 113:case 114:case 115:case 116:case 118:case 119:return false;case 88:case 100:case 105:case 111:case 117:case 120:return true;default:return false}};var counter_of_char=function(symb){if(symb>=108){if(symb<111){switch(symb-108|0){case 0:return 0;case 1:break;case 2:return 1}}}else if(symb===76){return 2}throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2876,34]]};var parse_char_set=function(str_ind,end_ind){if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var char_set=Bytes.make(32,0);var add_range=function(c,c$prime){for(var i=c;i<=c$prime;++i){add_in_char_set(char_set,Pervasives.char_of_int(i))}return 0};var fail_single_percent=function(str_ind){return Curry._2(failwith_message([Block.__(11,["invalid format ",Block.__(3,[0,Block.__(11,[": '",Block.__(12,[37,Block.__(11,["' alone is not accepted in character sets, use ",Block.__(12,[37,Block.__(12,[37,Block.__(11,[" instead at position ",Block.__(4,[0,0,0,Block.__(12,[46,0])])])])])])])])])]),"invalid format %S: '%%' alone is not accepted in character sets, use %%%% instead at position %d."]),str,str_ind)};var parse_char_set_content=function(_str_ind,end_ind){while(true){var str_ind=_str_ind;if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var c=Caml_string.get(str,str_ind);if(c!==45){if(c!==93){return parse_char_set_after_char(str_ind+1|0,end_ind,c)}else{return str_ind+1|0}}else{add_in_char_set(char_set,45);_str_ind=str_ind+1|0;continue}}};var parse_char_set_after_char=function(_str_ind,end_ind,_c){while(true){var c=_c;var str_ind=_str_ind;if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var c$prime=Caml_string.get(str,str_ind);var exit=0;if(c$prime>=46){if(c$prime!==64){if(c$prime===93){add_in_char_set(char_set,c);return str_ind+1|0}}else{exit=2}}else if(c$prime!==37){if(c$prime>=45){var str_ind$1=str_ind+1|0;var end_ind$1=end_ind;var c$1=c;if(str_ind$1===end_ind$1){invalid_format_message(end_ind$1,"unexpected end of format")}var c$prime$1=Caml_string.get(str,str_ind$1);if(c$prime$1!==37){if(c$prime$1!==93){add_range(c$1,c$prime$1);return parse_char_set_content(str_ind$1+1|0,end_ind$1)}else{add_in_char_set(char_set,c$1);add_in_char_set(char_set,45);return str_ind$1+1|0}}else{if((str_ind$1+1|0)===end_ind$1){invalid_format_message(end_ind$1,"unexpected end of format")}var c$prime$2=Caml_string.get(str,str_ind$1+1|0);if(c$prime$2!==37&&c$prime$2!==64){return fail_single_percent(str_ind$1)}add_range(c$1,c$prime$2);return parse_char_set_content(str_ind$1+2|0,end_ind$1)}}}else{exit=2}if(exit===2&&c===37){add_in_char_set(char_set,c$prime);return parse_char_set_content(str_ind+1|0,end_ind)}if(c===37){fail_single_percent(str_ind)}add_in_char_set(char_set,c);_c=c$prime;_str_ind=str_ind+1|0;continue}};var parse_char_set_start=function(str_ind,end_ind){if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var c=Caml_string.get(str,str_ind);return parse_char_set_after_char(str_ind+1|0,end_ind,c)};if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var match=Caml_string.get(str,str_ind);var match$1=match!==94?[str_ind,false]:[str_ind+1|0,true];var next_ind=parse_char_set_start(match$1[0],end_ind);var char_set$1=Bytes.to_string(char_set);return[next_ind,match$1[1]?rev_char_set(char_set$1):char_set$1]};var compute_int_conv=function(pct_ind,str_ind,_plus,_hash,_space,symb){while(true){var space=_space;var hash=_hash;var plus=_plus;var exit=0;if(plus){if(hash){exit=2}else if(!space){if(symb!==100){if(symb===105){return 4}}else{return 1}}}else if(hash){if(space){exit=2}else if(symb!==88){if(symb!==111){if(symb!==120){exit=2}else{return 7}}else{return 11}}else{return 9}}else if(space){if(symb!==100){if(symb===105){return 5}}else{return 2}}else{switch(symb){case 88:return 8;case 100:return 0;case 105:return 3;case 111:return 10;case 117:return 12;case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 101:case 102:case 103:case 104:case 106:case 107:case 108:case 109:case 110:case 112:case 113:case 114:case 115:case 116:case 118:case 119:break;case 120:return 6;default:}}if(exit===2){var exit$1=0;switch(symb){case 88:if(legacy_behavior$1){return 9}break;case 111:if(legacy_behavior$1){return 11}break;case 100:case 105:case 117:exit$1=3;break;case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 101:case 102:case 103:case 104:case 106:case 107:case 108:case 109:case 110:case 112:case 113:case 114:case 115:case 116:case 118:case 119:break;case 120:if(legacy_behavior$1){return 7}break;default:}if(exit$1===3){if(legacy_behavior$1){_hash=false;continue}else{return incompatible_flag(pct_ind,str_ind,symb,"'#'")}}}if(plus){if(space){if(legacy_behavior$1){_space=false;continue}else{return incompatible_flag(pct_ind,str_ind,32,"'+'")}}else if(legacy_behavior$1){_plus=false;continue}else{return incompatible_flag(pct_ind,str_ind,symb,"'+'")}}else if(space){if(legacy_behavior$1){_space=false;continue}else{return incompatible_flag(pct_ind,str_ind,symb,"' '")}}else{throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2909,28]]}}};var compute_float_conv=function(pct_ind,str_ind,_plus,_space,symb){while(true){var space=_space;var plus=_plus;if(plus){if(space){if(legacy_behavior$1){_space=false;continue}else{return incompatible_flag(pct_ind,str_ind,32,"'+'")}}else{if(symb>=73){switch(symb){case 101:return 4;case 102:return 1;case 103:return 10;case 104:return 17;default:}}else if(symb>=69){switch(symb-69|0){case 0:return 7;case 1:break;case 2:return 13;case 3:return 20}}if(legacy_behavior$1){_plus=false;continue}else{return incompatible_flag(pct_ind,str_ind,symb,"'+'")}}}else if(space){if(symb>=73){switch(symb){case 101:return 5;case 102:return 2;case 103:return 11;case 104:return 18;default:}}else if(symb>=69){switch(symb-69|0){case 0:return 8;case 1:break;case 2:return 14;case 3:return 21}}if(legacy_behavior$1){_space=false;continue}else{return incompatible_flag(pct_ind,str_ind,symb,"' '")}}else if(symb>=73){switch(symb){case 101:return 3;case 102:return 0;case 103:return 9;case 104:return 16;default:throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2943,25]]}}else if(symb>=69){switch(symb-69|0){case 0:return 6;case 1:return 15;case 2:return 12;case 3:return 19}}else{throw[Caml_builtin_exceptions.assert_failure,["camlinternalFormat.ml",2943,25]]}}};var parse_after_precision=function(pct_ind,str_ind,end_ind,minus,plus,hash,space,ign,pad,prec){if(str_ind===end_ind){invalid_format_message(end_ind,"unexpected end of format")}var parse_conv=function(padprec){return parse_conversion(pct_ind,str_ind+1|0,end_ind,plus,hash,space,ign,pad,prec,padprec,Caml_string.get(str,str_ind))};if(typeof pad==="number"){if(typeof prec==="number"&&prec===0){return parse_conv(0)}if(minus){if(typeof prec==="number"){return parse_conv(Block.__(1,[0]))}else{return parse_conv(Block.__(0,[0,prec[0]]))}}else if(typeof prec==="number"){return parse_conv(Block.__(1,[1]))}else{return parse_conv(Block.__(0,[1,prec[0]]))}}else{return parse_conv(pad)}};var parse_tag=function(is_open_tag,str_ind,end_ind){try{if(str_ind===end_ind){throw Caml_builtin_exceptions.not_found}var match=Caml_string.get(str,str_ind);if(match!==60){throw Caml_builtin_exceptions.not_found}var ind=$$String.index_from(str,str_ind+1|0,62);if(ind>=end_ind){throw Caml_builtin_exceptions.not_found}var sub_str=$$String.sub(str,str_ind,(ind-str_ind|0)+1|0);var beg_ind=ind+1|0;var match$1=parse_literal(beg_ind,beg_ind,end_ind);var match$2=parse_literal(str_ind,str_ind,ind+1|0);var sub_fmt=match$2[0];var sub_format=[sub_fmt,sub_str];var formatting=is_open_tag?Block.__(0,[sub_format]):(check_open_box(sub_fmt),Block.__(1,[sub_format]));return[Block.__(18,[formatting,match$1[0]])]}catch(exn){if(exn===Caml_builtin_exceptions.not_found){var match$3=parse_literal(str_ind,str_ind,end_ind);var sub_format$1=[0,""];var formatting$1=is_open_tag?Block.__(0,[sub_format$1]):Block.__(1,[sub_format$1]);return[Block.__(18,[formatting$1,match$3[0]])]}else{throw exn}}};return parse_literal(0,0,str.length)}function format_of_string_fmtty(str,fmtty){var match=fmt_ebb_of_string(undefined,str);try{return[type_format(match[0],fmtty),str]}catch(exn){if(exn===Type_mismatch){return Curry._2(failwith_message([Block.__(11,["bad input: format type mismatch between ",Block.__(3,[0,Block.__(11,[" and ",Block.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),str,string_of_fmtty(fmtty))}else{throw exn}}}function format_of_string_format(str,param){var match=fmt_ebb_of_string(undefined,str);try{return[type_format(match[0],fmtty_of_fmt(param[0])),str]}catch(exn){if(exn===Type_mismatch){return Curry._2(failwith_message([Block.__(11,["bad input: format type mismatch between ",Block.__(3,[0,Block.__(11,[" and ",Block.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),str,param[1])}else{throw exn}}}exports.is_in_char_set=is_in_char_set;exports.rev_char_set=rev_char_set;exports.create_char_set=create_char_set;exports.add_in_char_set=add_in_char_set;exports.freeze_char_set=freeze_char_set;exports.param_format_of_ignored_format=param_format_of_ignored_format;exports.make_printf=make_printf;exports.make_iprintf=make_iprintf;exports.output_acc=output_acc;exports.bufput_acc=bufput_acc;exports.strput_acc=strput_acc;exports.type_format=type_format;exports.fmt_ebb_of_string=fmt_ebb_of_string;exports.format_of_string_fmtty=format_of_string_fmtty;exports.format_of_string_format=format_of_string_format;exports.char_of_iconv=char_of_iconv;exports.string_of_formatting_lit=string_of_formatting_lit;exports.string_of_formatting_gen=string_of_formatting_gen;exports.string_of_fmtty=string_of_fmtty;exports.string_of_fmt=string_of_fmt;exports.open_box_of_string=open_box_of_string;exports.symm=symm;exports.trans=trans;exports.recast=recast},{"./block.js":2,"./buffer.js":3,"./bytes.js":4,"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_exceptions.js":8,"./caml_format.js":10,"./caml_int32.js":11,"./caml_io.js":13,"./caml_js_exceptions.js":14,"./caml_obj.js":17,"./caml_primitive.js":19,"./caml_string.js":20,"./camlinternalFormatBasics.js":24,"./char.js":26,"./curry.js":27,"./pervasives.js":36,"./string.js":39}],24:[function(require,module,exports){"use strict";var Block=require("./block.js");function erase_rel(param){if(typeof param==="number"){return 0}else{switch(param.tag|0){case 0:return Block.__(0,[erase_rel(param[0])]);case 1:return Block.__(1,[erase_rel(param[0])]);case 2:return Block.__(2,[erase_rel(param[0])]);case 3:return Block.__(3,[erase_rel(param[0])]);case 4:return Block.__(4,[erase_rel(param[0])]);case 5:return Block.__(5,[erase_rel(param[0])]);case 6:return Block.__(6,[erase_rel(param[0])]);case 7:return Block.__(7,[erase_rel(param[0])]);case 8:return Block.__(8,[param[0],erase_rel(param[1])]);case 9:var ty1=param[0];return Block.__(9,[ty1,ty1,erase_rel(param[2])]);case 10:return Block.__(10,[erase_rel(param[0])]);case 11:return Block.__(11,[erase_rel(param[0])]);case 12:return Block.__(12,[erase_rel(param[0])]);case 13:return Block.__(13,[erase_rel(param[0])]);case 14:return Block.__(14,[erase_rel(param[0])])}}}function concat_fmtty(fmtty1,fmtty2){if(typeof fmtty1==="number"){return fmtty2}else{switch(fmtty1.tag|0){case 0:return Block.__(0,[concat_fmtty(fmtty1[0],fmtty2)]);case 1:return Block.__(1,[concat_fmtty(fmtty1[0],fmtty2)]);case 2:return Block.__(2,[concat_fmtty(fmtty1[0],fmtty2)]);case 3:return Block.__(3,[concat_fmtty(fmtty1[0],fmtty2)]);case 4:return Block.__(4,[concat_fmtty(fmtty1[0],fmtty2)]);case 5:return Block.__(5,[concat_fmtty(fmtty1[0],fmtty2)]);case 6:return Block.__(6,[concat_fmtty(fmtty1[0],fmtty2)]);case 7:return Block.__(7,[concat_fmtty(fmtty1[0],fmtty2)]);case 8:return Block.__(8,[fmtty1[0],concat_fmtty(fmtty1[1],fmtty2)]);case 9:return Block.__(9,[fmtty1[0],fmtty1[1],concat_fmtty(fmtty1[2],fmtty2)]);case 10:return Block.__(10,[concat_fmtty(fmtty1[0],fmtty2)]);case 11:return Block.__(11,[concat_fmtty(fmtty1[0],fmtty2)]);case 12:return Block.__(12,[concat_fmtty(fmtty1[0],fmtty2)]);case 13:return Block.__(13,[concat_fmtty(fmtty1[0],fmtty2)]);case 14:return Block.__(14,[concat_fmtty(fmtty1[0],fmtty2)])}}}function concat_fmt(fmt1,fmt2){if(typeof fmt1==="number"){return fmt2}else{switch(fmt1.tag|0){case 0:return Block.__(0,[concat_fmt(fmt1[0],fmt2)]);case 1:return Block.__(1,[concat_fmt(fmt1[0],fmt2)]);case 2:return Block.__(2,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 3:return Block.__(3,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 4:return Block.__(4,[fmt1[0],fmt1[1],fmt1[2],concat_fmt(fmt1[3],fmt2)]);case 5:return Block.__(5,[fmt1[0],fmt1[1],fmt1[2],concat_fmt(fmt1[3],fmt2)]);case 6:return Block.__(6,[fmt1[0],fmt1[1],fmt1[2],concat_fmt(fmt1[3],fmt2)]);case 7:return Block.__(7,[fmt1[0],fmt1[1],fmt1[2],concat_fmt(fmt1[3],fmt2)]);case 8:return Block.__(8,[fmt1[0],fmt1[1],fmt1[2],concat_fmt(fmt1[3],fmt2)]);case 9:return Block.__(9,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 10:return Block.__(10,[concat_fmt(fmt1[0],fmt2)]);case 11:return Block.__(11,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 12:return Block.__(12,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 13:return Block.__(13,[fmt1[0],fmt1[1],concat_fmt(fmt1[2],fmt2)]);case 14:return Block.__(14,[fmt1[0],fmt1[1],concat_fmt(fmt1[2],fmt2)]);case 15:return Block.__(15,[concat_fmt(fmt1[0],fmt2)]);case 16:return Block.__(16,[concat_fmt(fmt1[0],fmt2)]);case 17:return Block.__(17,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 18:return Block.__(18,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 19:return Block.__(19,[concat_fmt(fmt1[0],fmt2)]);case 20:return Block.__(20,[fmt1[0],fmt1[1],concat_fmt(fmt1[2],fmt2)]);case 21:return Block.__(21,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 22:return Block.__(22,[concat_fmt(fmt1[0],fmt2)]);case 23:return Block.__(23,[fmt1[0],concat_fmt(fmt1[1],fmt2)]);case 24:return Block.__(24,[fmt1[0],fmt1[1],concat_fmt(fmt1[2],fmt2)])}}}exports.concat_fmtty=concat_fmtty;exports.erase_rel=erase_rel;exports.concat_fmt=concat_fmt},{"./block.js":2}],25:[function(require,module,exports){"use strict";var Obj=require("./obj.js");var Curry=require("./curry.js");var Caml_obj=require("./caml_obj.js");var Caml_exceptions=require("./caml_exceptions.js");var Undefined=Caml_exceptions.create("CamlinternalLazy.Undefined");function raise_undefined(param){throw Undefined}function force_lazy_block(blk){var closure=blk[0];blk[0]=raise_undefined;try{var result=Curry._1(closure,0);blk[0]=result;Caml_obj.caml_obj_set_tag(blk,Obj.forward_tag);return result}catch(e){blk[0]=function(param){throw e};throw e}}function force_val_lazy_block(blk){var closure=blk[0];blk[0]=raise_undefined;var result=Curry._1(closure,0);blk[0]=result;Caml_obj.caml_obj_set_tag(blk,Obj.forward_tag);return result}function force(lzv){var t=lzv.tag|0;if(t===Obj.forward_tag){return lzv[0]}else if(t!==Obj.lazy_tag){return lzv}else{return force_lazy_block(lzv)}}function force_val(lzv){var t=lzv.tag|0;if(t===Obj.forward_tag){return lzv[0]}else if(t!==Obj.lazy_tag){return lzv}else{return force_val_lazy_block(lzv)}}exports.Undefined=Undefined;exports.force_lazy_block=force_lazy_block;exports.force_val_lazy_block=force_val_lazy_block;exports.force=force;exports.force_val=force_val},{"./caml_exceptions.js":8,"./caml_obj.js":17,"./curry.js":27,"./obj.js":35}],26:[function(require,module,exports){"use strict";var Caml_bytes=require("./caml_bytes.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function chr(n){if(n<0||n>255){throw[Caml_builtin_exceptions.invalid_argument,"Char.chr"]}return n}function escaped(c){var exit=0;if(c>=40){if(c!==92){exit=c>=127?1:2}else{return"\\\\"}}else if(c>=32){if(c>=39){return"\\'"}else{exit=2}}else if(c>=14){exit=1}else{switch(c){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:exit=1;break;case 13:return"\\r"}}switch(exit){case 1:var s=[0,0,0,0];s[0]=92;s[1]=48+(c/100|0)|0;s[2]=48+(c/10|0)%10|0;s[3]=48+c%10|0;return Caml_bytes.bytes_to_string(s);case 2:var s$1=[0];s$1[0]=c;return Caml_bytes.bytes_to_string(s$1)}}function lowercase(c){if(c>=65&&c<=90||c>=192&&c<=214||c>=216&&c<=222){return c+32|0}else{return c}}function uppercase(c){if(c>=97&&c<=122||c>=224&&c<=246||c>=248&&c<=254){return c-32|0}else{return c}}function lowercase_ascii(c){if(c>=65&&c<=90){return c+32|0}else{return c}}function uppercase_ascii(c){if(c>=97&&c<=122){return c-32|0}else{return c}}function compare(c1,c2){return c1-c2|0}function equal(c1,c2){return(c1-c2|0)===0}exports.chr=chr;exports.escaped=escaped;exports.lowercase=lowercase;exports.uppercase=uppercase;exports.lowercase_ascii=lowercase_ascii;exports.uppercase_ascii=uppercase_ascii;exports.compare=compare;exports.equal=equal},{"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7}],27:[function(require,module,exports){"use strict";var Caml_array=require("./caml_array.js");function app(_f,_args){while(true){var args=_args;var f=_f;var init_arity=f.length;var arity=init_arity===0?1:init_arity;var len=args.length;var d=arity-len|0;if(d===0){return f.apply(null,args)}else if(d<0){_args=Caml_array.caml_array_sub(args,arity,-d|0);_f=f.apply(null,Caml_array.caml_array_sub(args,0,arity));continue}else{return function(f,args){return function(x){return app(f,args.concat([x]))}}(f,args)}}}function curry_1(o,a0,arity){switch(arity){case 1:return o(a0);case 2:return function(param){return o(a0,param)};case 3:return function(param,param$1){return o(a0,param,param$1)};case 4:return function(param,param$1,param$2){return o(a0,param,param$1,param$2)};case 5:return function(param,param$1,param$2,param$3){return o(a0,param,param$1,param$2,param$3)};case 6:return function(param,param$1,param$2,param$3,param$4){return o(a0,param,param$1,param$2,param$3,param$4)};case 7:return function(param,param$1,param$2,param$3,param$4,param$5){return o(a0,param,param$1,param$2,param$3,param$4,param$5)};default:return app(o,[a0])}}function _1(o,a0){var arity=o.length;if(arity===1){return o(a0)}else{return curry_1(o,a0,arity)}}function __1(o){var arity=o.length;if(arity===1){return o}else{return function(a0){return _1(o,a0)}}}function curry_2(o,a0,a1,arity){switch(arity){case 1:return app(o(a0),[a1]);case 2:return o(a0,a1);case 3:return function(param){return o(a0,a1,param)};case 4:return function(param,param$1){return o(a0,a1,param,param$1)};case 5:return function(param,param$1,param$2){return o(a0,a1,param,param$1,param$2)};case 6:return function(param,param$1,param$2,param$3){return o(a0,a1,param,param$1,param$2,param$3)};case 7:return function(param,param$1,param$2,param$3,param$4){return o(a0,a1,param,param$1,param$2,param$3,param$4)};default:return app(o,[a0,a1])}}function _2(o,a0,a1){var arity=o.length;if(arity===2){return o(a0,a1)}else{return curry_2(o,a0,a1,arity)}}function __2(o){var arity=o.length;if(arity===2){return o}else{return function(a0,a1){return _2(o,a0,a1)}}}function curry_3(o,a0,a1,a2,arity){switch(arity){case 1:return app(o(a0),[a1,a2]);case 2:return app(o(a0,a1),[a2]);case 3:return o(a0,a1,a2);case 4:return function(param){return o(a0,a1,a2,param)};case 5:return function(param,param$1){return o(a0,a1,a2,param,param$1)};case 6:return function(param,param$1,param$2){return o(a0,a1,a2,param,param$1,param$2)};case 7:return function(param,param$1,param$2,param$3){return o(a0,a1,a2,param,param$1,param$2,param$3)};default:return app(o,[a0,a1,a2])}}function _3(o,a0,a1,a2){var arity=o.length;if(arity===3){return o(a0,a1,a2)}else{return curry_3(o,a0,a1,a2,arity)}}function __3(o){var arity=o.length;if(arity===3){return o}else{return function(a0,a1,a2){return _3(o,a0,a1,a2)}}}function curry_4(o,a0,a1,a2,a3,arity){switch(arity){case 1:return app(o(a0),[a1,a2,a3]);case 2:return app(o(a0,a1),[a2,a3]);case 3:return app(o(a0,a1,a2),[a3]);case 4:return o(a0,a1,a2,a3);case 5:return function(param){return o(a0,a1,a2,a3,param)};case 6:return function(param,param$1){return o(a0,a1,a2,a3,param,param$1)};case 7:return function(param,param$1,param$2){return o(a0,a1,a2,a3,param,param$1,param$2)};default:return app(o,[a0,a1,a2,a3])}}function _4(o,a0,a1,a2,a3){var arity=o.length;if(arity===4){return o(a0,a1,a2,a3)}else{return curry_4(o,a0,a1,a2,a3,arity)}}function __4(o){var arity=o.length;if(arity===4){return o}else{return function(a0,a1,a2,a3){return _4(o,a0,a1,a2,a3)}}}function curry_5(o,a0,a1,a2,a3,a4,arity){switch(arity){case 1:return app(o(a0),[a1,a2,a3,a4]);case 2:return app(o(a0,a1),[a2,a3,a4]);case 3:return app(o(a0,a1,a2),[a3,a4]);case 4:return app(o(a0,a1,a2,a3),[a4]);case 5:return o(a0,a1,a2,a3,a4);case 6:return function(param){return o(a0,a1,a2,a3,a4,param)};case 7:return function(param,param$1){return o(a0,a1,a2,a3,a4,param,param$1)};default:return app(o,[a0,a1,a2,a3,a4])}}function _5(o,a0,a1,a2,a3,a4){var arity=o.length;if(arity===5){return o(a0,a1,a2,a3,a4)}else{return curry_5(o,a0,a1,a2,a3,a4,arity)}}function __5(o){var arity=o.length;if(arity===5){return o}else{return function(a0,a1,a2,a3,a4){return _5(o,a0,a1,a2,a3,a4)}}}function curry_6(o,a0,a1,a2,a3,a4,a5,arity){switch(arity){case 1:return app(o(a0),[a1,a2,a3,a4,a5]);case 2:return app(o(a0,a1),[a2,a3,a4,a5]);case 3:return app(o(a0,a1,a2),[a3,a4,a5]);case 4:return app(o(a0,a1,a2,a3),[a4,a5]);case 5:return app(o(a0,a1,a2,a3,a4),[a5]);case 6:
return o(a0,a1,a2,a3,a4,a5);case 7:return function(param){return o(a0,a1,a2,a3,a4,a5,param)};default:return app(o,[a0,a1,a2,a3,a4,a5])}}function _6(o,a0,a1,a2,a3,a4,a5){var arity=o.length;if(arity===6){return o(a0,a1,a2,a3,a4,a5)}else{return curry_6(o,a0,a1,a2,a3,a4,a5,arity)}}function __6(o){var arity=o.length;if(arity===6){return o}else{return function(a0,a1,a2,a3,a4,a5){return _6(o,a0,a1,a2,a3,a4,a5)}}}function curry_7(o,a0,a1,a2,a3,a4,a5,a6,arity){switch(arity){case 1:return app(o(a0),[a1,a2,a3,a4,a5,a6]);case 2:return app(o(a0,a1),[a2,a3,a4,a5,a6]);case 3:return app(o(a0,a1,a2),[a3,a4,a5,a6]);case 4:return app(o(a0,a1,a2,a3),[a4,a5,a6]);case 5:return app(o(a0,a1,a2,a3,a4),[a5,a6]);case 6:return app(o(a0,a1,a2,a3,a4,a5),[a6]);case 7:return o(a0,a1,a2,a3,a4,a5,a6);default:return app(o,[a0,a1,a2,a3,a4,a5,a6])}}function _7(o,a0,a1,a2,a3,a4,a5,a6){var arity=o.length;if(arity===7){return o(a0,a1,a2,a3,a4,a5,a6)}else{return curry_7(o,a0,a1,a2,a3,a4,a5,a6,arity)}}function __7(o){var arity=o.length;if(arity===7){return o}else{return function(a0,a1,a2,a3,a4,a5,a6){return _7(o,a0,a1,a2,a3,a4,a5,a6)}}}function curry_8(o,a0,a1,a2,a3,a4,a5,a6,a7,arity){switch(arity){case 1:return app(o(a0),[a1,a2,a3,a4,a5,a6,a7]);case 2:return app(o(a0,a1),[a2,a3,a4,a5,a6,a7]);case 3:return app(o(a0,a1,a2),[a3,a4,a5,a6,a7]);case 4:return app(o(a0,a1,a2,a3),[a4,a5,a6,a7]);case 5:return app(o(a0,a1,a2,a3,a4),[a5,a6,a7]);case 6:return app(o(a0,a1,a2,a3,a4,a5),[a6,a7]);case 7:return app(o(a0,a1,a2,a3,a4,a5,a6),[a7]);default:return app(o,[a0,a1,a2,a3,a4,a5,a6,a7])}}function _8(o,a0,a1,a2,a3,a4,a5,a6,a7){var arity=o.length;if(arity===8){return o(a0,a1,a2,a3,a4,a5,a6,a7)}else{return curry_8(o,a0,a1,a2,a3,a4,a5,a6,a7,arity)}}function __8(o){var arity=o.length;if(arity===8){return o}else{return function(a0,a1,a2,a3,a4,a5,a6,a7){return _8(o,a0,a1,a2,a3,a4,a5,a6,a7)}}}exports.app=app;exports.curry_1=curry_1;exports._1=_1;exports.__1=__1;exports.curry_2=curry_2;exports._2=_2;exports.__2=__2;exports.curry_3=curry_3;exports._3=_3;exports.__3=__3;exports.curry_4=curry_4;exports._4=_4;exports.__4=__4;exports.curry_5=curry_5;exports._5=_5;exports.__5=__5;exports.curry_6=curry_6;exports._6=_6;exports.__6=__6;exports.curry_7=curry_7;exports._7=_7;exports.__7=__7;exports.curry_8=curry_8;exports._8=_8;exports.__8=__8},{"./caml_array.js":5}],28:[function(require,module,exports){"use strict";var Char=require("./char.js");var $$String=require("./string.js");var Caml_md5=require("./caml_md5.js");var Caml_bytes=require("./caml_bytes.js");var Pervasives=require("./pervasives.js");var Caml_string=require("./caml_string.js");var Caml_external_polyfill=require("./caml_external_polyfill.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function string(str){return Caml_md5.caml_md5_string(str,0,str.length)}function bytes(b){return string(Caml_bytes.bytes_to_string(b))}function substring(str,ofs,len){if(ofs<0||len<0||ofs>(str.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Digest.substring"]}return Caml_md5.caml_md5_string(str,ofs,len)}function subbytes(b,ofs,len){return substring(Caml_bytes.bytes_to_string(b),ofs,len)}function file(filename){var ic=Pervasives.open_in_bin(filename);var d;try{d=Caml_external_polyfill.resolve("caml_md5_chan")(ic,-1)}catch(e){Caml_external_polyfill.resolve("caml_ml_close_channel")(ic);throw e}Caml_external_polyfill.resolve("caml_ml_close_channel")(ic);return d}var output=Pervasives.output_string;function input(chan){return Pervasives.really_input_string(chan,16)}function char_hex(n){return n+(n<10?48:87)|0}function to_hex(d){if(d.length!==16){throw[Caml_builtin_exceptions.invalid_argument,"Digest.to_hex"]}var result=Caml_bytes.caml_create_bytes(32);for(var i=0;i<=15;++i){var x=Caml_string.get(d,i);result[i<<1]=char_hex(x>>>4);result[(i<<1)+1|0]=char_hex(x&15)}return Caml_bytes.bytes_to_string(result)}function from_hex(s){if(s.length!==32){throw[Caml_builtin_exceptions.invalid_argument,"Digest.from_hex"]}var digit=function(c){if(c>=65){if(c>=97){if(c>=103){throw[Caml_builtin_exceptions.invalid_argument,"Digest.from_hex"]}return(c-97|0)+10|0}else{if(c>=71){throw[Caml_builtin_exceptions.invalid_argument,"Digest.from_hex"]}return(c-65|0)+10|0}}else{if(c>57||c<48){throw[Caml_builtin_exceptions.invalid_argument,"Digest.from_hex"]}return c-48|0}};var $$byte=function(i){return(digit(Caml_string.get(s,i))<<4)+digit(Caml_string.get(s,i+1|0))|0};var result=Caml_bytes.caml_create_bytes(16);for(var i=0;i<=15;++i){result[i]=Char.chr($$byte(i<<1))}return Caml_bytes.bytes_to_string(result)}var compare=$$String.compare;var equal=$$String.equal;exports.compare=compare;exports.equal=equal;exports.string=string;exports.bytes=bytes;exports.substring=substring;exports.subbytes=subbytes;exports.file=file;exports.output=output;exports.input=input;exports.to_hex=to_hex;exports.from_hex=from_hex},{"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_external_polyfill.js":9,"./caml_md5.js":16,"./caml_string.js":20,"./char.js":26,"./pervasives.js":36,"./string.js":39}],29:[function(require,module,exports){"use strict";var Caml_format=require("./caml_format.js");var Caml_primitive=require("./caml_primitive.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function succ(n){return n+1|0}function pred(n){return n-1|0}function abs(n){if(n>=0){return n}else{return-n|0}}function lognot(n){return n^-1}function to_string(n){return Caml_format.caml_int32_format("%d",n)}function of_string_opt(s){try{return Caml_format.caml_int32_of_string(s)}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return}else{throw exn}}}var compare=Caml_primitive.caml_int32_compare;function equal(x,y){return x===y}var zero=0;var one=1;var minus_one=-1;var max_int=2147483647;var min_int=-2147483648;exports.zero=zero;exports.one=one;exports.minus_one=minus_one;exports.succ=succ;exports.pred=pred;exports.abs=abs;exports.max_int=max_int;exports.min_int=min_int;exports.lognot=lognot;exports.of_string_opt=of_string_opt;exports.to_string=to_string;exports.compare=compare;exports.equal=equal},{"./caml_builtin_exceptions.js":6,"./caml_format.js":10,"./caml_js_exceptions.js":14,"./caml_primitive.js":19}],30:[function(require,module,exports){"use strict";var Caml_int64=require("./caml_int64.js");var Caml_format=require("./caml_format.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function succ(n){return Caml_int64.add(n,{hi:0,lo:1})}function pred(n){return Caml_int64.sub(n,{hi:0,lo:1})}function abs(n){if(Caml_int64.ge(n,{hi:0,lo:0})){return n}else{return Caml_int64.neg(n)}}function lognot(n){return Caml_int64.xor(n,{hi:-1,lo:4294967295})}function to_string(n){return Caml_format.caml_int64_format("%d",n)}function of_string_opt(s){try{return Caml_format.caml_int64_of_string(s)}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return}else{throw exn}}}var compare=Caml_int64.compare;function equal(x,y){return Caml_int64.compare(x,y)===0}var zero={hi:0,lo:0};var one={hi:0,lo:1};var minus_one={hi:-1,lo:4294967295};var max_int={hi:2147483647,lo:4294967295};var min_int={hi:-2147483648,lo:0};exports.zero=zero;exports.one=one;exports.minus_one=minus_one;exports.succ=succ;exports.pred=pred;exports.abs=abs;exports.max_int=max_int;exports.min_int=min_int;exports.lognot=lognot;exports.of_string_opt=of_string_opt;exports.to_string=to_string;exports.compare=compare;exports.equal=equal},{"./caml_builtin_exceptions.js":6,"./caml_format.js":10,"./caml_int64.js":12,"./caml_js_exceptions.js":14}],31:[function(require,module,exports){"use strict";var Bytes=require("./bytes.js");var Curry=require("./curry.js");var Caml_array=require("./caml_array.js");var Caml_bytes=require("./caml_bytes.js");var Caml_lexer=require("./caml_lexer.js");var Pervasives=require("./pervasives.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function engine(tbl,state,buf){var result=Caml_lexer.caml_lex_engine(tbl,state,buf);if(result>=0){buf.lex_start_p=buf.lex_curr_p;var init=buf.lex_curr_p;buf.lex_curr_p={pos_fname:init.pos_fname,pos_lnum:init.pos_lnum,pos_bol:init.pos_bol,pos_cnum:buf.lex_abs_pos+buf.lex_curr_pos|0}}return result}function new_engine(tbl,state,buf){var result=Caml_lexer.caml_new_lex_engine(tbl,state,buf);if(result>=0){buf.lex_start_p=buf.lex_curr_p;var init=buf.lex_curr_p;buf.lex_curr_p={pos_fname:init.pos_fname,pos_lnum:init.pos_lnum,pos_bol:init.pos_bol,pos_cnum:buf.lex_abs_pos+buf.lex_curr_pos|0}}return result}var zero_pos={pos_fname:"",pos_lnum:1,pos_bol:0,pos_cnum:0};function from_function(f){var partial_arg=Caml_bytes.caml_create_bytes(512);return{refill_buff:function(param){var read_fun=f;var aux_buffer=partial_arg;var lexbuf=param;var read=Curry._2(read_fun,aux_buffer,aux_buffer.length);var n=read>0?read:(lexbuf.lex_eof_reached=true,0);if((lexbuf.lex_buffer_len+n|0)>lexbuf.lex_buffer.length){if(((lexbuf.lex_buffer_len-lexbuf.lex_start_pos|0)+n|0)<=lexbuf.lex_buffer.length){Bytes.blit(lexbuf.lex_buffer,lexbuf.lex_start_pos,lexbuf.lex_buffer,0,lexbuf.lex_buffer_len-lexbuf.lex_start_pos|0)}else{var newlen=lexbuf.lex_buffer.length<<1;if(((lexbuf.lex_buffer_len-lexbuf.lex_start_pos|0)+n|0)>newlen){throw[Caml_builtin_exceptions.failure,"Lexing.lex_refill: cannot grow buffer"]}var newbuf=Caml_bytes.caml_create_bytes(newlen);Bytes.blit(lexbuf.lex_buffer,lexbuf.lex_start_pos,newbuf,0,lexbuf.lex_buffer_len-lexbuf.lex_start_pos|0);lexbuf.lex_buffer=newbuf}var s=lexbuf.lex_start_pos;lexbuf.lex_abs_pos=lexbuf.lex_abs_pos+s|0;lexbuf.lex_curr_pos=lexbuf.lex_curr_pos-s|0;lexbuf.lex_start_pos=0;lexbuf.lex_last_pos=lexbuf.lex_last_pos-s|0;lexbuf.lex_buffer_len=lexbuf.lex_buffer_len-s|0;var t=lexbuf.lex_mem;for(var i=0,i_finish=t.length-1|0;i<=i_finish;++i){var v=Caml_array.caml_array_get(t,i);if(v>=0){Caml_array.caml_array_set(t,i,v-s|0)}}}Bytes.blit(aux_buffer,0,lexbuf.lex_buffer,lexbuf.lex_buffer_len,n);lexbuf.lex_buffer_len=lexbuf.lex_buffer_len+n|0;return 0},lex_buffer:Caml_bytes.caml_create_bytes(1024),lex_buffer_len:0,lex_abs_pos:0,lex_start_pos:0,lex_curr_pos:0,lex_last_pos:0,lex_last_action:0,lex_eof_reached:false,lex_mem:[],lex_start_p:zero_pos,lex_curr_p:zero_pos}}function from_channel(ic){return from_function(function(buf,n){return Pervasives.input(ic,buf,0,n)})}function from_string(s){return{refill_buff:function(lexbuf){lexbuf.lex_eof_reached=true;return 0},lex_buffer:Bytes.of_string(s),lex_buffer_len:s.length,lex_abs_pos:0,lex_start_pos:0,lex_curr_pos:0,lex_last_pos:0,lex_last_action:0,lex_eof_reached:true,lex_mem:[],lex_start_p:zero_pos,lex_curr_p:zero_pos}}function lexeme(lexbuf){var len=lexbuf.lex_curr_pos-lexbuf.lex_start_pos|0;return Bytes.sub_string(lexbuf.lex_buffer,lexbuf.lex_start_pos,len)}function sub_lexeme(lexbuf,i1,i2){var len=i2-i1|0;return Bytes.sub_string(lexbuf.lex_buffer,i1,len)}function sub_lexeme_opt(lexbuf,i1,i2){if(i1>=0){var len=i2-i1|0;return Bytes.sub_string(lexbuf.lex_buffer,i1,len)}}function sub_lexeme_char(lexbuf,i){return Caml_bytes.get(lexbuf.lex_buffer,i)}function sub_lexeme_char_opt(lexbuf,i){if(i>=0){return Caml_bytes.get(lexbuf.lex_buffer,i)}}function lexeme_char(lexbuf,i){return Caml_bytes.get(lexbuf.lex_buffer,lexbuf.lex_start_pos+i|0)}function lexeme_start(lexbuf){return lexbuf.lex_start_p.pos_cnum}function lexeme_end(lexbuf){return lexbuf.lex_curr_p.pos_cnum}function lexeme_start_p(lexbuf){return lexbuf.lex_start_p}function lexeme_end_p(lexbuf){return lexbuf.lex_curr_p}function new_line(lexbuf){var lcp=lexbuf.lex_curr_p;lexbuf.lex_curr_p={pos_fname:lcp.pos_fname,pos_lnum:lcp.pos_lnum+1|0,pos_bol:lcp.pos_cnum,pos_cnum:lcp.pos_cnum};return 0}function flush_input(lb){lb.lex_curr_pos=0;lb.lex_abs_pos=0;var init=lb.lex_curr_p;lb.lex_curr_p={pos_fname:init.pos_fname,pos_lnum:init.pos_lnum,pos_bol:init.pos_bol,pos_cnum:0};lb.lex_buffer_len=0;return 0}var dummy_pos={pos_fname:"",pos_lnum:0,pos_bol:0,pos_cnum:-1};exports.dummy_pos=dummy_pos;exports.from_channel=from_channel;exports.from_string=from_string;exports.from_function=from_function;exports.lexeme=lexeme;exports.lexeme_char=lexeme_char;exports.lexeme_start=lexeme_start;exports.lexeme_end=lexeme_end;exports.lexeme_start_p=lexeme_start_p;exports.lexeme_end_p=lexeme_end_p;exports.new_line=new_line;exports.flush_input=flush_input;exports.sub_lexeme=sub_lexeme;exports.sub_lexeme_opt=sub_lexeme_opt;exports.sub_lexeme_char=sub_lexeme_char;exports.sub_lexeme_char_opt=sub_lexeme_char_opt;exports.engine=engine;exports.new_engine=new_engine},{"./bytes.js":4,"./caml_array.js":5,"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_lexer.js":15,"./curry.js":27,"./pervasives.js":36}],32:[function(require,module,exports){"use strict";var Curry=require("./curry.js");var Caml_obj=require("./caml_obj.js");var Pervasives=require("./pervasives.js");var Caml_option=require("./caml_option.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function length(l){var _len=0;var _param=l;while(true){var param=_param;var len=_len;if(param){_param=param[1];_len=len+1|0;continue}else{return len}}}function cons(a,l){return[a,l]}function hd(param){if(param){return param[0]}else{throw[Caml_builtin_exceptions.failure,"hd"]}}function tl(param){if(param){return param[1]}else{throw[Caml_builtin_exceptions.failure,"tl"]}}function nth(l,n){if(n<0){throw[Caml_builtin_exceptions.invalid_argument,"List.nth"]}var _l=l;var _n=n;while(true){var n$1=_n;var l$1=_l;if(l$1){if(n$1===0){return l$1[0]}else{_n=n$1-1|0;_l=l$1[1];continue}}else{throw[Caml_builtin_exceptions.failure,"nth"]}}}function nth_opt(l,n){if(n<0){throw[Caml_builtin_exceptions.invalid_argument,"List.nth"]}var _l=l;var _n=n;while(true){var n$1=_n;var l$1=_l;if(l$1){if(n$1===0){return Caml_option.some(l$1[0])}else{_n=n$1-1|0;_l=l$1[1];continue}}else{return}}}function rev_append(_l1,_l2){while(true){var l2=_l2;var l1=_l1;if(l1){_l2=[l1[0],l2];_l1=l1[1];continue}else{return l2}}}function rev(l){return rev_append(l,0)}function init_tailrec_aux(_acc,_i,n,f){while(true){var i=_i;var acc=_acc;if(i>=n){return acc}else{_i=i+1|0;_acc=[Curry._1(f,i),acc];continue}}}function init_aux(i,n,f){if(i>=n){return 0}else{var r=Curry._1(f,i);return[r,init_aux(i+1|0,n,f)]}}function init(len,f){if(len<0){throw[Caml_builtin_exceptions.invalid_argument,"List.init"]}if(len>1e4){return rev_append(init_tailrec_aux(0,0,len,f),0)}else{return init_aux(0,len,f)}}function flatten(param){if(param){return Pervasives.$at(param[0],flatten(param[1]))}else{return 0}}function map(f,param){if(param){var r=Curry._1(f,param[0]);return[r,map(f,param[1])]}else{return 0}}function mapi(i,f,param){if(param){var r=Curry._2(f,i,param[0]);return[r,mapi(i+1|0,f,param[1])]}else{return 0}}function mapi$1(f,l){return mapi(0,f,l)}function rev_map(f,l){var _accu=0;var _param=l;while(true){var param=_param;var accu=_accu;if(param){_param=param[1];_accu=[Curry._1(f,param[0]),accu];continue}else{return accu}}}function iter(f,_param){while(true){var param=_param;if(param){Curry._1(f,param[0]);_param=param[1];continue}else{return 0}}}function iteri(f,l){var _i=0;var f$1=f;var _param=l;while(true){var param=_param;var i=_i;if(param){Curry._2(f$1,i,param[0]);_param=param[1];_i=i+1|0;continue}else{return 0}}}function fold_left(f,_accu,_l){while(true){var l=_l;var accu=_accu;if(l){_l=l[1];_accu=Curry._2(f,accu,l[0]);continue}else{return accu}}}function fold_right(f,l,accu){if(l){return Curry._2(f,l[0],fold_right(f,l[1],accu))}else{return accu}}function map2(f,l1,l2){if(l1){if(l2){var r=Curry._2(f,l1[0],l2[0]);return[r,map2(f,l1[1],l2[1])]}else{throw[Caml_builtin_exceptions.invalid_argument,"List.map2"]}}else if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.map2"]}else{return 0}}function rev_map2(f,l1,l2){var _accu=0;var _l1=l1;var _l2=l2;while(true){var l2$1=_l2;var l1$1=_l1;var accu=_accu;if(l1$1){if(l2$1){_l2=l2$1[1];_l1=l1$1[1];_accu=[Curry._2(f,l1$1[0],l2$1[0]),accu];continue}else{throw[Caml_builtin_exceptions.invalid_argument,"List.rev_map2"]}}else{if(l2$1){throw[Caml_builtin_exceptions.invalid_argument,"List.rev_map2"]}return accu}}}function iter2(f,_l1,_l2){while(true){var l2=_l2;var l1=_l1;if(l1){if(l2){Curry._2(f,l1[0],l2[0]);_l2=l2[1];_l1=l1[1];continue}else{throw[Caml_builtin_exceptions.invalid_argument,"List.iter2"]}}else if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.iter2"]}else{return 0}}}function fold_left2(f,_accu,_l1,_l2){while(true){var l2=_l2;var l1=_l1;var accu=_accu;if(l1){if(l2){_l2=l2[1];_l1=l1[1];_accu=Curry._3(f,accu,l1[0],l2[0]);continue}else{throw[Caml_builtin_exceptions.invalid_argument,"List.fold_left2"]}}else{if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.fold_left2"]}return accu}}}function fold_right2(f,l1,l2,accu){if(l1){if(l2){return Curry._3(f,l1[0],l2[0],fold_right2(f,l1[1],l2[1],accu))}else{throw[Caml_builtin_exceptions.invalid_argument,"List.fold_right2"]}}else{if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.fold_right2"]}return accu}}function for_all(p,_param){while(true){var param=_param;if(param){if(Curry._1(p,param[0])){_param=param[1];continue}else{return false}}else{return true}}}function exists(p,_param){while(true){var param=_param;if(param){if(Curry._1(p,param[0])){return true}else{_param=param[1];continue}}else{return false}}}function for_all2(p,_l1,_l2){while(true){var l2=_l2;var l1=_l1;if(l1){if(l2){if(Curry._2(p,l1[0],l2[0])){_l2=l2[1];_l1=l1[1];continue}else{return false}}else{throw[Caml_builtin_exceptions.invalid_argument,"List.for_all2"]}}else if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.for_all2"]}else{return true}}}function exists2(p,_l1,_l2){while(true){var l2=_l2;var l1=_l1;if(l1){if(l2){if(Curry._2(p,l1[0],l2[0])){return true}else{_l2=l2[1];_l1=l1[1];continue}}else{throw[Caml_builtin_exceptions.invalid_argument,"List.exists2"]}}else if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.exists2"]}else{return false}}}function mem(x,_param){while(true){var param=_param;if(param){if(Caml_obj.caml_equal(param[0],x)){return true}else{_param=param[1];continue}}else{return false}}}function memq(x,_param){while(true){var param=_param;if(param){if(param[0]===x){return true}else{_param=param[1];continue}}else{return false}}}function assoc(x,_param){while(true){var param=_param;if(param){var match=param[0];if(Caml_obj.caml_equal(match[0],x)){return match[1]}else{_param=param[1];continue}}else{throw Caml_builtin_exceptions.not_found}}}function assoc_opt(x,_param){while(true){var param=_param;if(param){var match=param[0];if(Caml_obj.caml_equal(match[0],x)){return Caml_option.some(match[1])}else{_param=param[1];continue}}else{return}}}function assq(x,_param){while(true){var param=_param;if(param){var match=param[0];if(match[0]===x){return match[1]}else{_param=param[1];continue}}else{throw Caml_builtin_exceptions.not_found}}}function assq_opt(x,_param){while(true){var param=_param;if(param){var match=param[0];if(match[0]===x){return Caml_option.some(match[1])}else{_param=param[1];continue}}else{return}}}function mem_assoc(x,_param){while(true){var param=_param;if(param){if(Caml_obj.caml_equal(param[0][0],x)){return true}else{_param=param[1];continue}}else{return false}}}function mem_assq(x,_param){while(true){var param=_param;if(param){if(param[0][0]===x){return true}else{_param=param[1];continue}}else{return false}}}function remove_assoc(x,param){if(param){var l=param[1];var pair=param[0];if(Caml_obj.caml_equal(pair[0],x)){return l}else{return[pair,remove_assoc(x,l)]}}else{return 0}}function remove_assq(x,param){if(param){var l=param[1];var pair=param[0];if(pair[0]===x){return l}else{return[pair,remove_assq(x,l)]}}else{return 0}}function find(p,_param){while(true){var param=_param;if(param){var x=param[0];if(Curry._1(p,x)){return x}else{_param=param[1];continue}}else{throw Caml_builtin_exceptions.not_found}}}function find_opt(p,_param){while(true){var param=_param;if(param){var x=param[0];if(Curry._1(p,x)){return Caml_option.some(x)}else{_param=param[1];continue}}else{return}}}function find_all(p){return function(param){var _accu=0;var _param=param;while(true){var param$1=_param;var accu=_accu;if(param$1){var l=param$1[1];var x=param$1[0];if(Curry._1(p,x)){_param=l;_accu=[x,accu];continue}else{_param=l;continue}}else{return rev_append(accu,0)}}}}function partition(p,l){var _yes=0;var _no=0;var _param=l;while(true){var param=_param;var no=_no;var yes=_yes;if(param){var l$1=param[1];var x=param[0];if(Curry._1(p,x)){_param=l$1;_yes=[x,yes];continue}else{_param=l$1;_no=[x,no];continue}}else{return[rev_append(yes,0),rev_append(no,0)]}}}function split(param){if(param){var match=param[0];var match$1=split(param[1]);return[[match[0],match$1[0]],[match[1],match$1[1]]]}else{return[0,0]}}function combine(l1,l2){if(l1){if(l2){return[[l1[0],l2[0]],combine(l1[1],l2[1])]}else{throw[Caml_builtin_exceptions.invalid_argument,"List.combine"]}}else if(l2){throw[Caml_builtin_exceptions.invalid_argument,"List.combine"]}else{return 0}}function merge(cmp,l1,l2){if(l1){if(l2){var h2=l2[0];var h1=l1[0];if(Curry._2(cmp,h1,h2)<=0){return[h1,merge(cmp,l1[1],l2)]}else{return[h2,merge(cmp,l1,l2[1])]}}else{return l1}}else{return l2}}function chop(_k,_l){while(true){var l=_l;var k=_k;if(k===0){return l}else if(l){_l=l[1];_k=k-1|0;continue}else{throw[Caml_builtin_exceptions.assert_failure,["list.ml",262,11]]}}}function stable_sort(cmp,l){var sort=function(n,l){if(n!==2){if(n===3&&l){var match=l[1];if(match){var match$1=match[1];if(match$1){var x3=match$1[0];var x2=match[0];var x1=l[0];if(Curry._2(cmp,x1,x2)<=0){if(Curry._2(cmp,x2,x3)<=0){return[x1,[x2,[x3,0]]]}else if(Curry._2(cmp,x1,x3)<=0){return[x1,[x3,[x2,0]]]}else{return[x3,[x1,[x2,0]]]}}else if(Curry._2(cmp,x1,x3)<=0){return[x2,[x1,[x3,0]]]}else if(Curry._2(cmp,x2,x3)<=0){return[x2,[x3,[x1,0]]]}else{return[x3,[x2,[x1,0]]]}}}}}else if(l){var match$2=l[1];if(match$2){var x2$1=match$2[0];var x1$1=l[0];if(Curry._2(cmp,x1$1,x2$1)<=0){return[x1$1,[x2$1,0]]}else{return[x2$1,[x1$1,0]]}}}var n1=n>>1;var n2=n-n1|0;var l2=chop(n1,l);var s1=rev_sort(n1,l);var s2=rev_sort(n2,l2);var _l1=s1;var _l2=s2;var _accu=0;while(true){var accu=_accu;var l2$1=_l2;var l1=_l1;if(l1){if(l2$1){var h2=l2$1[0];var h1=l1[0];if(Curry._2(cmp,h1,h2)>0){_accu=[h1,accu];_l1=l1[1];continue}else{_accu=[h2,accu];_l2=l2$1[1];continue}}else{return rev_append(l1,accu)}}else{return rev_append(l2$1,accu)}}};var rev_sort=function(n,l){if(n!==2){if(n===3&&l){var match=l[1];if(match){var match$1=match[1];if(match$1){var x3=match$1[0];var x2=match[0];var x1=l[0];if(Curry._2(cmp,x1,x2)>0){if(Curry._2(cmp,x2,x3)>0){return[x1,[x2,[x3,0]]]}else if(Curry._2(cmp,x1,x3)>0){return[x1,[x3,[x2,0]]]}else{return[x3,[x1,[x2,0]]]}}else if(Curry._2(cmp,x1,x3)>0){return[x2,[x1,[x3,0]]]}else if(Curry._2(cmp,x2,x3)>0){return[x2,[x3,[x1,0]]]}else{return[x3,[x2,[x1,0]]]}}}}}else if(l){var match$2=l[1];if(match$2){var x2$1=match$2[0];var x1$1=l[0];if(Curry._2(cmp,x1$1,x2$1)>0){return[x1$1,[x2$1,0]]}else{return[x2$1,[x1$1,0]]}}}var n1=n>>1;var n2=n-n1|0;var l2=chop(n1,l);var s1=sort(n1,l);var s2=sort(n2,l2);var _l1=s1;var _l2=s2;var _accu=0;while(true){var accu=_accu;var l2$1=_l2;var l1=_l1;if(l1){if(l2$1){var h2=l2$1[0];var h1=l1[0];if(Curry._2(cmp,h1,h2)<=0){_accu=[h1,accu];_l1=l1[1];continue}else{_accu=[h2,accu];_l2=l2$1[1];continue}}else{return rev_append(l1,accu)}}else{return rev_append(l2$1,accu)}}};var len=length(l);if(len<2){return l}else{return sort(len,l)}}function sort_uniq(cmp,l){var sort=function(n,l){if(n!==2){if(n===3&&l){var match=l[1];if(match){var match$1=match[1];if(match$1){var x3=match$1[0];var x2=match[0];var x1=l[0];var c=Curry._2(cmp,x1,x2);if(c===0){var c$1=Curry._2(cmp,x2,x3);if(c$1===0){return[x2,0]}else if(c$1<0){return[x2,[x3,0]]}else{return[x3,[x2,0]]}}else if(c<0){var c$2=Curry._2(cmp,x2,x3);if(c$2===0){return[x1,[x2,0]]}else if(c$2<0){return[x1,[x2,[x3,0]]]}else{var c$3=Curry._2(cmp,x1,x3);if(c$3===0){return[x1,[x2,0]]}else if(c$3<0){return[x1,[x3,[x2,0]]]}else{return[x3,[x1,[x2,0]]]}}}else{var c$4=Curry._2(cmp,x1,x3);if(c$4===0){return[x2,[x1,0]]}else if(c$4<0){return[x2,[x1,[x3,0]]]}else{var c$5=Curry._2(cmp,x2,x3);if(c$5===0){return[x2,[x1,0]]}else if(c$5<0){return[x2,[x3,[x1,0]]]}else{return[x3,[x2,[x1,0]]]}}}}}}}else if(l){var match$2=l[1];if(match$2){var x2$1=match$2[0];var x1$1=l[0];var c$6=Curry._2(cmp,x1$1,x2$1);if(c$6===0){return[x1$1,0]}else if(c$6<0){return[x1$1,[x2$1,0]]}else{return[x2$1,[x1$1,0]]}}}var n1=n>>1;var n2=n-n1|0;var l2=chop(n1,l);var s1=rev_sort(n1,l);var s2=rev_sort(n2,l2);var _l1=s1;var _l2=s2;var _accu=0;while(true){var accu=_accu;var l2$1=_l2;var l1=_l1;if(l1){if(l2$1){var t2=l2$1[1];var h2=l2$1[0];var t1=l1[1];var h1=l1[0];var c$7=Curry._2(cmp,h1,h2);if(c$7===0){_accu=[h1,accu];_l2=t2;_l1=t1;continue}else if(c$7>0){_accu=[h1,accu];_l1=t1;continue}else{_accu=[h2,accu];_l2=t2;continue}}else{return rev_append(l1,accu)}}else{return rev_append(l2$1,accu)}}};var rev_sort=function(n,l){if(n!==2){if(n===3&&l){var match=l[1];if(match){var match$1=match[1];if(match$1){var x3=match$1[0];var x2=match[0];var x1=l[0];var c=Curry._2(cmp,x1,x2);if(c===0){var c$1=Curry._2(cmp,x2,x3);if(c$1===0){return[x2,0]}else if(c$1>0){return[x2,[x3,0]]}else{return[x3,[x2,0]]}}else if(c>0){var c$2=Curry._2(cmp,x2,x3);if(c$2===0){return[x1,[x2,0]]}else if(c$2>0){return[x1,[x2,[x3,0]]]}else{var c$3=Curry._2(cmp,x1,x3);if(c$3===0){return[x1,[x2,0]]}else if(c$3>0){return[x1,[x3,[x2,0]]]}else{return[x3,[x1,[x2,0]]]}}}else{var c$4=Curry._2(cmp,x1,x3);if(c$4===0){return[x2,[x1,0]]}else if(c$4>0){return[x2,[x1,[x3,0]]]}else{var c$5=Curry._2(cmp,x2,x3);if(c$5===0){return[x2,[x1,0]]}else if(c$5>0){return[x2,[x3,[x1,0]]]}else{return[x3,[x2,[x1,0]]]}}}}}}}else if(l){var match$2=l[1];if(match$2){var x2$1=match$2[0];var x1$1=l[0];var c$6=Curry._2(cmp,x1$1,x2$1);if(c$6===0){return[x1$1,0]}else if(c$6>0){return[x1$1,[x2$1,0]]}else{return[x2$1,[x1$1,0]]}}}var n1=n>>1;var n2=n-n1|0;var l2=chop(n1,l);var s1=sort(n1,l);var s2=sort(n2,l2);var _l1=s1;var _l2=s2;var _accu=0;while(true){var accu=_accu;var l2$1=_l2;var l1=_l1;if(l1){if(l2$1){var t2=l2$1[1];var h2=l2$1[0];var t1=l1[1];var h1=l1[0];var c$7=Curry._2(cmp,h1,h2);if(c$7===0){_accu=[h1,accu];_l2=t2;_l1=t1;continue}else if(c$7<0){_accu=[h1,accu];_l1=t1;continue}else{_accu=[h2,accu];_l2=t2;continue}}else{return rev_append(l1,accu)}}else{return rev_append(l2$1,accu)}}};var len=length(l);if(len<2){return l}else{return sort(len,l)}}function compare_lengths(_l1,_l2){while(true){var l2=_l2;var l1=_l1;if(l1){if(l2){_l2=l2[1];_l1=l1[1];continue}else{return 1}}else if(l2){return-1}else{return 0}}}function compare_length_with(_l,_n){while(true){var n=_n;var l=_l;if(l){if(n<=0){return 1}else{_n=n-1|0;_l=l[1];continue}}else if(n===0){return 0}else if(n>0){return-1}else{return 1}}}var append=Pervasives.$at;var concat=flatten;var filter=find_all;var sort=stable_sort;var fast_sort=stable_sort;exports.length=length;exports.compare_lengths=compare_lengths;exports.compare_length_with=compare_length_with;exports.cons=cons;exports.hd=hd;exports.tl=tl;exports.nth=nth;exports.nth_opt=nth_opt;exports.rev=rev;exports.init=init;exports.append=append;exports.rev_append=rev_append;exports.concat=concat;exports.flatten=flatten;exports.iter=iter;exports.iteri=iteri;exports.map=map;exports.mapi=mapi$1;exports.rev_map=rev_map;exports.fold_left=fold_left;exports.fold_right=fold_right;exports.iter2=iter2;exports.map2=map2;exports.rev_map2=rev_map2;exports.fold_left2=fold_left2;exports.fold_right2=fold_right2;exports.for_all=for_all;exports.exists=exists;exports.for_all2=for_all2;exports.exists2=exists2;exports.mem=mem;exports.memq=memq;exports.find=find;exports.find_opt=find_opt;exports.filter=filter;exports.find_all=find_all;exports.partition=partition;exports.assoc=assoc;exports.assoc_opt=assoc_opt;exports.assq=assq;exports.assq_opt=assq_opt;exports.mem_assoc=mem_assoc;exports.mem_assq=mem_assq;exports.remove_assoc=remove_assoc;exports.remove_assq=remove_assq;exports.split=split;exports.combine=combine;exports.sort=sort;exports.stable_sort=stable_sort;exports.fast_sort=fast_sort;exports.sort_uniq=sort_uniq;exports.merge=merge},{"./caml_builtin_exceptions.js":6,"./caml_obj.js":17,"./caml_option.js":18,"./curry.js":27,"./pervasives.js":36}],33:[function(require,module,exports){"use strict";var Caml_bytes=require("./caml_bytes.js");var Caml_external_polyfill=require("./caml_external_polyfill.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function to_buffer(buff,ofs,len,v,flags){if(ofs<0||len<0||ofs>(buff.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"Marshal.to_buffer: substring out of bounds"]}return Caml_external_polyfill.resolve("caml_output_value_to_buffer")(buff,ofs,len,v,flags)}function data_size(buff,ofs){if(ofs<0||ofs>(buff.length-20|0)){throw[Caml_builtin_exceptions.invalid_argument,"Marshal.data_size"]}return Caml_external_polyfill.resolve("caml_marshal_data_size")(buff,ofs)}function total_size(buff,ofs){return 20+data_size(buff,ofs)|0}function from_bytes(buff,ofs){if(ofs<0||ofs>(buff.length-20|0)){throw[Caml_builtin_exceptions.invalid_argument,"Marshal.from_bytes"]}var len=Caml_external_polyfill.resolve("caml_marshal_data_size")(buff,ofs);if(ofs>(buff.length-(20+len|0)|0)){throw[Caml_builtin_exceptions.invalid_argument,"Marshal.from_bytes"]}return Caml_external_polyfill.resolve("caml_input_value_from_string")(buff,ofs)}function from_string(buff,ofs){return from_bytes(Caml_bytes.bytes_of_string(buff),ofs)}function to_channel(prim,prim$1,prim$2){return Caml_external_polyfill.resolve("caml_output_value")(prim,prim$1,prim$2)}function from_channel(prim){return Caml_external_polyfill.resolve("caml_input_value")(prim)}var header_size=20;exports.to_channel=to_channel;exports.to_buffer=to_buffer;exports.from_channel=from_channel;exports.from_bytes=from_bytes;exports.from_string=from_string;exports.header_size=header_size;exports.data_size=data_size;exports.total_size=total_size},{"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_external_polyfill.js":9}],34:[function(require,module,exports){"use strict";var Caml_format=require("./caml_format.js");var Caml_primitive=require("./caml_primitive.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function succ(n){return n+1}function pred(n){return n-1}function abs(n){if(n>=0){return n}else{return-n}}function lognot(n){return n^-1}function to_string(n){return Caml_format.caml_nativeint_format("%d",n)}function of_string_opt(s){try{return Caml_format.caml_nativeint_of_string(s)}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return}else{throw exn}}}var compare=Caml_primitive.caml_nativeint_compare;function equal(x,y){return Caml_primitive.caml_nativeint_compare(x,y)===0}var zero=0;var one=1;var minus_one=-1;var size=54;var max_int=9007199254740991;var min_int=-9007199254740991;exports.zero=zero;exports.one=one;exports.minus_one=minus_one;exports.succ=succ;exports.pred=pred;exports.abs=abs;exports.size=size;exports.max_int=max_int;exports.min_int=min_int;exports.lognot=lognot;exports.of_string_opt=of_string_opt;exports.to_string=to_string;exports.compare=compare;exports.equal=equal},{"./caml_builtin_exceptions.js":6,"./caml_format.js":10,"./caml_js_exceptions.js":14,"./caml_primitive.js":19}],35:[function(require,module,exports){"use strict";var Marshal=require("./marshal.js");var Caml_array=require("./caml_array.js");var Caml_external_polyfill=require("./caml_external_polyfill.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function is_block(a){return typeof a!=="number"}var double_field=Caml_array.caml_array_get;var set_double_field=Caml_array.caml_array_set;function marshal(obj){
return Caml_external_polyfill.resolve("caml_output_value_to_string")(obj,0)}function unmarshal(str,pos){return[Marshal.from_bytes(str,pos),pos+Marshal.total_size(str,pos)|0]}function extension_constructor(x){var slot=typeof x!=="number"&&(x.tag|0)!==248&&x.length>=1?x[0]:x;var name;if(typeof slot!=="number"&&slot.tag===248){name=slot[0]}else{throw[Caml_builtin_exceptions.invalid_argument,"Obj.extension_constructor"]}if(name.tag===252){return slot}else{throw[Caml_builtin_exceptions.invalid_argument,"Obj.extension_constructor"]}}function extension_name(slot){return slot[0]}function extension_id(slot){return slot[1]}function length(x){return x.length-2|0}var first_non_constant_constructor_tag=0;var last_non_constant_constructor_tag=245;var lazy_tag=246;var closure_tag=247;var object_tag=248;var infix_tag=249;var forward_tag=250;var no_scan_tag=251;var abstract_tag=251;var string_tag=252;var double_tag=253;var double_array_tag=254;var custom_tag=255;var final_tag=255;var int_tag=1e3;var out_of_heap_tag=1001;var unaligned_tag=1002;function Ephemeron_create(prim){return Caml_external_polyfill.resolve("caml_ephe_create")(prim)}function Ephemeron_get_key(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_get_key")(prim,prim$1)}function Ephemeron_get_key_copy(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_get_key_copy")(prim,prim$1)}function Ephemeron_set_key(prim,prim$1,prim$2){return Caml_external_polyfill.resolve("caml_ephe_set_key")(prim,prim$1,prim$2)}function Ephemeron_unset_key(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_unset_key")(prim,prim$1)}function Ephemeron_check_key(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_check_key")(prim,prim$1)}function Ephemeron_blit_key(prim,prim$1,prim$2,prim$3,prim$4){return Caml_external_polyfill.resolve("caml_ephe_blit_key")(prim,prim$1,prim$2,prim$3,prim$4)}function Ephemeron_get_data(prim){return Caml_external_polyfill.resolve("caml_ephe_get_data")(prim)}function Ephemeron_get_data_copy(prim){return Caml_external_polyfill.resolve("caml_ephe_get_data_copy")(prim)}function Ephemeron_set_data(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_set_data")(prim,prim$1)}function Ephemeron_unset_data(prim){return Caml_external_polyfill.resolve("caml_ephe_unset_data")(prim)}function Ephemeron_check_data(prim){return Caml_external_polyfill.resolve("caml_ephe_check_data")(prim)}function Ephemeron_blit_data(prim,prim$1){return Caml_external_polyfill.resolve("caml_ephe_blit_data")(prim,prim$1)}var Ephemeron={create:Ephemeron_create,length:length,get_key:Ephemeron_get_key,get_key_copy:Ephemeron_get_key_copy,set_key:Ephemeron_set_key,unset_key:Ephemeron_unset_key,check_key:Ephemeron_check_key,blit_key:Ephemeron_blit_key,get_data:Ephemeron_get_data,get_data_copy:Ephemeron_get_data_copy,set_data:Ephemeron_set_data,unset_data:Ephemeron_unset_data,check_data:Ephemeron_check_data,blit_data:Ephemeron_blit_data};exports.is_block=is_block;exports.double_field=double_field;exports.set_double_field=set_double_field;exports.first_non_constant_constructor_tag=first_non_constant_constructor_tag;exports.last_non_constant_constructor_tag=last_non_constant_constructor_tag;exports.lazy_tag=lazy_tag;exports.closure_tag=closure_tag;exports.object_tag=object_tag;exports.infix_tag=infix_tag;exports.forward_tag=forward_tag;exports.no_scan_tag=no_scan_tag;exports.abstract_tag=abstract_tag;exports.string_tag=string_tag;exports.double_tag=double_tag;exports.double_array_tag=double_array_tag;exports.custom_tag=custom_tag;exports.final_tag=final_tag;exports.int_tag=int_tag;exports.out_of_heap_tag=out_of_heap_tag;exports.unaligned_tag=unaligned_tag;exports.extension_constructor=extension_constructor;exports.extension_name=extension_name;exports.extension_id=extension_id;exports.marshal=marshal;exports.unmarshal=unmarshal;exports.Ephemeron=Ephemeron},{"./caml_array.js":5,"./caml_builtin_exceptions.js":6,"./caml_external_polyfill.js":9,"./marshal.js":33}],36:[function(require,module,exports){"use strict";var Curry=require("./curry.js");var Caml_io=require("./caml_io.js");var Caml_sys=require("./caml_sys.js");var Caml_bytes=require("./caml_bytes.js");var Caml_format=require("./caml_format.js");var Caml_string=require("./caml_string.js");var Caml_exceptions=require("./caml_exceptions.js");var Caml_js_exceptions=require("./caml_js_exceptions.js");var Caml_external_polyfill=require("./caml_external_polyfill.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");var CamlinternalFormatBasics=require("./camlinternalFormatBasics.js");function failwith(s){throw[Caml_builtin_exceptions.failure,s]}function invalid_arg(s){throw[Caml_builtin_exceptions.invalid_argument,s]}var Exit=Caml_exceptions.create("Pervasives.Exit");function abs(x){if(x>=0){return x}else{return-x|0}}function lnot(x){return x^-1}var min_int=-2147483648;function classify_float(x){if(isFinite(x)){if(Math.abs(x)>=2.2250738585072014e-308){return 0}else if(x!==0){return 1}else{return 2}}else if(isNaN(x)){return 4}else{return 3}}function char_of_int(n){if(n<0||n>255){throw[Caml_builtin_exceptions.invalid_argument,"char_of_int"]}return n}function string_of_bool(b){if(b){return"true"}else{return"false"}}function bool_of_string(param){switch(param){case"false":return false;case"true":return true;default:throw[Caml_builtin_exceptions.invalid_argument,"bool_of_string"]}}function bool_of_string_opt(param){switch(param){case"false":return false;case"true":return true;default:return}}function int_of_string_opt(s){try{return Caml_format.caml_int_of_string(s)}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return}else{throw exn}}}function valid_float_lexem(s){var l=s.length;var _i=0;while(true){var i=_i;if(i>=l){return s+"."}else{var match=Caml_string.get(s,i);if(match>=48){if(match>=58){return s}else{_i=i+1|0;continue}}else if(match!==45){return s}else{_i=i+1|0;continue}}}}function string_of_float(f){return valid_float_lexem(Caml_format.caml_format_float("%.12g",f))}function float_of_string_opt(s){try{return Caml_format.caml_float_of_string(s)}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return}else{throw exn}}}function $at(l1,l2){if(l1){return[l1[0],$at(l1[1],l2)]}else{return l2}}var stdin=Caml_io.stdin;var stdout=Caml_io.stdout;var stderr=Caml_io.stderr;function open_out_gen(mode,perm,name){var c=Caml_external_polyfill.resolve("caml_ml_open_descriptor_out")(Caml_external_polyfill.resolve("caml_sys_open")(name,mode,perm));Caml_external_polyfill.resolve("caml_ml_set_channel_name")(c,name);return c}function open_out(name){return open_out_gen([1,[3,[4,[7,0]]]],438,name)}function open_out_bin(name){return open_out_gen([1,[3,[4,[6,0]]]],438,name)}function flush_all(param){var _param=Caml_io.caml_ml_out_channels_list(0);while(true){var param$1=_param;if(param$1){try{Caml_io.caml_ml_flush(param$1[0])}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]!==Caml_builtin_exceptions.sys_error){throw exn}}_param=param$1[1];continue}else{return 0}}}function output_bytes(oc,s){return Caml_external_polyfill.resolve("caml_ml_output_bytes")(oc,s,0,s.length)}function output_string(oc,s){return Caml_io.caml_ml_output(oc,s,0,s.length)}function output(oc,s,ofs,len){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"output"]}return Caml_external_polyfill.resolve("caml_ml_output_bytes")(oc,s,ofs,len)}function output_substring(oc,s,ofs,len){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"output_substring"]}return Caml_io.caml_ml_output(oc,s,ofs,len)}function output_value(chan,v){return Caml_external_polyfill.resolve("caml_output_value")(chan,v,0)}function close_out(oc){Caml_io.caml_ml_flush(oc);return Caml_external_polyfill.resolve("caml_ml_close_channel")(oc)}function close_out_noerr(oc){try{Caml_io.caml_ml_flush(oc)}catch(exn){}try{return Caml_external_polyfill.resolve("caml_ml_close_channel")(oc)}catch(exn$1){return 0}}function open_in_gen(mode,perm,name){var c=Caml_external_polyfill.resolve("caml_ml_open_descriptor_in")(Caml_external_polyfill.resolve("caml_sys_open")(name,mode,perm));Caml_external_polyfill.resolve("caml_ml_set_channel_name")(c,name);return c}function open_in(name){return open_in_gen([0,[7,0]],0,name)}function open_in_bin(name){return open_in_gen([0,[6,0]],0,name)}function input(ic,s,ofs,len){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"input"]}return Caml_external_polyfill.resolve("caml_ml_input")(ic,s,ofs,len)}function unsafe_really_input(ic,s,_ofs,_len){while(true){var len=_len;var ofs=_ofs;if(len<=0){return 0}else{var r=Caml_external_polyfill.resolve("caml_ml_input")(ic,s,ofs,len);if(r===0){throw Caml_builtin_exceptions.end_of_file}_len=len-r|0;_ofs=ofs+r|0;continue}}}function really_input(ic,s,ofs,len){if(ofs<0||len<0||ofs>(s.length-len|0)){throw[Caml_builtin_exceptions.invalid_argument,"really_input"]}return unsafe_really_input(ic,s,ofs,len)}function really_input_string(ic,len){var s=Caml_bytes.caml_create_bytes(len);really_input(ic,s,0,len);return Caml_bytes.bytes_to_string(s)}function input_line(chan){var build_result=function(buf,_pos,_param){while(true){var param=_param;var pos=_pos;if(param){var hd=param[0];var len=hd.length;Caml_bytes.caml_blit_bytes(hd,0,buf,pos-len|0,len);_param=param[1];_pos=pos-len|0;continue}else{return buf}}};var scan=function(_accu,_len){while(true){var len=_len;var accu=_accu;var n=Caml_external_polyfill.resolve("caml_ml_input_scan_line")(chan);if(n===0){if(accu){return build_result(Caml_bytes.caml_create_bytes(len),len,accu)}else{throw Caml_builtin_exceptions.end_of_file}}else if(n>0){var res=Caml_bytes.caml_create_bytes(n-1|0);Caml_external_polyfill.resolve("caml_ml_input")(chan,res,0,n-1|0);Caml_external_polyfill.resolve("caml_ml_input_char")(chan);if(accu){var len$1=(len+n|0)-1|0;return build_result(Caml_bytes.caml_create_bytes(len$1),len$1,[res,accu])}else{return res}}else{var beg=Caml_bytes.caml_create_bytes(-n|0);Caml_external_polyfill.resolve("caml_ml_input")(chan,beg,0,-n|0);_len=len-n|0;_accu=[beg,accu];continue}}};return Caml_bytes.bytes_to_string(scan(0,0))}function close_in_noerr(ic){try{return Caml_external_polyfill.resolve("caml_ml_close_channel")(ic)}catch(exn){return 0}}function print_char(c){return Caml_io.caml_ml_output_char(stdout,c)}function print_string(s){return output_string(stdout,s)}function print_bytes(s){return output_bytes(stdout,s)}function print_int(i){return output_string(stdout,String(i))}function print_float(f){return output_string(stdout,valid_float_lexem(Caml_format.caml_format_float("%.12g",f)))}function print_newline(param){Caml_io.caml_ml_output_char(stdout,10);return Caml_io.caml_ml_flush(stdout)}function prerr_char(c){return Caml_io.caml_ml_output_char(stderr,c)}function prerr_string(s){return output_string(stderr,s)}function prerr_bytes(s){return output_bytes(stderr,s)}function prerr_int(i){return output_string(stderr,String(i))}function prerr_float(f){return output_string(stderr,valid_float_lexem(Caml_format.caml_format_float("%.12g",f)))}function prerr_newline(param){Caml_io.caml_ml_output_char(stderr,10);return Caml_io.caml_ml_flush(stderr)}function read_line(param){Caml_io.caml_ml_flush(stdout);return input_line(stdin)}function read_int(param){return Caml_format.caml_int_of_string((Caml_io.caml_ml_flush(stdout),input_line(stdin)))}function read_int_opt(param){return int_of_string_opt((Caml_io.caml_ml_flush(stdout),input_line(stdin)))}function read_float(param){return Caml_format.caml_float_of_string((Caml_io.caml_ml_flush(stdout),input_line(stdin)))}function read_float_opt(param){return float_of_string_opt((Caml_io.caml_ml_flush(stdout),input_line(stdin)))}function string_of_format(param){return param[1]}function $caret$caret(param,param$1){return[CamlinternalFormatBasics.concat_fmt(param[0],param$1[0]),param[1]+("%,"+param$1[1])]}var exit_function={contents:flush_all};function at_exit(f){var g=exit_function.contents;exit_function.contents=function(param){Curry._1(f,0);return Curry._1(g,0)};return 0}function do_at_exit(param){return Curry._1(exit_function.contents,0)}function exit(retcode){do_at_exit(0);return Caml_sys.caml_sys_exit(retcode)}var max_int=2147483647;var infinity=Infinity;var neg_infinity=-Infinity;var max_float=1.7976931348623157e308;var min_float=2.2250738585072014e-308;var epsilon_float=2.220446049250313e-16;var flush=Caml_io.caml_ml_flush;var output_char=Caml_io.caml_ml_output_char;var output_byte=Caml_io.caml_ml_output_char;function output_binary_int(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_output_int")(prim,prim$1)}function seek_out(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_seek_out")(prim,prim$1)}function pos_out(prim){return Caml_external_polyfill.resolve("caml_ml_pos_out")(prim)}function out_channel_length(prim){return Caml_external_polyfill.resolve("caml_ml_channel_size")(prim)}function set_binary_mode_out(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_set_binary_mode")(prim,prim$1)}function input_char(prim){return Caml_external_polyfill.resolve("caml_ml_input_char")(prim)}function input_byte(prim){return Caml_external_polyfill.resolve("caml_ml_input_char")(prim)}function input_binary_int(prim){return Caml_external_polyfill.resolve("caml_ml_input_int")(prim)}function input_value(prim){return Caml_external_polyfill.resolve("caml_input_value")(prim)}function seek_in(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_seek_in")(prim,prim$1)}function pos_in(prim){return Caml_external_polyfill.resolve("caml_ml_pos_in")(prim)}function in_channel_length(prim){return Caml_external_polyfill.resolve("caml_ml_channel_size")(prim)}function close_in(prim){return Caml_external_polyfill.resolve("caml_ml_close_channel")(prim)}function set_binary_mode_in(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_set_binary_mode")(prim,prim$1)}function LargeFile_seek_out(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_seek_out_64")(prim,prim$1)}function LargeFile_pos_out(prim){return Caml_external_polyfill.resolve("caml_ml_pos_out_64")(prim)}function LargeFile_out_channel_length(prim){return Caml_external_polyfill.resolve("caml_ml_channel_size_64")(prim)}function LargeFile_seek_in(prim,prim$1){return Caml_external_polyfill.resolve("caml_ml_seek_in_64")(prim,prim$1)}function LargeFile_pos_in(prim){return Caml_external_polyfill.resolve("caml_ml_pos_in_64")(prim)}function LargeFile_in_channel_length(prim){return Caml_external_polyfill.resolve("caml_ml_channel_size_64")(prim)}var LargeFile={seek_out:LargeFile_seek_out,pos_out:LargeFile_pos_out,out_channel_length:LargeFile_out_channel_length,seek_in:LargeFile_seek_in,pos_in:LargeFile_pos_in,in_channel_length:LargeFile_in_channel_length};exports.invalid_arg=invalid_arg;exports.failwith=failwith;exports.Exit=Exit;exports.abs=abs;exports.max_int=max_int;exports.min_int=min_int;exports.lnot=lnot;exports.infinity=infinity;exports.neg_infinity=neg_infinity;exports.max_float=max_float;exports.min_float=min_float;exports.epsilon_float=epsilon_float;exports.classify_float=classify_float;exports.char_of_int=char_of_int;exports.string_of_bool=string_of_bool;exports.bool_of_string=bool_of_string;exports.bool_of_string_opt=bool_of_string_opt;exports.int_of_string_opt=int_of_string_opt;exports.string_of_float=string_of_float;exports.float_of_string_opt=float_of_string_opt;exports.$at=$at;exports.stdin=stdin;exports.stdout=stdout;exports.stderr=stderr;exports.print_char=print_char;exports.print_string=print_string;exports.print_bytes=print_bytes;exports.print_int=print_int;exports.print_float=print_float;exports.print_newline=print_newline;exports.prerr_char=prerr_char;exports.prerr_string=prerr_string;exports.prerr_bytes=prerr_bytes;exports.prerr_int=prerr_int;exports.prerr_float=prerr_float;exports.prerr_newline=prerr_newline;exports.read_line=read_line;exports.read_int=read_int;exports.read_int_opt=read_int_opt;exports.read_float=read_float;exports.read_float_opt=read_float_opt;exports.open_out=open_out;exports.open_out_bin=open_out_bin;exports.open_out_gen=open_out_gen;exports.flush=flush;exports.flush_all=flush_all;exports.output_char=output_char;exports.output_string=output_string;exports.output_bytes=output_bytes;exports.output=output;exports.output_substring=output_substring;exports.output_byte=output_byte;exports.output_binary_int=output_binary_int;exports.output_value=output_value;exports.seek_out=seek_out;exports.pos_out=pos_out;exports.out_channel_length=out_channel_length;exports.close_out=close_out;exports.close_out_noerr=close_out_noerr;exports.set_binary_mode_out=set_binary_mode_out;exports.open_in=open_in;exports.open_in_bin=open_in_bin;exports.open_in_gen=open_in_gen;exports.input_char=input_char;exports.input_line=input_line;exports.input=input;exports.really_input=really_input;exports.really_input_string=really_input_string;exports.input_byte=input_byte;exports.input_binary_int=input_binary_int;exports.input_value=input_value;exports.seek_in=seek_in;exports.pos_in=pos_in;exports.in_channel_length=in_channel_length;exports.close_in=close_in;exports.close_in_noerr=close_in_noerr;exports.set_binary_mode_in=set_binary_mode_in;exports.LargeFile=LargeFile;exports.string_of_format=string_of_format;exports.$caret$caret=$caret$caret;exports.exit=exit;exports.at_exit=at_exit;exports.valid_float_lexem=valid_float_lexem;exports.unsafe_really_input=unsafe_really_input;exports.do_at_exit=do_at_exit},{"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_exceptions.js":8,"./caml_external_polyfill.js":9,"./caml_format.js":10,"./caml_io.js":13,"./caml_js_exceptions.js":14,"./caml_string.js":20,"./caml_sys.js":21,"./camlinternalFormatBasics.js":24,"./curry.js":27}],37:[function(require,module,exports){"use strict";var Curry=require("./curry.js");var $$Buffer=require("./buffer.js");var Pervasives=require("./pervasives.js");var CamlinternalFormat=require("./camlinternalFormat.js");function kfprintf(k,o,param){return CamlinternalFormat.make_printf(function(o,acc){CamlinternalFormat.output_acc(o,acc);return Curry._1(k,o)},o,0,param[0])}function kbprintf(k,b,param){return CamlinternalFormat.make_printf(function(b,acc){CamlinternalFormat.bufput_acc(b,acc);return Curry._1(k,b)},b,0,param[0])}function ikfprintf(k,oc,param){return CamlinternalFormat.make_iprintf(k,oc,param[0])}function fprintf(oc,fmt){return kfprintf(function(prim){return 0},oc,fmt)}function bprintf(b,fmt){return kbprintf(function(prim){return 0},b,fmt)}function ifprintf(oc,fmt){return ikfprintf(function(prim){return 0},oc,fmt)}function printf(fmt){return fprintf(Pervasives.stdout,fmt)}function eprintf(fmt){return fprintf(Pervasives.stderr,fmt)}function ksprintf(k,param){var k$prime=function(param,acc){var buf=$$Buffer.create(64);CamlinternalFormat.strput_acc(buf,acc);return Curry._1(k,$$Buffer.contents(buf))};return CamlinternalFormat.make_printf(k$prime,0,0,param[0])}function sprintf(fmt){return ksprintf(function(s){return s},fmt)}var kprintf=ksprintf;exports.fprintf=fprintf;exports.printf=printf;exports.eprintf=eprintf;exports.sprintf=sprintf;exports.bprintf=bprintf;exports.ifprintf=ifprintf;exports.kfprintf=kfprintf;exports.ikfprintf=ikfprintf;exports.ksprintf=ksprintf;exports.kbprintf=kbprintf;exports.kprintf=kprintf},{"./buffer.js":3,"./camlinternalFormat.js":23,"./curry.js":27,"./pervasives.js":36}],38:[function(require,module,exports){"use strict";var $$Array=require("./array.js");var Curry=require("./curry.js");var Int32=require("./int32.js");var Int64=require("./int64.js");var Digest=require("./digest.js");var Caml_sys=require("./caml_sys.js");var Nativeint=require("./nativeint.js");var Caml_array=require("./caml_array.js");var Caml_int64=require("./caml_int64.js");var Caml_string=require("./caml_string.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function assign(st1,st2){$$Array.blit(st2.st,0,st1.st,0,55);st1.idx=st2.idx;return 0}function full_init(s,seed){var combine=function(accu,x){return Digest.string(accu+String(x))};var extract=function(d){return((Caml_string.get(d,0)+(Caml_string.get(d,1)<<8)|0)+(Caml_string.get(d,2)<<16)|0)+(Caml_string.get(d,3)<<24)|0};var seed$1=seed.length===0?[0]:seed;var l=seed$1.length;for(var i=0;i<=54;++i){Caml_array.caml_array_set(s.st,i,i)}var accu="x";for(var i$1=0,i_finish=54+(55>l?55:l)|0;i$1<=i_finish;++i$1){var j=i$1%55;var k=i$1%l;accu=combine(accu,Caml_array.caml_array_get(seed$1,k));Caml_array.caml_array_set(s.st,j,(Caml_array.caml_array_get(s.st,j)^extract(accu))&1073741823)}s.idx=0;return 0}function make(seed){var result={st:Caml_array.caml_make_vect(55,0),idx:0};full_init(result,seed);return result}function make_self_init(param){return make(Caml_sys.caml_sys_random_seed(0))}function copy(s){var result={st:Caml_array.caml_make_vect(55,0),idx:0};assign(result,s);return result}function bits(s){s.idx=(s.idx+1|0)%55;var curval=Caml_array.caml_array_get(s.st,s.idx);var newval=Caml_array.caml_array_get(s.st,(s.idx+24|0)%55)+(curval^curval>>>25&31)|0;var newval30=newval&1073741823;Caml_array.caml_array_set(s.st,s.idx,newval30);return newval30}function $$int(s,bound){if(bound>1073741823||bound<=0){throw[Caml_builtin_exceptions.invalid_argument,"Random.int"]}var s$1=s;var n=bound;while(true){var r=bits(s$1);var v=r%n;if((r-v|0)>((1073741823-n|0)+1|0)){continue}else{return v}}}function int32(s,bound){if(bound<=0){throw[Caml_builtin_exceptions.invalid_argument,"Random.int32"]}var s$1=s;var n=bound;while(true){var b1=bits(s$1);var b2=(bits(s$1)&1)<<30;var r=b1|b2;var v=r%n;if((r-v|0)>((Int32.max_int-n|0)+1|0)){continue}else{return v}}}function int64(s,bound){if(Caml_int64.le(bound,{hi:0,lo:0})){throw[Caml_builtin_exceptions.invalid_argument,"Random.int64"]}var s$1=s;var n=bound;while(true){var b1=Caml_int64.of_int32(bits(s$1));var b2=Caml_int64.lsl_(Caml_int64.of_int32(bits(s$1)),30);var b3=Caml_int64.lsl_(Caml_int64.of_int32(bits(s$1)&7),60);var r=Caml_int64.or_(b1,Caml_int64.or_(b2,b3));var v=Caml_int64.mod_(r,n);if(Caml_int64.gt(Caml_int64.sub(r,v),Caml_int64.add(Caml_int64.sub(Int64.max_int,n),{hi:0,lo:1}))){continue}else{return v}}}var nativeint=Nativeint.size===32?int32:function(s,bound){return Caml_int64.to_int32(int64(s,Caml_int64.of_int32(bound)))};function rawfloat(s){var r1=bits(s);var r2=bits(s);return(r1/1073741824+r2)/1073741824}function $$float(s,bound){return rawfloat(s)*bound}function bool(s){return(bits(s)&1)===0}var $$default={st:[987910699,495797812,364182224,414272206,318284740,990407751,383018966,270373319,840823159,24560019,536292337,512266505,189156120,730249596,143776328,51606627,140166561,366354223,1003410265,700563762,981890670,913149062,526082594,1021425055,784300257,667753350,630144451,949649812,48546892,415514493,258888527,511570777,89983870,283659902,308386020,242688715,482270760,865188196,1027664170,207196989,193777847,619708188,671350186,149669678,257044018,87658204,558145612,183450813,28133145,901332182,710253903,510646120,652377910,409934019,801085050],idx:0};function bits$1(param){return bits($$default)}function $$int$1(bound){return $$int($$default,bound)}function int32$1(bound){return int32($$default,bound)}function nativeint$1(bound){return Curry._2(nativeint,$$default,bound)}function int64$1(bound){return int64($$default,bound)}function $$float$1(scale){return rawfloat($$default)*scale}function bool$1(param){return bool($$default)}function full_init$1(seed){return full_init($$default,seed)}function init(seed){return full_init($$default,[seed])}function self_init(param){return full_init$1(Caml_sys.caml_sys_random_seed(0))}function get_state(param){return copy($$default)}function set_state(s){return assign($$default,s)}var State={make:make,make_self_init:make_self_init,copy:copy,bits:bits,$$int:$$int,int32:int32,nativeint:nativeint,int64:int64,$$float:$$float,bool:bool};exports.init=init;exports.full_init=full_init$1;exports.self_init=self_init;exports.bits=bits$1;exports.$$int=$$int$1;exports.int32=int32$1;exports.nativeint=nativeint$1;exports.int64=int64$1;exports.$$float=$$float$1;exports.bool=bool$1;exports.State=State;exports.get_state=get_state;exports.set_state=set_state},{"./array.js":1,"./caml_array.js":5,"./caml_builtin_exceptions.js":6,"./caml_int64.js":12,"./caml_string.js":20,"./caml_sys.js":21,"./curry.js":27,"./digest.js":28,"./int32.js":29,"./int64.js":30,"./nativeint.js":34}],39:[function(require,module,exports){"use strict";var Bytes=require("./bytes.js");var Curry=require("./curry.js");var Caml_bytes=require("./caml_bytes.js");var Caml_primitive=require("./caml_primitive.js");var Caml_builtin_exceptions=require("./caml_builtin_exceptions.js");function make(n,c){return Caml_bytes.bytes_to_string(Bytes.make(n,c))}function init(n,f){return Caml_bytes.bytes_to_string(Bytes.init(n,f))}function copy(s){return Caml_bytes.bytes_to_string(Bytes.copy(Caml_bytes.bytes_of_string(s)))}function sub(s,ofs,len){return Caml_bytes.bytes_to_string(Bytes.sub(Caml_bytes.bytes_of_string(s),ofs,len))}function ensure_ge(x,y){if(x>=y){return x}else{throw[Caml_builtin_exceptions.invalid_argument,"String.concat"]}}function sum_lengths(_acc,seplen,_param){while(true){var param=_param;var acc=_acc;if(param){var tl=param[1];var hd=param[0];if(tl){_param=tl;_acc=ensure_ge((hd.length+seplen|0)+acc|0,acc);continue}else{return hd.length+acc|0}}else{return acc}}}function unsafe_blits(dst,_pos,sep,seplen,_param){while(true){var param=_param;var pos=_pos;if(param){var tl=param[1];var hd=param[0];if(tl){Caml_bytes.caml_blit_string(hd,0,dst,pos,hd.length);Caml_bytes.caml_blit_string(sep,0,dst,pos+hd.length|0,seplen);_param=tl;_pos=(pos+hd.length|0)+seplen|0;continue}else{Caml_bytes.caml_blit_string(hd,0,dst,pos,hd.length);return dst}}else{return dst}}}function concat(sep,l){if(l){var seplen=sep.length;return Caml_bytes.bytes_to_string(unsafe_blits(Caml_bytes.caml_create_bytes(sum_lengths(0,seplen,l)),0,sep,seplen,l))}else{return""}}function iter(f,s){for(var i=0,i_finish=s.length-1|0;i<=i_finish;++i){Curry._1(f,s.charCodeAt(i))}return 0}function iteri(f,s){for(var i=0,i_finish=s.length-1|0;i<=i_finish;++i){Curry._2(f,i,s.charCodeAt(i))}return 0}function map(f,s){return Caml_bytes.bytes_to_string(Bytes.map(f,Caml_bytes.bytes_of_string(s)))}function mapi(f,s){return Caml_bytes.bytes_to_string(Bytes.mapi(f,Caml_bytes.bytes_of_string(s)))}function is_space(param){var switcher=param-9|0;if(switcher>4||switcher<0){return switcher===23}else{return switcher!==2}}function trim(s){if(s===""||!(is_space(s.charCodeAt(0))||is_space(s.charCodeAt(s.length-1|0)))){return s}else{return Caml_bytes.bytes_to_string(Bytes.trim(Caml_bytes.bytes_of_string(s)))}}function escaped(s){var needs_escape=function(_i){while(true){var i=_i;if(i>=s.length){return false}else{var match=s.charCodeAt(i);if(match>=32){var switcher=match-34|0;if(switcher>58||switcher<0){if(switcher>=93){return true}else{_i=i+1|0;continue}}else if(switcher>57||switcher<1){return true}else{_i=i+1|0;continue}}else{return true}}}};if(needs_escape(0)){return Caml_bytes.bytes_to_string(Bytes.escaped(Caml_bytes.bytes_of_string(s)))}else{return s}}function index_rec(s,lim,_i,c){while(true){var i=_i;if(i>=lim){throw Caml_builtin_exceptions.not_found}if(s.charCodeAt(i)===c){return i}else{_i=i+1|0;continue}}}function index(s,c){return index_rec(s,s.length,0,c)}function index_rec_opt(s,lim,_i,c){while(true){var i=_i;if(i>=lim){return}else if(s.charCodeAt(i)===c){return i}else{_i=i+1|0;continue}}}function index_opt(s,c){return index_rec_opt(s,s.length,0,c)}function index_from(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.index_from / Bytes.index_from"]}return index_rec(s,l,i,c)}function index_from_opt(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.index_from_opt / Bytes.index_from_opt"]}return index_rec_opt(s,l,i,c)}function rindex_rec(s,_i,c){while(true){var i=_i;if(i<0){throw Caml_builtin_exceptions.not_found}if(s.charCodeAt(i)===c){return i}else{_i=i-1|0;continue}}}function rindex(s,c){return rindex_rec(s,s.length-1|0,c)}function rindex_from(s,i,c){if(i<-1||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rindex_from / Bytes.rindex_from"]}return rindex_rec(s,i,c)}function rindex_rec_opt(s,_i,c){while(true){var i=_i;if(i<0){return}else if(s.charCodeAt(i)===c){return i}else{_i=i-1|0;continue}}}function rindex_opt(s,c){return rindex_rec_opt(s,s.length-1|0,c)}function rindex_from_opt(s,i,c){if(i<-1||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rindex_from_opt / Bytes.rindex_from_opt"]}return rindex_rec_opt(s,i,c)}function contains_from(s,i,c){var l=s.length;if(i<0||i>l){throw[Caml_builtin_exceptions.invalid_argument,"String.contains_from / Bytes.contains_from"]}try{index_rec(s,l,i,c);return true}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return false}else{throw exn}}}function contains(s,c){return contains_from(s,0,c)}function rcontains_from(s,i,c){if(i<0||i>=s.length){throw[Caml_builtin_exceptions.invalid_argument,"String.rcontains_from / Bytes.rcontains_from"]}try{rindex_rec(s,i,c);return true}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return false}else{throw exn}}}function uppercase_ascii(s){return Caml_bytes.bytes_to_string(Bytes.uppercase_ascii(Caml_bytes.bytes_of_string(s)))}function lowercase_ascii(s){return Caml_bytes.bytes_to_string(Bytes.lowercase_ascii(Caml_bytes.bytes_of_string(s)))}function capitalize_ascii(s){return Caml_bytes.bytes_to_string(Bytes.capitalize_ascii(Caml_bytes.bytes_of_string(s)))}function uncapitalize_ascii(s){return Caml_bytes.bytes_to_string(Bytes.uncapitalize_ascii(Caml_bytes.bytes_of_string(s)))}var compare=Caml_primitive.caml_string_compare;function split_on_char(sep,s){var r=0;var j=s.length;for(var i=s.length-1|0;i>=0;--i){if(s.charCodeAt(i)===sep){r=[sub(s,i+1|0,(j-i|0)-1|0),r];j=i}}return[sub(s,0,j),r]}function uppercase(s){return Caml_bytes.bytes_to_string(Bytes.uppercase(Caml_bytes.bytes_of_string(s)))}function lowercase(s){return Caml_bytes.bytes_to_string(Bytes.lowercase(Caml_bytes.bytes_of_string(s)))}function capitalize(s){return Caml_bytes.bytes_to_string(Bytes.capitalize(Caml_bytes.bytes_of_string(s)))}function uncapitalize(s){return Caml_bytes.bytes_to_string(Bytes.uncapitalize(Caml_bytes.bytes_of_string(s)))}var fill=Bytes.fill;var blit=Bytes.blit_string;function equal(prim,prim$1){return prim===prim$1}exports.make=make;exports.init=init;exports.copy=copy;exports.sub=sub;exports.fill=fill;exports.blit=blit;exports.concat=concat;exports.iter=iter;exports.iteri=iteri;exports.map=map;exports.mapi=mapi;exports.trim=trim;exports.escaped=escaped;exports.index=index;exports.index_opt=index_opt;exports.rindex=rindex;exports.rindex_opt=rindex_opt;exports.index_from=index_from;exports.index_from_opt=index_from_opt;exports.rindex_from=rindex_from;exports.rindex_from_opt=rindex_from_opt;exports.contains=contains;exports.contains_from=contains_from;exports.rcontains_from=rcontains_from;exports.uppercase=uppercase;exports.lowercase=lowercase;exports.capitalize=capitalize;exports.uncapitalize=uncapitalize;exports.uppercase_ascii=uppercase_ascii;exports.lowercase_ascii=lowercase_ascii;exports.capitalize_ascii=capitalize_ascii;exports.uncapitalize_ascii=uncapitalize_ascii;exports.compare=compare;exports.equal=equal;exports.split_on_char=split_on_char},{"./bytes.js":4,"./caml_builtin_exceptions.js":6,"./caml_bytes.js":7,"./caml_primitive.js":19,"./curry.js":27}],40:[function(require,module,exports){(function(process){"use strict";var Caml_sys=require("./caml_sys.js");var Caml_exceptions=require("./caml_exceptions.js");var match=Caml_sys.caml_sys_get_argv(0);var backend_type=["BS"];var big_endian=false;var int_size=32;var unix=true;var win32=false;var cygwin=false;function getenv_opt(s){
var match=typeof process==="undefined"?undefined:process;if(match!==undefined){return match.env[s]}}var interactive={contents:false};function set_signal(sig_num,sig_beh){return 0}var Break=Caml_exceptions.create("Sys.Break");function catch_break(on){return 0}function enable_runtime_warnings(param){return 0}function runtime_warnings_enabled(param){return false}var argv=match[1];var executable_name=match[0];var word_size=32;var max_string_length=2147483647;var max_array_length=2147483647;var sigabrt=-1;var sigalrm=-2;var sigfpe=-3;var sighup=-4;var sigill=-5;var sigint=-6;var sigkill=-7;var sigpipe=-8;var sigquit=-9;var sigsegv=-10;var sigterm=-11;var sigusr1=-12;var sigusr2=-13;var sigchld=-14;var sigcont=-15;var sigstop=-16;var sigtstp=-17;var sigttin=-18;var sigttou=-19;var sigvtalrm=-20;var sigprof=-21;var sigbus=-22;var sigpoll=-23;var sigsys=-24;var sigtrap=-25;var sigurg=-26;var sigxcpu=-27;var sigxfsz=-28;var ocaml_version="4.06.2+BS";exports.argv=argv;exports.executable_name=executable_name;exports.getenv_opt=getenv_opt;exports.interactive=interactive;exports.backend_type=backend_type;exports.unix=unix;exports.win32=win32;exports.cygwin=cygwin;exports.word_size=word_size;exports.int_size=int_size;exports.big_endian=big_endian;exports.max_string_length=max_string_length;exports.max_array_length=max_array_length;exports.set_signal=set_signal;exports.sigabrt=sigabrt;exports.sigalrm=sigalrm;exports.sigfpe=sigfpe;exports.sighup=sighup;exports.sigill=sigill;exports.sigint=sigint;exports.sigkill=sigkill;exports.sigpipe=sigpipe;exports.sigquit=sigquit;exports.sigsegv=sigsegv;exports.sigterm=sigterm;exports.sigusr1=sigusr1;exports.sigusr2=sigusr2;exports.sigchld=sigchld;exports.sigcont=sigcont;exports.sigstop=sigstop;exports.sigtstp=sigtstp;exports.sigttin=sigttin;exports.sigttou=sigttou;exports.sigvtalrm=sigvtalrm;exports.sigprof=sigprof;exports.sigbus=sigbus;exports.sigpoll=sigpoll;exports.sigsys=sigsys;exports.sigtrap=sigtrap;exports.sigurg=sigurg;exports.sigxcpu=sigxcpu;exports.sigxfsz=sigxfsz;exports.Break=Break;exports.catch_break=catch_break;exports.ocaml_version=ocaml_version;exports.enable_runtime_warnings=enable_runtime_warnings;exports.runtime_warnings_enabled=runtime_warnings_enabled}).call(this,require("_process"))},{"./caml_exceptions.js":8,"./caml_sys.js":21,_process:51}],41:[function(require,module,exports){"use strict";var Util=require("./util.bs.js");var Block=require("bs-platform/lib/js/block.js");var Curry=require("bs-platform/lib/js/curry.js");var $$Buffer=require("bs-platform/lib/js/buffer.js");var Lexing=require("bs-platform/lib/js/lexing.js");var Printf=require("bs-platform/lib/js/printf.js");var Caml_format=require("bs-platform/lib/js/caml_format.js");function lexing_error(lexbuf,msg){var match=Util.get_lexing_position(lexbuf);throw[Util.Syntax_error,[[match[0],match[1]],msg]]}var __ocaml_lex_tables={lex_base:"\0\0\0M\0W\0\0\0\0\09\0:\0\06\07\0\0\0\0K",lex_backtrk:"\f\0\0\0\f\0\v\0\n\0\v\0\n\0\0",lex_default:"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0#\0\0\0#\0#\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\x001\0\0\0\0\0\0\0",lex_trans:"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\f\0\r\0\0\f\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\v\0\b\0\t\0\0\0\0\0$\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\n\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0%\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0'\0\0\0\0\0\0\0\0(\0\0\0\0\0\0\0\0\0\0\0\0\0 \0/\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0.\0\0\0\0\0\0\0\0\0\0-\0\0\0\0\0\0,\0\0\0\0\0\0\0\0\0\0\0\0\0\0+\0\0\0\0\0\0*\0\0)\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\"\0\0\03\0\0\x004\0\0\0\0\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\0\0\0\0\0\0\0\0\x002\0\0\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\0\0\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\0\0\0\0\0\0\0\0\0\0\0\0\02\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\0\0\0\0\0\0\0\0\x002\0\0\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",lex_check:"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\v\0\0!\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0!\0#\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0!\0#\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0$\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0%\0\0%\0\0%\0$\0\0\0\0\0\0\0%\0\0%\0\0%\0\0%\0\0%\0\0%\0!\0#\0\0\x000\00\00\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\00\00\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\x000\02\x002\x002\x002\x002\x002\x002\x002\x002\x002\0$\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\02\02\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\x002\00\0",lex_base_code:"",lex_backtrk_code:"",lex_default_code:"",lex_trans_code:"",lex_check_code:"",lex_code:""};function __ocaml_lex_read_double_quoted_string_rec(buf,lexbuf,___ocaml_lex_state){while(true){var __ocaml_lex_state=___ocaml_lex_state;var __ocaml_lex_state$1=Lexing.engine(__ocaml_lex_tables,__ocaml_lex_state,lexbuf);switch(__ocaml_lex_state$1){case 0:return Block.__(0,[$$Buffer.contents(buf)]);case 1:$$Buffer.add_char(buf,47);___ocaml_lex_state=18;continue;case 2:$$Buffer.add_char(buf,92);___ocaml_lex_state=18;continue;case 3:$$Buffer.add_char(buf,8);___ocaml_lex_state=18;continue;case 4:$$Buffer.add_char(buf,12);___ocaml_lex_state=18;continue;case 5:$$Buffer.add_char(buf,10);___ocaml_lex_state=18;continue;case 6:$$Buffer.add_char(buf,13);___ocaml_lex_state=18;continue;case 7:$$Buffer.add_char(buf,9);___ocaml_lex_state=18;continue;case 8:$$Buffer.add_char(buf,39);___ocaml_lex_state=18;continue;case 9:$$Buffer.add_char(buf,34);___ocaml_lex_state=18;continue;case 10:Lexing.new_line(lexbuf);$$Buffer.add_char(buf,10);___ocaml_lex_state=18;continue;case 11:$$Buffer.add_string(buf,Lexing.lexeme(lexbuf));___ocaml_lex_state=18;continue;case 12:return lexing_error(lexbuf,"Quoted string is missing the closing double quote");default:Curry._1(lexbuf.refill_buff,lexbuf);___ocaml_lex_state=__ocaml_lex_state$1;continue}}}function __ocaml_lex_read_identifier_rec(buf,lexbuf,___ocaml_lex_state){while(true){var __ocaml_lex_state=___ocaml_lex_state;var __ocaml_lex_state$1=Lexing.engine(__ocaml_lex_tables,__ocaml_lex_state,lexbuf);switch(__ocaml_lex_state$1){case 0:return Block.__(2,[$$Buffer.contents(buf)]);case 1:return lexing_error(lexbuf,"Unmatched left angle bracket");case 2:$$Buffer.add_string(buf,Lexing.lexeme(lexbuf));___ocaml_lex_state=48;continue;case 3:var bad_character=Lexing.sub_lexeme_char(lexbuf,lexbuf.lex_start_pos);var err=Curry._1(Printf.sprintf([Block.__(11,['Invalid character "',Block.__(0,[Block.__(11,['" inside a non-terminal symbol identifier. Did you forget to close a left angle bracket?',0])])]),'Invalid character "%c" inside a non-terminal symbol identifier. Did you forget to close a left angle bracket?']),bad_character);return lexing_error(lexbuf,err);default:Curry._1(lexbuf.refill_buff,lexbuf);___ocaml_lex_state=__ocaml_lex_state$1;continue}}}function __ocaml_lex_token_rec(lexbuf,___ocaml_lex_state){while(true){var __ocaml_lex_state=___ocaml_lex_state;var __ocaml_lex_state$1=Lexing.engine(__ocaml_lex_tables,__ocaml_lex_state,lexbuf);switch(__ocaml_lex_state$1){case 1:___ocaml_lex_state=0;continue;case 2:return 3;case 3:return 1;case 4:return __ocaml_lex_read_identifier_rec($$Buffer.create(16),lexbuf,48);case 5:return 0;case 6:var s=Lexing.sub_lexeme(lexbuf,lexbuf.lex_start_pos,lexbuf.lex_curr_pos);return lexing_error(lexbuf,Curry._2(Printf.sprintf([Block.__(11,["Symbol identifier '",Block.__(2,[0,Block.__(11,["' must be in angle brackets (<",Block.__(2,[0,Block.__(11,[">)",0])])])])]),"Symbol identifier '%s' must be in angle brackets (<%s>)"]),s,s));case 7:var i=Lexing.sub_lexeme(lexbuf,lexbuf.lex_start_pos,lexbuf.lex_curr_pos);return Block.__(1,[Caml_format.caml_int_of_string(i)]);case 8:return 2;case 9:return __ocaml_lex_read_single_quoted_string_rec($$Buffer.create(16),lexbuf,33);case 10:return __ocaml_lex_read_double_quoted_string_rec($$Buffer.create(16),lexbuf,18);case 0:case 11:Lexing.new_line(lexbuf);___ocaml_lex_state=0;continue;case 12:var bad_char=Lexing.sub_lexeme_char(lexbuf,lexbuf.lex_start_pos);return lexing_error(lexbuf,Curry._1(Printf.sprintf([Block.__(11,["unexpected character '",Block.__(0,[Block.__(12,[39,0])])]),"unexpected character '%c'"]),bad_char));default:Curry._1(lexbuf.refill_buff,lexbuf);___ocaml_lex_state=__ocaml_lex_state$1;continue}}}function __ocaml_lex_read_single_quoted_string_rec(buf,lexbuf,___ocaml_lex_state){while(true){var __ocaml_lex_state=___ocaml_lex_state;var __ocaml_lex_state$1=Lexing.engine(__ocaml_lex_tables,__ocaml_lex_state,lexbuf);switch(__ocaml_lex_state$1){case 0:return Block.__(0,[$$Buffer.contents(buf)]);case 1:$$Buffer.add_char(buf,47);___ocaml_lex_state=33;continue;case 2:$$Buffer.add_char(buf,92);___ocaml_lex_state=33;continue;case 3:$$Buffer.add_char(buf,8);___ocaml_lex_state=33;continue;case 4:$$Buffer.add_char(buf,12);___ocaml_lex_state=33;continue;case 5:$$Buffer.add_char(buf,10);___ocaml_lex_state=33;continue;case 6:$$Buffer.add_char(buf,13);___ocaml_lex_state=33;continue;case 7:$$Buffer.add_char(buf,9);___ocaml_lex_state=33;continue;case 8:$$Buffer.add_char(buf,39);___ocaml_lex_state=33;continue;case 9:$$Buffer.add_char(buf,34);___ocaml_lex_state=33;continue;case 10:Lexing.new_line(lexbuf);$$Buffer.add_char(buf,10);___ocaml_lex_state=33;continue;case 11:$$Buffer.add_string(buf,Lexing.lexeme(lexbuf));___ocaml_lex_state=33;continue;case 12:return lexing_error(lexbuf,"Quoted string is missing the closing single quote");default:Curry._1(lexbuf.refill_buff,lexbuf);___ocaml_lex_state=__ocaml_lex_state$1;continue}}}function token(lexbuf){return __ocaml_lex_token_rec(lexbuf,0)}function read_double_quoted_string(buf,lexbuf){return __ocaml_lex_read_double_quoted_string_rec(buf,lexbuf,18)}function read_single_quoted_string(buf,lexbuf){return __ocaml_lex_read_single_quoted_string_rec(buf,lexbuf,33)}function read_identifier(buf,lexbuf){return __ocaml_lex_read_identifier_rec(buf,lexbuf,48)}exports.lexing_error=lexing_error;exports.__ocaml_lex_tables=__ocaml_lex_tables;exports.token=token;exports.__ocaml_lex_token_rec=__ocaml_lex_token_rec;exports.read_double_quoted_string=read_double_quoted_string;exports.__ocaml_lex_read_double_quoted_string_rec=__ocaml_lex_read_double_quoted_string_rec;exports.read_single_quoted_string=read_single_quoted_string;exports.__ocaml_lex_read_single_quoted_string_rec=__ocaml_lex_read_single_quoted_string_rec;exports.read_identifier=read_identifier;exports.__ocaml_lex_read_identifier_rec=__ocaml_lex_read_identifier_rec},{"./util.bs.js":50,"bs-platform/lib/js/block.js":2,"bs-platform/lib/js/buffer.js":3,"bs-platform/lib/js/caml_format.js":10,"bs-platform/lib/js/curry.js":27,"bs-platform/lib/js/lexing.js":31,"bs-platform/lib/js/printf.js":37}],42:[function(require,module,exports){"use strict";var List=require("bs-platform/lib/js/list.js");var Block=require("bs-platform/lib/js/block.js");var Curry=require("bs-platform/lib/js/curry.js");var Grammar=require("./grammar.bs.js");var MenhirLib=require("./menhirLib.bs.js");var Caml_exceptions=require("bs-platform/lib/js/caml_exceptions.js");var $$Error=Caml_exceptions.create("Bnf_parser.MenhirBasics.Error");function token2terminal(_tok){if(typeof _tok==="number"){switch(_tok){case 0:return 2;case 1:return 3;case 2:return 6;case 3:return 7}}else{switch(_tok.tag|0){case 0:return 1;case 1:return 4;case 2:return 5}}}function token2value(_tok){if(typeof _tok==="number"){return 0}else{return _tok[0]}}var semantic_action=[function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next.next;var _v=List.rev(match.semv);return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;return{state:_menhir_stack.state,semv:_menhir_stack.semv,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _menhir_s=_menhir_env.current;var _startpos=_menhir_stack.endp;return{state:_menhir_s,semv:undefined,startp:_startpos,endp:_startpos,next:_menhir_stack}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v=_menhir_stack.semv;return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next.next;var _v_lhs=match.semv;var _v_rhs=Grammar.sort_rule_parts(_menhir_stack.semv);var _v={lhs:_v_lhs,rhs:_v_rhs};return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v_000=_menhir_stack.semv;var _v=[_v_000,0];return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next.next;var _v_000=_menhir_stack.semv;var _v_001=match.semv;var _v=[_v_000,_v_001];return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next;var _v_weight=match.semv;var _v_symbols=List.rev(_menhir_stack.semv);var _v={weight:_v_weight,symbols:_v_symbols};return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v_symbols=List.rev(_menhir_stack.semv);var _v={weight:1,symbols:_v_symbols};return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v_000=_menhir_stack.semv;var _v=[_v_000,0];return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next;var _v_000=_menhir_stack.semv;var _v_001=match.semv;var _v=[_v_000,_v_001];return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _menhir_s=_menhir_env.current;var _startpos=_menhir_stack.endp;return{state:_menhir_s,semv:0,startp:_startpos,endp:_startpos,next:_menhir_stack}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v_000=_menhir_stack.semv;var _v=[_v_000,0];return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var match=_menhir_stack.next.next;var _v_000=_menhir_stack.semv;var _v_001=match.semv;var _v=[_v_000,_v_001];return{state:match.state,semv:_v,startp:match.startp,endp:_menhir_stack.endp,next:match.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v=Block.__(0,[_menhir_stack.semv]);return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;var _v=Block.__(1,[_menhir_stack.semv]);return{state:_menhir_stack.state,semv:_v,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}},function(_menhir_env){var _menhir_stack=_menhir_env.stack;return{state:_menhir_stack.state,semv:_menhir_stack.semv,startp:_menhir_stack.startp,endp:_menhir_stack.endp,next:_menhir_stack.next}}];var ET=MenhirLib.TableInterpreter.MakeEngineTable({token2terminal:token2terminal,error_terminal:0,token2value:token2value,default_reduction:[8,"\0\0\0\0\0\0\v\0\f\0\0\0\b\0"],error:[8,'&\0"\0L\0D\0\0v\0\0v\x002L\0\0\0\0'],action:[[8,"\0 \0\0\0\0\0\0\n\0\0\0\0\0"],[8,'!!"!%%1%1FS\r']],lhs:[4,"\nfUD32!"],$$goto:[[8,"\0\r&\0\0\0$\0\0,\0\0,\0\0\n\0\0\0\0\0"],[8,"\n\v\n\v\0\0\0\n\v\0\f\n\r\0\0\0"]],start:1,semantic_action:semantic_action,$$Error:$$Error,trace:undefined});var TI=MenhirLib.Engine.Make(ET);var entry=TI.entry;var start=TI.start;function grammar(lexer,lexbuf){return Curry._3(entry,0,lexer,lexbuf)}function grammar$1(initial_position){return Curry._2(start,0,initial_position)}var Incremental={grammar:grammar$1};var MenhirInterpreter_offer=TI.offer;var MenhirInterpreter_resume=TI.resume;var MenhirInterpreter_lexer_lexbuf_to_supplier=TI.lexer_lexbuf_to_supplier;var MenhirInterpreter_loop=TI.loop;var MenhirInterpreter_loop_handle=TI.loop_handle;var MenhirInterpreter_loop_handle_undo=TI.loop_handle_undo;var MenhirInterpreter_shifts=TI.shifts;var MenhirInterpreter_acceptable=TI.acceptable;var MenhirInterpreter_number=TI.number;var MenhirInterpreter_production_index=TI.production_index;var MenhirInterpreter_find_production=TI.find_production;var MenhirInterpreter_stack=TI.stack;var MenhirInterpreter_top=TI.top;var MenhirInterpreter_pop_many=TI.pop_many;var MenhirInterpreter_get=TI.get;var MenhirInterpreter_current_state_number=TI.current_state_number;var MenhirInterpreter_equal=TI.equal;var MenhirInterpreter_positions=TI.positions;var MenhirInterpreter_env_has_default_reduction=TI.env_has_default_reduction;var MenhirInterpreter_state_has_default_reduction=TI.state_has_default_reduction;var MenhirInterpreter_pop=TI.pop;var MenhirInterpreter_force_reduction=TI.force_reduction;var MenhirInterpreter_input_needed=TI.input_needed;var MenhirInterpreter={offer:MenhirInterpreter_offer,resume:MenhirInterpreter_resume,lexer_lexbuf_to_supplier:MenhirInterpreter_lexer_lexbuf_to_supplier,loop:MenhirInterpreter_loop,loop_handle:MenhirInterpreter_loop_handle,loop_handle_undo:MenhirInterpreter_loop_handle_undo,shifts:MenhirInterpreter_shifts,acceptable:MenhirInterpreter_acceptable,number:MenhirInterpreter_number,production_index:MenhirInterpreter_production_index,find_production:MenhirInterpreter_find_production,stack:MenhirInterpreter_stack,top:MenhirInterpreter_top,pop_many:MenhirInterpreter_pop_many,get:MenhirInterpreter_get,current_state_number:MenhirInterpreter_current_state_number,equal:MenhirInterpreter_equal,positions:MenhirInterpreter_positions,env_has_default_reduction:MenhirInterpreter_env_has_default_reduction,state_has_default_reduction:MenhirInterpreter_state_has_default_reduction,pop:MenhirInterpreter_pop,force_reduction:MenhirInterpreter_force_reduction,input_needed:MenhirInterpreter_input_needed};exports.$$Error=$$Error;exports.grammar=grammar;exports.MenhirInterpreter=MenhirInterpreter;exports.Incremental=Incremental},{"./grammar.bs.js":47,"./menhirLib.bs.js":48,"bs-platform/lib/js/block.js":2,"bs-platform/lib/js/caml_exceptions.js":8,"bs-platform/lib/js/curry.js":27,"bs-platform/lib/js/list.js":32}],43:[function(require,module,exports){"use strict";var Caml_builtin_exceptions=require("bs-platform/lib/js/caml_builtin_exceptions.js");function message(s){switch(s){case 0:return"Invalid syntax.\n";case 3:return'Left-hand side of a rule must be a single non-terminal symbol.\nIn your rule, a symbol identifier is preceded by a string or the left-hand side is empty.\nThe most likely reason is a misplaced semicolon in a previous rule.\nExample of a valid rule: <start> ::= "foo" ;\n';case 5:return'Left-hand side of a rule must be a single symbol identifier followed by "::=".\nIn your rule, a symbol identifier is followed by a string or the right-hand side is empty.\nExample of a valid rule: <foo> ::= "foo" ;\n';case 6:return'The right-hand side of a rule is empty or starts with an empty alternative.\nEmpty rules (<foo> ::= ;) and empty alternatives (<foo> ::= | "foo") are not allowed.\nExample of a valid rule: <start> ::= <foo> | <bar> ;\n';case 8:return"Weight number must be followed by a symbol identifier or a string.\nExample of a valid rule: <start> ::= 10 <foo> | <bar> ;\n";case 11:return'Unterminated rule (missing semicolon or vertical line?)\nExample of a valid rule: <start> ::= 10 <foo> | 5 <bar> | "baz" ;\n';case 14:return'Invalid rule or a missing semicolon between rules.\nExample of a valid rule sequence: <start> ::= 10 <foo> | 5 <bar>; <quux> ::= "baz";\n';case 1:case 2:case 4:case 7:case 9:case 10:case 12:case 13:case 15:case 16:throw Caml_builtin_exceptions.not_found;case 17:return'Empty alternative in a right hand side.\nEmpty alternatives such as "<foo> | | <bar>") are not allowed.\nExample of a valid rule: <start> ::= <foo> | <bar> ;\n';default:throw Caml_builtin_exceptions.not_found}}exports.message=message},{"bs-platform/lib/js/caml_builtin_exceptions.js":6}],44:[function(require,module,exports){"use strict";var Bnfgenlib=require("./bnfgenlib.bs.js");var Pervasives=require("bs-platform/lib/js/pervasives.js");var Caml_option=require("bs-platform/lib/js/caml_option.js");function load_grammar(s){var res=Bnfgenlib.load_from_string(s);if(res.tag){return Pervasives.failwith(res[0])}else{return res[0]}}function generate(grammar,start_symbol,separator){var res=Bnfgenlib.generate(Caml_option.some(undefined),start_symbol,separator,grammar);if(res.tag){return Pervasives.failwith(res[0])}else{return res[0]}}exports.load_grammar=load_grammar;exports.generate=generate},{"./bnfgenlib.bs.js":46,"bs-platform/lib/js/caml_option.js":18,"bs-platform/lib/js/pervasives.js":36}],45:[function(require,module,exports){var bnfgen=require("./bnfgen.bs.js");window.bnfgen=Object();window.bnfgen.generate=bnfgen.generate;window.bnfgen.loadGrammar=bnfgen.load_grammar},{"./bnfgen.bs.js":44}],46:[function(require,module,exports){"use strict";var Util=require("./util.bs.js");var Block=require("bs-platform/lib/js/block.js");var Curry=require("bs-platform/lib/js/curry.js");var Lexing=require("bs-platform/lib/js/lexing.js");var Printf=require("bs-platform/lib/js/printf.js");var Grammar=require("./grammar.bs.js");var Parse_bnf=require("./parse_bnf.bs.js");var Bnf_parser=require("./bnf_parser.bs.js");var Pervasives=require("bs-platform/lib/js/pervasives.js");var Caml_js_exceptions=require("bs-platform/lib/js/caml_js_exceptions.js");function $great$great$eq(r,f){if(r.tag){return r}else{return Curry._1(f,r[0])}}function parse(lexbuf){try{return Block.__(0,[Parse_bnf.parse(lexbuf,Bnf_parser.Incremental.grammar(lexbuf.lex_curr_p))])}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Util.Syntax_error){var match=exn[1];var err=match[1];var pos=match[0];if(pos!==undefined){var match$1=pos;return Block.__(1,[Curry._3(Printf.sprintf([Block.__(11,["Syntax error on line ",Block.__(4,[0,0,0,Block.__(11,[", character ",Block.__(4,[0,0,0,Block.__(11,[": ",Block.__(2,[0,0])])])])])]),"Syntax error on line %d, character %d: %s"]),match$1[0],match$1[1],err)])}else{return Block.__(1,[Curry._1(Printf.sprintf([Block.__(11,["Syntax error: ",Block.__(2,[0,0])]),"Syntax error: %s"]),err)])}}else{throw exn}}}function load_from_channel(ic){var lexbuf=Lexing.from_channel(ic);return $great$great$eq(parse(lexbuf),Grammar.check_grammar)}function load_from_file(filename){return load_from_channel(Pervasives.open_in(filename))}function load_from_string(s){var lexbuf=Lexing.from_string(s);return $great$great$eq(parse(lexbuf),Grammar.check_grammar)}var dump_rules=Grammar.string_of_rules;var generate=Grammar.reduce;exports.load_from_string=load_from_string;exports.load_from_channel=load_from_channel;exports.load_from_file=load_from_file;exports.dump_rules=dump_rules;exports.generate=generate},{"./bnf_parser.bs.js":42,"./grammar.bs.js":47,"./parse_bnf.bs.js":49,"./util.bs.js":50,"bs-platform/lib/js/block.js":2,"bs-platform/lib/js/caml_js_exceptions.js":14,"bs-platform/lib/js/curry.js":27,"bs-platform/lib/js/lexing.js":31,"bs-platform/lib/js/pervasives.js":36,"bs-platform/lib/js/printf.js":37}],47:[function(require,module,exports){"use strict";var List=require("bs-platform/lib/js/list.js");var Block=require("bs-platform/lib/js/block.js");var Curry=require("bs-platform/lib/js/curry.js");var Printf=require("bs-platform/lib/js/printf.js");var Random=require("bs-platform/lib/js/random.js");var $$String=require("bs-platform/lib/js/string.js");var Caml_obj=require("bs-platform/lib/js/caml_obj.js");var Pervasives=require("bs-platform/lib/js/pervasives.js");var Caml_option=require("bs-platform/lib/js/caml_option.js");var Caml_primitive=require("bs-platform/lib/js/caml_primitive.js");var Caml_exceptions=require("bs-platform/lib/js/caml_exceptions.js");var Caml_js_exceptions=require("bs-platform/lib/js/caml_js_exceptions.js");var Caml_builtin_exceptions=require("bs-platform/lib/js/caml_builtin_exceptions.js");var Reduction_error=Caml_exceptions.create("Grammar.Reduction_error");function string_of_symbol(s){if(s.tag){return Curry._1(Printf.sprintf([Block.__(12,[60,Block.__(2,[0,Block.__(12,[62,0])])]),"<%s>"]),s[0])}else{return Curry._1(Printf.sprintf([Block.__(12,[34,Block.__(2,[0,Block.__(12,[34,0])])]),'"%s"']),s[0])}}function string_of_rule_rhs_part(r){var l=List.map(string_of_symbol,r.symbols);var sym_str=$$String.concat(" ",l);var weight_str=r.weight===1?"":String(r.weight);return $$String.concat(" ",[weight_str,[sym_str,0]])}function string_of_rule_rhs(r){if(r){var tl=r[1];var hd=r[0];if(tl){return Curry._2(Printf.sprintf([Block.__(2,[0,Block.__(11,[" | ",Block.__(2,[0,0])])]),"%s | %s"]),string_of_rule_rhs_part(hd),string_of_rule_rhs(tl))}else{return string_of_rule_rhs_part(hd)}}else{return""}}function string_of_rule(r){return Curry._2(Printf.sprintf([Block.__(2,[0,Block.__(11,[" ::= ",Block.__(2,[0,Block.__(12,[59,0])])])]),"%s ::= %s;"]),string_of_symbol(Block.__(1,[r.lhs])),string_of_rule_rhs(r.rhs))}function string_of_rules(r){var rule_str_list=List.map(string_of_rule,r);return $$String.concat("\n",rule_str_list)}function check_for_nonexistent(rs){var get_referenced_nonterminals=function(r){var symbols=List.concat(List.map(function(r){return r.symbols},r.rhs));return List.fold_left(function(ss,s){if(s.tag){return[s[0],ss]}else{return ss}},0,symbols)};var _rs=rs;var known_symbols=List.map(function(r){return r.lhs},rs);while(true){var rs$1=_rs;if(rs$1){var nts=get_referenced_nonterminals(rs$1[0]);List.iter(function(param){var known_symbols$1=known_symbols;var s=param;try{List.find(function(param){return s===param},known_symbols$1);return 0}catch(exn){return Pervasives.failwith(Curry._1(Printf.sprintf([Block.__(11,["Undefined symbol <",Block.__(2,[0,Block.__(12,[62,0])])]),"Undefined symbol <%s>"]),s))}},nts);_rs=rs$1[1];continue}else{return 0}}}function check_for_duplicates(_rs){while(true){var rs=_rs;var sort_rules=function(rs){return List.sort(function(x,y){return Caml_primitive.caml_string_compare(x.lhs,y.lhs)},rs)};var rs$1=sort_rules(rs);if(rs$1){var match=rs$1[1];if(match){var r$prime=match[0];var r=rs$1[0];if(r.lhs===r$prime.lhs){return Pervasives.failwith(Curry._1(Printf.sprintf([Block.__(11,["Duplicate definition of symbol <",Block.__(2,[0,Block.__(12,[62,0])])]),"Duplicate definition of symbol <%s>"]),r.lhs))}else{_rs=[r$prime,match[1]];continue}}else{return 0}}else{return 0}}}function check_grammar(rs){try{check_for_duplicates(rs);check_for_nonexistent(rs);return Block.__(0,[rs])}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Caml_builtin_exceptions.failure){return Block.__(1,[exn[1]])}else{throw exn}}}function total_weight(l){return List.fold_left(function(x,y){return x+y.weight|0},0,l)}function pick_element(l){var tw=total_weight(l);var r=Random.$$int(tw);var _acc=0;var r$1=r;var _l=l;while(true){var l$1=_l;var acc=_acc;if(l$1){var tl=l$1[1];var x=l$1[0];if(tl){var acc$prime=acc+x.weight|0;if(r$1<acc$prime){return x.symbols}else{_l=tl;_acc=acc$prime;continue}}else{return x.symbols}}else{return Pervasives.failwith("Rule with empty right-hand side")}}}function find_production(name,grammar){try{var rule=List.find(function(x){return x.lhs===name},grammar);return rule.rhs}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return}else{throw exn}}}function sort_rule_parts(l){return List.sort(function(x,y){return Caml_primitive.caml_int_compare(x.weight,y.weight)},l)}function depth_exceeded(maxdepth,depth){if(maxdepth!==undefined){return Caml_obj.caml_greaterthan(depth,Caml_option.valFromOption(maxdepth))}else{return false}}function reduce_rhs(rhs,grammar,delimiter,maxdepth,depth){if(rhs){var tl=rhs[1];var hd=rhs[0];if(hd.tag){var l=reduce_symbol(hd[0],grammar,delimiter,maxdepth,depth+1|0);var r=reduce_rhs(tl,grammar,delimiter,maxdepth,depth);return Curry._2(Printf.sprintf([Block.__(2,[0,Block.__(2,[0,0])]),"%s%s"]),l,r)}else{return Curry._3(Printf.sprintf([Block.__(2,[0,Block.__(2,[0,Block.__(2,[0,0])])]),"%s%s%s"]),hd[0],delimiter,reduce_rhs(tl,grammar,delimiter,maxdepth,depth))}}else{return""}}function reduce_symbol(name,grammar,delimiter,maxdepth,depth){var r=find_production(name,grammar);if(r!==undefined){if(depth_exceeded(maxdepth,depth)){throw[Reduction_error,"Maximum recursion depth exceeded"]}var symbols=pick_element(r);return reduce_rhs(symbols,grammar,delimiter,maxdepth,depth)}else{throw[Reduction_error,Curry._1(Printf.sprintf([Block.__(11,["Undefined symbol <",Block.__(2,[0,Block.__(12,[62,0])])]),"Undefined symbol <%s>"]),name)]}}function reduce($staropt$star,$staropt$star$1,$staropt$star$2,grammar){
var max_depth=$staropt$star!==undefined?Caml_option.valFromOption($staropt$star):undefined;var start_symbol=$staropt$star$1!==undefined?$staropt$star$1:"start";var separator=$staropt$star$2!==undefined?$staropt$star$2:"";try{return Block.__(0,[reduce_symbol(start_symbol,grammar,separator,max_depth,0)])}catch(raw_exn){var exn=Caml_js_exceptions.internalToOCamlException(raw_exn);if(exn[0]===Reduction_error){return Block.__(1,[exn[1]])}else{throw exn}}}exports.string_of_rules=string_of_rules;exports.sort_rule_parts=sort_rule_parts;exports.check_grammar=check_grammar;exports.reduce=reduce},{"bs-platform/lib/js/block.js":2,"bs-platform/lib/js/caml_builtin_exceptions.js":6,"bs-platform/lib/js/caml_exceptions.js":8,"bs-platform/lib/js/caml_js_exceptions.js":14,"bs-platform/lib/js/caml_obj.js":17,"bs-platform/lib/js/caml_option.js":18,"bs-platform/lib/js/caml_primitive.js":19,"bs-platform/lib/js/curry.js":27,"bs-platform/lib/js/list.js":32,"bs-platform/lib/js/pervasives.js":36,"bs-platform/lib/js/printf.js":37,"bs-platform/lib/js/random.js":38,"bs-platform/lib/js/string.js":39}],48:[function(require,module,exports){"use strict";var Sys=require("bs-platform/lib/js/sys.js");var Char=require("bs-platform/lib/js/char.js");var List=require("bs-platform/lib/js/list.js");var $$Array=require("bs-platform/lib/js/array.js");var Block=require("bs-platform/lib/js/block.js");var Bytes=require("bs-platform/lib/js/bytes.js");var Curry=require("bs-platform/lib/js/curry.js");var Lexing=require("bs-platform/lib/js/lexing.js");var Printf=require("bs-platform/lib/js/printf.js");var Caml_obj=require("bs-platform/lib/js/caml_obj.js");var Caml_array=require("bs-platform/lib/js/caml_array.js");var Caml_bytes=require("bs-platform/lib/js/caml_bytes.js");var Caml_int32=require("bs-platform/lib/js/caml_int32.js");var Pervasives=require("bs-platform/lib/js/pervasives.js");var Caml_option=require("bs-platform/lib/js/caml_option.js");var Caml_primitive=require("bs-platform/lib/js/caml_primitive.js");var CamlinternalLazy=require("bs-platform/lib/js/camlinternalLazy.js");var Caml_builtin_exceptions=require("bs-platform/lib/js/caml_builtin_exceptions.js");function take(n,xs){if(n!==0&&xs){var xs$1=xs[1];var xs$prime=take(n-1|0,xs$1);if(xs$1===xs$prime){return xs}else{return[xs[0],xs$prime]}}else{return 0}}function drop(_n,_xs){while(true){var xs=_xs;var n=_n;if(n!==0){if(xs){_xs=xs[1];_n=n-1|0;continue}else{return 0}}else{return xs}}}function uniq1(_cmp,x,_ys){while(true){var ys=_ys;var cmp=_cmp;if(ys){var ys$1=ys[1];var y=ys[0];if(Curry._2(cmp,x,y)===0){_ys=ys$1;_cmp=Caml_obj.caml_compare;continue}else{return[y,uniq1(cmp,y,ys$1)]}}else{return 0}}}function uniq(cmp,xs){if(xs){var x=xs[0];return[x,uniq1(cmp,x,xs[1])]}else{return 0}}function weed(cmp,xs){return uniq(cmp,List.sort(cmp,xs))}function length(xs){var match=CamlinternalLazy.force(xs);if(match){return 1+length(match[1])|0}else{return 0}}function foldr(f,xs,accu){var match=CamlinternalLazy.force(xs);if(match){return Curry._2(f,match[0],foldr(f,match[1],accu))}else{return accu}}function traditional2revised(get_raw_token,get_startp,get_endp,parser,lexer){var lexbuf=Lexing.from_string("");var lexer$1=function(lexbuf){var token=Curry._1(lexer,0);lexbuf.lex_start_p=Curry._1(get_startp,token);lexbuf.lex_curr_p=Curry._1(get_endp,token);return Curry._1(get_raw_token,token)};return Curry._2(parser,lexer$1,lexbuf)}function revised2traditional(make_token,parser,lexer,lexbuf){return Curry._1(parser,function(param){var token=Curry._1(lexer,lexbuf);return Curry._3(make_token,token,lexbuf.lex_start_p,lexbuf.lex_curr_p)})}function traditional2revised$1(parser){return function(param){return traditional2revised(function(param){return param[0]},function(param){return param[1]},function(param){return param[2]},parser,param)}}function revised2traditional$1(parser){return function(param,param$1){return revised2traditional(function(token,startp,endp){return[token,startp,endp]},parser,param,param$1)}}var Simplified={traditional2revised:traditional2revised$1,revised2traditional:revised2traditional$1};var Convert={traditional2revised:traditional2revised,revised2traditional:revised2traditional,Simplified:Simplified};var IncrementalEngine={};var EngineTypes={};function Make(T){var number=T.number;var $$Error=T.$$Error;var log=T.log;var Log=T.Log;var run=function(env,please_discard){if(log){Curry._1(Log.state,env.current)}if(please_discard){return Block.__(0,[env])}else{return check_for_default_reduction(env)}};var initiate=function(env){if(log){Curry._1(Log.initiating_error_handling,0)}var env_triple=env.triple;var env_stack=env.stack;var env_current=env.current;var env$1={error:true,triple:env_triple,stack:env_stack,current:env_current};return Block.__(3,[env$1])};var accept=function(env,prod){if(log){Curry._1(Log.reduce_or_accept,prod)}var v=env.stack.semv;return Block.__(4,[v])};var shift=function(env,please_discard,terminal,value,s$prime){if(log){Curry._2(Log.shift,terminal,s$prime)}var match=env.triple;var stack_state=env.current;var stack_startp=match[1];var stack_endp=match[2];var stack_next=env.stack;var stack={state:stack_state,semv:value,startp:stack_startp,endp:stack_endp,next:stack_next};var new_env_error=env.error;var new_env_triple=env.triple;var new_env={error:new_env_error,triple:new_env_triple,stack:stack,current:s$prime};return Block.__(1,[env,new_env,please_discard])};var announce_reduce=function(env,prod){if(Curry._1(T.is_start,prod)){return accept(env,prod)}else{return Block.__(2,[env,prod])}};var check_for_default_reduction=function(env){return Curry._4(T.default_reduction,env.current,announce_reduce,check_for_error_token,env)};var reduce=function(env,prod){if(log){Curry._1(Log.reduce_or_accept,prod)}var stack;try{stack=Curry._2(T.semantic_action,prod,env)}catch(exn){if(exn===$$Error){return initiate(env)}else{throw exn}}var current=Curry._2(T.goto_prod,stack.state,prod);var env_error=env.error;var env_triple=env.triple;var env$1={error:env_error,triple:env_triple,stack:stack,current:current};return run(env$1,false)};var check_for_error_token=function(env){if(env.error){if(log){Curry._1(Log.resuming_error_handling,0)}return Block.__(3,[env])}else{var match=env.triple;var token=match[0];return Curry._7(T.action,env.current,Curry._1(T.token2terminal,token),Curry._1(T.token2value,token),shift,announce_reduce,initiate,env)}};var error_fail=function(env){var cell=env.stack;var next=cell.next;if(next===cell){return 0}else{var env_error=env.error;var env_triple=env.triple;var env_current=cell.state;var env$1={error:env_error,triple:env_triple,stack:next,current:env_current};return Block.__(3,[env$1])}};var error_reduce=function(env,prod){if(log){Curry._1(Log.handling_error,env.current)}return reduce(env,prod)};var error_shift=function(env,please_discard,terminal,value,s$prime){if(!(Caml_obj.caml_equal(terminal,T.error_terminal)&&Caml_obj.caml_equal(value,T.error_value))){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1397,4]]}if(log){Curry._1(Log.handling_error,env.current)}return shift(env,please_discard,terminal,value,s$prime)};var discard=function(env,triple){if(log){Curry._3(Log.lookahead_token,Curry._1(T.token2terminal,triple[0]),triple[1],triple[2])}return check_for_default_reduction({error:false,triple:triple,stack:env.stack,current:env.current})};var error=function(env){if(!env.error){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1378,4]]}return Curry._7(T.action,env.current,T.error_terminal,T.error_value,error_shift,error_reduce,error_fail,env)};var start=function(s,initial){var empty={};Caml_obj.caml_update_dummy(empty,{state:s,semv:T.error_value,startp:initial,endp:initial,next:empty});var env_triple=[0,initial,initial];var env={error:false,triple:env_triple,stack:empty,current:s};return run(env,true)};var offer=function(param){if(typeof param==="number"||param.tag){return Pervasives.invalid_arg("offer expects InputNeeded")}else{var partial_arg=param[0];return function(param){return discard(partial_arg,param)}}};var resume=function(param){if(typeof param==="number"){return Pervasives.invalid_arg("resume expects HandlingError | Shifting | AboutToReduce")}else{switch(param.tag|0){case 1:return run(param[1],param[2]);case 2:return reduce(param[0],param[1]);case 3:return error(param[0]);default:return Pervasives.invalid_arg("resume expects HandlingError | Shifting | AboutToReduce")}}};var lexer_lexbuf_to_supplier=function(lexer,lexbuf,param){var token=Curry._1(lexer,lexbuf);var startp=lexbuf.lex_start_p;var endp=lexbuf.lex_curr_p;return[token,startp,endp]};var loop=function(read,_checkpoint){while(true){var checkpoint=_checkpoint;if(typeof checkpoint==="number"){throw $$Error}else{switch(checkpoint.tag|0){case 0:var triple=Curry._1(read,0);var checkpoint$1=offer(checkpoint)(triple);_checkpoint=checkpoint$1;continue;case 4:return checkpoint[0];default:var checkpoint$2=resume(checkpoint);_checkpoint=checkpoint$2;continue}}}};var entry=function(s,lexer,lexbuf){var initial=lexbuf.lex_curr_p;return loop(function(param){return lexer_lexbuf_to_supplier(lexer,lexbuf,param)},start(s,initial))};var loop_handle=function(succeed,fail,read,_checkpoint){while(true){var checkpoint=_checkpoint;if(typeof checkpoint==="number"){return Curry._1(fail,checkpoint)}else{switch(checkpoint.tag|0){case 0:var triple=Curry._1(read,0);var checkpoint$1=offer(checkpoint)(triple);_checkpoint=checkpoint$1;continue;case 1:case 2:break;case 3:return Curry._1(fail,checkpoint);case 4:return Curry._1(succeed,checkpoint[0])}}var checkpoint$2=resume(checkpoint);_checkpoint=checkpoint$2;continue}};var loop_handle_undo=function(succeed,fail,read,checkpoint){var tmp;tmp=typeof checkpoint==="number"||checkpoint.tag?false:true;if(!tmp){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1670,4]]}var succeed$1=succeed;var fail$1=fail;var read$1=read;var _param=[checkpoint,checkpoint];while(true){var param=_param;var checkpoint$1=param[1];var inputneeded=param[0];if(typeof checkpoint$1==="number"){return Curry._2(fail$1,inputneeded,checkpoint$1)}else{switch(checkpoint$1.tag|0){case 0:var triple=Curry._1(read$1,0);var checkpoint$2=offer(checkpoint$1)(triple);_param=[checkpoint$1,checkpoint$2];continue;case 1:case 2:break;case 3:return Curry._2(fail$1,inputneeded,checkpoint$1);case 4:return Curry._1(succeed$1,checkpoint$1[0])}}var checkpoint$3=resume(checkpoint$1);_param=[inputneeded,checkpoint$3];continue}};var shifts=function(_checkpoint){while(true){var checkpoint=_checkpoint;if(typeof checkpoint==="number"){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1695,8]]}else{switch(checkpoint.tag|0){case 1:return checkpoint[0];case 2:_checkpoint=resume(checkpoint);continue;case 3:return;default:throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1695,8]]}}}};var acceptable=function(checkpoint,token,pos){var triple=[token,pos,pos];var checkpoint$1=offer(checkpoint)(triple);return shifts(checkpoint$1)!==undefined};var stack=function(cell,current){return Caml_obj.caml_lazy_make(function(param){var next=cell.next;if(next===cell){return 0}else{var element_001=cell.semv;var element_002=cell.startp;var element_003=cell.endp;var element=[current,element_001,element_002,element_003];return[element,stack(next,cell.state)]}})};var stack$1=function(env){return stack(env.stack,env.current)};var top=function(env){var cell=env.stack;var next=cell.next;if(next===cell){return}else{return[env.current,cell.semv,cell.startp,cell.endp]}};var equal=function(env1,env2){if(env1.stack===env2.stack){return Curry._1(number,env1.current)===Curry._1(number,env2.current)}else{return false}};var current_state_number=function(env){return Curry._1(number,env.current)};var positions=function(param){var match=param.triple;return[match[1],match[2]]};var state_has_default_reduction=function(state){return Curry._4(T.default_reduction,state,function(_env,_prod){return true},function(_env){return false},0)};var env_has_default_reduction=function(env){return state_has_default_reduction(env.current)};var pop=function(env){var cell=env.stack;var next=cell.next;if(next===cell){return}else{return{error:env.error,triple:env.triple,stack:next,current:cell.state}}};var force_reduction=function(prod,env){if(Curry._2(T.may_reduce,env.current,prod)){if(Curry._1(T.is_start,prod)){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1883,6]]}var stack=Curry._2(T.semantic_action,prod,env);var current=Curry._2(T.goto_prod,stack.state,prod);return{error:env.error,triple:env.triple,stack:stack,current:current}}else{return Pervasives.invalid_arg("force_reduction: this reduction is not permitted in this state")}};var input_needed=function(env){return Block.__(0,[env])};var pop_many=function(_i,_env){while(true){var env=_env;var i=_i;if(i===0){return env}else{var match=pop(env);if(match!==undefined){_env=match;_i=i-1|0;continue}else{return}}}};var get=function(i,env){var match=pop_many(i,env);if(match!==undefined){return top(match)}};return{number:number,token2terminal:T.token2terminal,token2value:T.token2value,error_terminal:T.error_terminal,error_value:T.error_value,foreach_terminal:T.foreach_terminal,production_index:T.production_index,find_production:T.find_production,default_reduction:T.default_reduction,action:T.action,goto_nt:T.goto_nt,goto_prod:T.goto_prod,maybe_goto_nt:T.maybe_goto_nt,is_start:T.is_start,$$Error:$$Error,semantic_action:T.semantic_action,may_reduce:T.may_reduce,log:log,Log:Log,run:run,discard:discard,check_for_default_reduction:check_for_default_reduction,check_for_error_token:check_for_error_token,shift:shift,announce_reduce:announce_reduce,reduce:reduce,accept:accept,initiate:initiate,error:error,error_shift:error_shift,error_reduce:error_reduce,error_fail:error_fail,start:start,offer:offer,resume:resume,lexer_lexbuf_to_supplier:lexer_lexbuf_to_supplier,loop:loop,entry:entry,loop_handle:loop_handle,loop_handle_undo:loop_handle_undo,shifts:shifts,acceptable:acceptable,stack:stack$1,top:top,equal:equal,current_state_number:current_state_number,positions:positions,state_has_default_reduction:state_has_default_reduction,env_has_default_reduction:env_has_default_reduction,pop:pop,force_reduction:force_reduction,input_needed:input_needed,pop_many:pop_many,get:get}}function update(buffer,x){var match=buffer.contents;var tmp;tmp=typeof match==="number"?Block.__(0,[x]):match.tag?Block.__(1,[match[1],x]):Block.__(1,[match[0],x]);buffer.contents=tmp;return 0}function show(f,buffer){var match=buffer.contents;if(typeof match==="number"){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1976,6]]}else if(match.tag){return Curry._2(Printf.sprintf([Block.__(11,["after '",Block.__(2,[0,Block.__(11,["' and before '",Block.__(2,[0,Block.__(12,[39,0])])])])]),"after '%s' and before '%s'"]),Curry._1(f,match[0]),Curry._1(f,match[1]))}else{return Curry._1(Printf.sprintf([Block.__(11,["before '",Block.__(2,[0,Block.__(12,[39,0])])]),"before '%s'"]),Curry._1(f,match[0]))}}function last(buffer){var match=buffer.contents;if(typeof match==="number"){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",1992,6]]}else if(match.tag){return match[1]}else{return match[0]}}function wrap(lexer){var buffer={contents:0};return[buffer,function(lexbuf){var token=Curry._1(lexer,lexbuf);update(buffer,[lexbuf.lex_start_p,lexbuf.lex_curr_p]);return token}]}function Make$1(I,User){var arrow=" -> ";var dot=".";var space=" ";var newline="\n";var print_symbols=function(_i,_symbols){while(true){var symbols=_symbols;var i=_i;if(i===0){Curry._1(User.print,dot);Curry._1(User.print,space);_i=-1;continue}else if(symbols){Curry._1(User.print_symbol,symbols[0]);Curry._1(User.print,space);_symbols=symbols[1];_i=i-1|0;continue}else{return 0}}};var print_element_as_symbol=function(element){return Curry._1(User.print_symbol,[Curry._1(I.incoming_symbol,element[0])])};var match=User.print_element;var print_element=match!==undefined?match:print_element_as_symbol;var print_stack=function(env){var match=Curry._1(I.top,env);var match$1=Curry._1(I.pop,env);if(match!==undefined&&match$1!==undefined){print_stack(Caml_option.valFromOption(match$1));Curry._1(User.print,space);return Curry._1(print_element,match)}else{return 0}};var print_stack$1=function(env){print_stack(env);return Curry._1(User.print,newline)};var print_item=function(param){var prod=param[0];Curry._1(User.print_symbol,Curry._1(I.lhs,prod));Curry._1(User.print,arrow);print_symbols(param[1],Curry._1(I.rhs,prod));return Curry._1(User.print,newline)};var print_symbols$1=function(symbols){return print_symbols(-1,symbols)};var print_production=function(prod){return print_item([prod,-1])};var print_current_state=function(env){Curry._1(User.print,"Current LR(1) state: ");var match=Curry._1(I.top,env);if(match!==undefined){var current=match[0];Curry._1(User.print,String(Curry._1(I.number,current)));Curry._1(User.print,newline);return List.iter(print_item,Curry._1(I.items,current))}else{Curry._1(User.print,"<some initial state>");return Curry._1(User.print,newline)}};var print_env=function(env){print_stack(env);Curry._1(User.print,newline);print_current_state(env);return Curry._1(User.print,newline)};return{arrow:arrow,dot:dot,space:space,newline:newline,print_element_as_symbol:print_element_as_symbol,print_element:print_element,print_stack:print_stack$1,print_item:print_item,print_symbols:print_symbols$1,print_production:print_production,print_current_state:print_current_state,print_env:print_env}}function make(x){return{default:x,table:Caml_array.caml_make_vect(16384,x),extent:0}}function new_length(_length,i){while(true){var length=_length;if(i<length){return length}else{_length=length<<1;continue}}}function ensure(a,i){if(0>i){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2173,2]]}var table=a.table;var length=table.length;if(i>=length){var table$prime=Caml_array.caml_make_vect(new_length(length<<1,i),a.default);$$Array.blit(table,0,table$prime,0,length);a.table=table$prime;return 0}else{return 0}}function get(a,i){ensure(a,i);return a.table[i]}function set(a,i,x){ensure(a,i);a.table[i]=x;if(a.extent<=i){a.extent=i+1|0;return 0}else{return 0}}function extent(a){return a.extent}function domain(a){return $$Array.sub(a.table,0,a.extent)}function magnitude(v){if(v<0){return Sys.word_size}else{var _k=1;var _max=2;while(true){var max=_max;var k=_k;if(max<=0||v<max){return k}else{_max=Caml_int32.imul(max,max);_k=k<<1;continue}}}}function pack(a){var m=a.length;var k=$$Array.fold_left(function(k,v){return Caml_primitive.caml_int_max(k,magnitude(v))},1,a);if(k<=8){if(Caml_int32.mod_(8,k)!==0){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2276,4]]}var w=Caml_int32.div(8,k);var n=Caml_int32.mod_(m,w)===0?Caml_int32.div(m,w):Caml_int32.div(m,w)+1|0;var s=Caml_bytes.caml_create_bytes(n);var i={contents:0};var next=function(param){var ii=i.contents;if(ii===m){return 0}else{var v=Caml_array.caml_array_get(a,ii);i.contents=ii+1|0;return v}};for(var j=0,j_finish=n-1|0;j<=j_finish;++j){var c=0;for(var _x=1;_x<=w;++_x){c=c<<k|next(0)}s[j]=Char.chr(c)}return[k,Bytes.unsafe_to_string(s)]}else{if(k%8!==0){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2325,4]]}var w$1=k/8|0;var n$1=Caml_int32.imul(m,w$1);var s$1=Caml_bytes.caml_create_bytes(n$1);for(var i$1=0,i_finish=m-1|0;i$1<=i_finish;++i$1){var v=Caml_array.caml_array_get(a,i$1);for(var x=1;x<=w$1;++x){s$1[Caml_int32.imul(i$1+1|0,w$1)-x|0]=Char.chr(v&255);v=v>>>8}}return[k,Bytes.unsafe_to_string(s$1)]}}function get1(s,i){var c=s.charCodeAt(i>>>3);var c$1=c>>>(Pervasives.lnot(i)&7)|0;return c$1&1}function get$1(param,i){var s=param[1];var k=param[0];switch(k){case 1:return get1(s,i);case 2:var c=s.charCodeAt(i>>>2);var c$1=c>>>((Pervasives.lnot(i)&3)<<1)|0;return c$1&3;case 4:var c$2=s.charCodeAt(i>>>1);var c$3=c$2>>>((Pervasives.lnot(i)&1)<<2)|0;return c$3&15;case 8:return s.charCodeAt(i);case 3:case 5:case 6:case 7:case 9:case 10:case 11:case 12:case 13:case 14:case 15:break;case 16:var j=i<<1;return(s.charCodeAt(j)<<8)+s.charCodeAt(j+1|0)|0;default:}if(k!==32){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2394,6]]}var j$1=i<<2;return(((((s.charCodeAt(j$1)<<8)+s.charCodeAt(j$1+1|0)|0)<<8)+s.charCodeAt(j$1+2|0)|0)<<8)+s.charCodeAt(j$1+3|0)|0}function unflatten1(param,i,j){return get1(param[1],Caml_int32.imul(param[0],i)+j|0)}function encode(displacement){if(displacement>=0){return displacement<<1}else{return((-displacement|0)<<1)+1|0}}function decode(displacement){if((displacement&1)===0){return displacement>>>1}else{return-(displacement>>>1)|0}}function compress(equal,insignificant,dummy,m,n,t){if(t.length!==m){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2490,2]]}for(var i=0,i_finish=m-1|0;i<=i_finish;++i){if(Caml_array.caml_array_get(t,i).length!==n){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2493,6]]}}var sparse=function(i,line){var _j=n-1|0;var _rank=0;var _row=0;while(true){var row=_row;var rank=_rank;var j=_j;if(j<0){return[i,rank,row]}else{var x=Caml_array.caml_array_get(line,j);if(Curry._1(insignificant,x)){_j=j-1|0;continue}else{_row=[[j,x],row];_rank=1+rank|0;_j=j-1|0;continue}}}};var rows=$$Array.mapi(sparse,t);$$Array.fast_sort(function(param,param$1){return Caml_primitive.caml_int_compare(param$1[1],param[1])},rows);var displacement=Caml_array.caml_make_vect(m,0);var data=make(dummy);var fits=function(k,row){var d=data.extent;var _param=row;while(true){var param=_param;if(param){var match=param[0];var j=match[0];if((k+j|0)<0){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2571,10]]}if((k+j|0)>=d){return true}else{var y=get(data,k+j|0);if(Curry._1(insignificant,y)||Curry._2(equal,match[1],y)){_param=param[1];continue}else{return false}}}else{return true}}};var fit=function(row){if(row){var _k=-row[0][0]|0;var row$1=row;while(true){var k=_k;if(fits(k,row$1)){return k}else{_k=k+1|0;continue}}}else{return 0}};var write=function(k,_param){while(true){var param=_param;if(param){var match=param[0];set(data,k+match[0]|0,match[1]);_param=param[1];continue}else{return 0}}};$$Array.iter(function(param){var row=param[2];var k=fit(row);write(k,row);return Caml_array.caml_array_set(displacement,param[0],encode(k))},rows);return[displacement,domain(data)]}function get$2(param,i,j){var data=param[1];var displacement=param[0];if(!(0<=i&&i<displacement.length)){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2653,2]]}var k=decode(Caml_array.caml_array_get(displacement,i));if(!(0<=(k+j|0)&&(k+j|0)<data.length)){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2655,2]]}return Caml_array.caml_array_get(data,k+j|0)}function getget(get_displacement,get_data,param,i,j){var k=decode(Curry._2(get_displacement,param[0],i));return Curry._2(get_data,param[1],k+j|0)}function make$1(a){var n=a.length;var size={contents:0};var entry=$$Array.init(n+1|0,function(i){var s=size.contents;if(i<n){size.contents=s+Caml_array.caml_array_get(a,i).length|0}return s});if(Caml_array.caml_array_get(entry,n)!==size.contents){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2701,2]]}var i={contents:0};var j={contents:0};var data=$$Array.init(size.contents,function(param){while(j.contents===Caml_array.caml_array_get(a,i.contents).length){i.contents=i.contents+1|0;j.contents=0}var x=Caml_array.caml_array_get(Caml_array.caml_array_get(a,i.contents),j.contents);j.contents=j.contents+1|0;return x});return[data,entry]}function length$1(param){return param[1].length}function row_length(param,i){var entry=param[1];return Caml_array.caml_array_get(entry,i+1|0)-Caml_array.caml_array_get(entry,i)|0}function row_length_via(get_entry,i){return Curry._1(get_entry,i+1|0)-Curry._1(get_entry,i)|0}function read(la,i,j){if(!(0<=j&&j<row_length(la,i))){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2726,2]]}return Caml_array.caml_array_get(la[0],Caml_array.caml_array_get(la[1],i)+j|0)}function read_via(get_data,get_entry,i,j){if(!(0<=j&&j<row_length_via(get_entry,i))){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2730,2]]}return Curry._1(get_data,Curry._1(get_entry,i)+j|0)}function write(la,i,j,v){if(!(0<=j&&j<row_length(la,i))){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",2734,2]]}return Caml_array.caml_array_set(la[0],Caml_array.caml_array_get(la[1],i)+j|0,v)}function read_interval_via(get_data,i,j){if(i===j){return 0}else{return[Curry._1(get_data,i),read_interval_via(get_data,i+1|0,j)]}}function read_row_via(get_data,get_entry,i){return read_interval_via(get_data,Curry._1(get_entry,i),Curry._1(get_entry,i+1|0))}function read_row(param,i){var entry=param[1];var data=param[0];return read_row_via(function(param){return Caml_array.caml_array_get(data,param)},function(param){return Caml_array.caml_array_get(entry,param)},i)}var TableFormat={};var InspectionTableFormat={};function Symbols(T){return{}}function Make$2(TT,IT,ET,E){var read_packed_linearized=function(param,i){var entry=param[1];var data=param[0];return read_row_via(function(param){return get$1(data,param)},function(param){return get$1(entry,param)},i)};var decode_symbol=function(symbol){if(symbol<=0){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3044,4]]}var kind=symbol&1;var symbol$1=symbol>>>1;if(kind===0){return Curry._1(IT.terminal,symbol$1-1|0)}else{return Curry._1(IT.nonterminal,symbol$1)}};var n2i=function(nt){var answer=TT.start+nt|0;if(!Caml_obj.caml_equal(Curry._1(IT.nonterminal,answer),[Block.__(1,[nt])])){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3063,4]]}return answer};var t2i=function(t){if(!Caml_obj.caml_equal(Curry._1(IT.terminal,t),[Block.__(0,[t])])){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3069,4]]}return t};var compare_terminals=function(t1,t2){return t2i(t1)-t2i(t2)|0};var compare_nonterminals=function(nt1,nt2){return n2i(nt1)-n2i(nt2)|0};var compare_symbols=function(symbol1,symbol2){var match=symbol1[0];if(match.tag){var match$1=symbol2[0];if(match$1.tag){return compare_nonterminals(match[0],match$1[0])}else{return 1}}else{var match$2=symbol2[0];if(match$2.tag){return-1}else{return compare_terminals(match[0],match$2[0])}}};var compare_productions=function(prod1,prod2){return prod1-prod2|0};var compare_items=function(param,param$1){var c=param[0]-param$1[0]|0;if(c!==0){return c}else{return param[1]-param$1[1]|0}};var incoming_symbol=function(s){var core=get$1(IT.lr0_core,s);return decode_symbol(get$1(IT.lr0_incoming,core))[0]};var lhs=function(prod){return Curry._1(IT.nonterminal,get$1(TT.lhs,prod))};var rhs=function(prod){return List.map(decode_symbol,read_packed_linearized(IT.rhs,prod))};var $$export=function(t){return[t>>>7,t%128]};var items=function(s){var core=get$1(IT.lr0_core,s);return List.map($$export,read_packed_linearized(IT.lr0_items,core))};var decode_bool=function(i){if(!(i===0||i===1)){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3150,4]]}return i===1};var nullable=function(nt){return decode_bool(get1(IT.nullable,n2i(nt)))};var first=function(nt,t){return decode_bool(unflatten1(IT.first,n2i(nt),t2i(t)))};var xfirst=function(symbol,t){var match=symbol[0];if(match.tag){return first(match[0],t)}else{return compare_terminals(t,match[0])===0}};var foldij=function(_i,j,f,_accu){while(true){var accu=_accu;var i=_i;if(i===j){return accu}else{_accu=Curry._2(f,i,accu);_i=i+1|0;continue}}};var foreach_terminal=function(f,accu){return foldij(0,TT.error[0],function(i,accu){return Curry._2(f,Curry._1(IT.terminal,i),accu)},accu)};var foreach_terminal_but_error=function(f,accu){return foldij(0,TT.error[0],function(i,accu){if(i===TT.error_terminal){return accu}else{return Curry._2(f,Curry._1(IT.terminal,i),accu)}},accu)};var feed_failure=function(param){return Pervasives.invalid_arg("feed: outgoing transition does not exist")};var feed_nonterminal=function(nt,startp,semv,endp,env){var source=env.current;var match=Curry._2(ET.maybe_goto_nt,source,nt);if(match!==undefined){var stack_next=env.stack;var stack={state:source,semv:semv,startp:startp,endp:endp,next:stack_next};return{error:env.error,triple:env.triple,stack:stack,current:Caml_option.valFromOption(match)}}else{return Pervasives.invalid_arg("feed: outgoing transition does not exist")}};var reduce=function(_env,_prod){return Pervasives.invalid_arg("feed: outgoing transition does not exist")};var initiate=function(_env){return Pervasives.invalid_arg("feed: outgoing transition does not exist")};var feed_terminal=function(terminal,startp,semv,endp,env){var source=env.current;return Curry._7(ET.action,source,terminal,semv,function(env,_please_discard,_terminal,semv,target){var stack_next=env.stack;var stack={state:source,semv:semv,startp:startp,endp:endp,next:stack_next};return{error:env.error,triple:env.triple,stack:stack,current:target}},reduce,initiate,env)};var feed=function(symbol,startp,semv,endp,env){if(symbol.tag){return feed_nonterminal(n2i(symbol[0]),startp,semv,endp,env)}else{return feed_terminal(t2i(symbol[0]),startp,semv,endp,env)}};return{terminal:IT.terminal,nonterminal:IT.nonterminal,lr0_core:IT.lr0_core,lr0_items:IT.lr0_items,lr0_incoming:IT.lr0_incoming,read_packed_linearized:read_packed_linearized,decode_symbol:decode_symbol,n2i:n2i,t2i:t2i,compare_terminals:compare_terminals,compare_nonterminals:compare_nonterminals,compare_symbols:compare_symbols,compare_productions:compare_productions,compare_items:compare_items,incoming_symbol:incoming_symbol,lhs:lhs,rhs:rhs,$$export:$$export,items:items,decode_bool:decode_bool,nullable:nullable,first:first,xfirst:xfirst,foldij:foldij,foreach_terminal:foreach_terminal,foreach_terminal_but_error:foreach_terminal_but_error,feed_failure:feed_failure,feed_nonterminal:feed_nonterminal,reduce:reduce,initiate:initiate,feed_terminal:feed_terminal,feed:feed}}function MakeEngineTable(T){var number=function(s){return s};var foldij=function(_i,j,f,_accu){while(true){var accu=_accu;var i=_i;if(i===j){return accu}else{_accu=Curry._2(f,i,accu);_i=i+1|0;continue}}};var foreach_terminal=function(f,accu){return foldij(0,T.error[0],Curry.__2(f),accu)};var non_start_production=function(i){if(T.start<=i&&(i-T.start|0)<T.semantic_action.length){return 0}else{throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3341,4]]}};var production_index=function(i){non_start_production(i);return i};var find_production=function(i){non_start_production(i);return i};var default_reduction=function(state,defred,nodefred,env){var code=get$1(T.default_reduction,state);if(code===0){return Curry._1(nodefred,env)}else{return Curry._2(defred,env,code-1|0)}};var is_start=function(prod){return prod<T.start};var unmarshal2=function(table,i,j){return getget(get$1,get$1,table,i,j)};var action=function(state,terminal,value,shift,reduce,fail,env){var c=unflatten1(T.error,state,terminal);if(c!==1){if(c!==0){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3387,8]]}return Curry._1(fail,env)}else{var action$1=unmarshal2(T.action,state,terminal);var opcode=action$1&3;var param=action$1>>>2;if(opcode>=2){var please_discard=opcode===2;return Curry._5(shift,env,please_discard,terminal,value,param)}else{return Curry._2(reduce,env,param)}}};var goto_nt=function(state,nt){var code=unmarshal2(T.$$goto,state,nt);return code-1|0};var goto_prod=function(state,prod){return goto_nt(state,get$1(T.lhs,prod))};var maybe_goto_nt=function(state,nt){var code=unmarshal2(T.$$goto,state,nt);if(0>code){throw[Caml_builtin_exceptions.assert_failure,["menhirLib.ml",3402,4]]}if(code===0){return}else{return code-1|0}};var semantic_action=function(prod){return Caml_array.caml_array_get(T.semantic_action,prod-T.start|0)};var may_reduce=function(state,prod){return default_reduction(state,function(param,prod$prime){return prod===prod$prime},function(param){return foreach_terminal(function(t,accu){if(accu){return true}else{return action(state,t,0,function(param,param$1,param$2,param$3,param$4){return false},function(param,prod$prime){return prod===prod$prime},function(param){return false},0)}},false)},0)}
;var log=T.trace!==undefined;var state=function(state$1){if(T.trace!==undefined){return Curry._1(Printf.fprintf(Pervasives.stderr,[Block.__(11,["State ",Block.__(4,[0,0,0,Block.__(11,[":\n",Block.__(10,[0])])])]),"State %d:\n%!"]),state$1)}else{return 0}};var shift=function(terminal,state){var match=T.trace;if(match!==undefined){return Curry._2(Printf.fprintf(Pervasives.stderr,[Block.__(11,["Shifting (",Block.__(2,[0,Block.__(11,[") to state ",Block.__(4,[0,0,0,Block.__(12,[10,Block.__(10,[0])])])])])]),"Shifting (%s) to state %d\n%!"]),Caml_array.caml_array_get(match[0],terminal),state)}else{return 0}};var reduce_or_accept=function(prod){var match=T.trace;if(match!==undefined){return Curry._1(Printf.fprintf(Pervasives.stderr,[Block.__(2,[0,Block.__(12,[10,Block.__(10,[0])])]),"%s\n%!"]),Caml_array.caml_array_get(match[1],prod))}else{return 0}};var lookahead_token=function(token,startp,endp){var match=T.trace;if(match!==undefined){return Curry._3(Printf.fprintf(Pervasives.stderr,[Block.__(11,["Lookahead token is now ",Block.__(2,[0,Block.__(11,[" (",Block.__(4,[0,0,0,Block.__(12,[45,Block.__(4,[0,0,0,Block.__(11,[")\n",Block.__(10,[0])])])])])])])]),"Lookahead token is now %s (%d-%d)\n%!"]),Caml_array.caml_array_get(match[0],token),startp.pos_cnum,endp.pos_cnum)}else{return 0}};var initiating_error_handling=function(param){if(T.trace!==undefined){return Printf.fprintf(Pervasives.stderr,[Block.__(11,["Initiating error handling\n",Block.__(10,[0])]),"Initiating error handling\n%!"])}else{return 0}};var resuming_error_handling=function(param){if(T.trace!==undefined){return Printf.fprintf(Pervasives.stderr,[Block.__(11,["Resuming error handling\n",Block.__(10,[0])]),"Resuming error handling\n%!"])}else{return 0}};var handling_error=function(state){if(T.trace!==undefined){return Curry._1(Printf.fprintf(Pervasives.stderr,[Block.__(11,["Handling error in state ",Block.__(4,[0,0,0,Block.__(12,[10,Block.__(10,[0])])])]),"Handling error in state %d\n%!"]),state)}else{return 0}};var Log={state:state,shift:shift,reduce_or_accept:reduce_or_accept,lookahead_token:lookahead_token,initiating_error_handling:initiating_error_handling,resuming_error_handling:resuming_error_handling,handling_error:handling_error};return{number:number,token2terminal:T.token2terminal,token2value:T.token2value,error_terminal:T.error_terminal,error_value:0,foldij:foldij,foreach_terminal:foreach_terminal,non_start_production:non_start_production,production_index:production_index,find_production:find_production,default_reduction:default_reduction,is_start:is_start,unmarshal2:unmarshal2,action:action,goto_nt:goto_nt,goto_prod:goto_prod,maybe_goto_nt:maybe_goto_nt,$$Error:T.$$Error,semantic_action:semantic_action,may_reduce:may_reduce,log:log,Log:Log}}var StaticVersion={require_20181113:0};var General={take:take,drop:drop,uniq:uniq,weed:weed,length:length,foldr:foldr};var Engine={Make:function(funarg){var $$let=Make(funarg);return{$$Error:$$let.$$Error,entry:$$let.entry,offer:$$let.offer,resume:$$let.resume,lexer_lexbuf_to_supplier:$$let.lexer_lexbuf_to_supplier,loop:$$let.loop,loop_handle:$$let.loop_handle,loop_handle_undo:$$let.loop_handle_undo,shifts:$$let.shifts,acceptable:$$let.acceptable,number:$$let.number,production_index:$$let.production_index,find_production:$$let.find_production,stack:$$let.stack,top:$$let.top,pop_many:$$let.pop_many,get:$$let.get,current_state_number:$$let.current_state_number,equal:$$let.equal,positions:$$let.positions,env_has_default_reduction:$$let.env_has_default_reduction,state_has_default_reduction:$$let.state_has_default_reduction,pop:$$let.pop,force_reduction:$$let.force_reduction,input_needed:$$let.input_needed,start:$$let.start}}};var ErrorReports={wrap:wrap,show:show,last:last};var Printers={Make:function(funarg,funarg$1){var $$let=Make$1(funarg,funarg$1);return{print_symbols:$$let.print_symbols,print_element_as_symbol:$$let.print_element_as_symbol,print_stack:$$let.print_stack,print_item:$$let.print_item,print_production:$$let.print_production,print_current_state:$$let.print_current_state,print_env:$$let.print_env}}};var InfiniteArray={make:make,get:get,set:set,extent:extent,domain:domain};var PackedIntArray={pack:pack,get:get$1,get1:get1,unflatten1:unflatten1};var RowDisplacement={compress:compress,get:get$2,getget:getget};var LinearizedArray={make:make$1,read:read,write:write,length:length$1,row_length:row_length,read_row:read_row,row_length_via:row_length_via,read_via:read_via,read_row_via:read_row_via};function InspectionTableInterpreter_Make(funarg,funarg$1,funarg$2,funarg$3){var $$let=Make$2(funarg,funarg$1,funarg$2,funarg$3);return{compare_terminals:$$let.compare_terminals,compare_nonterminals:$$let.compare_nonterminals,compare_symbols:$$let.compare_symbols,compare_productions:$$let.compare_productions,compare_items:$$let.compare_items,incoming_symbol:$$let.incoming_symbol,items:$$let.items,lhs:$$let.lhs,rhs:$$let.rhs,nullable:$$let.nullable,first:$$let.first,xfirst:$$let.xfirst,foreach_terminal:$$let.foreach_terminal,foreach_terminal_but_error:$$let.foreach_terminal_but_error,feed:$$let.feed}}var InspectionTableInterpreter={Symbols:Symbols,Make:InspectionTableInterpreter_Make};var TableInterpreter={MakeEngineTable:function(funarg){var $$let=MakeEngineTable(funarg);return{number:$$let.number,token2terminal:$$let.token2terminal,token2value:$$let.token2value,error_terminal:$$let.error_terminal,error_value:$$let.error_value,foreach_terminal:$$let.foreach_terminal,production_index:$$let.production_index,find_production:$$let.find_production,default_reduction:$$let.default_reduction,action:$$let.action,goto_nt:$$let.goto_nt,goto_prod:$$let.goto_prod,maybe_goto_nt:$$let.maybe_goto_nt,is_start:$$let.is_start,$$Error:$$let.$$Error,semantic_action:$$let.semantic_action,may_reduce:$$let.may_reduce,log:$$let.log,Log:$$let.Log}}};exports.General=General;exports.Convert=Convert;exports.IncrementalEngine=IncrementalEngine;exports.EngineTypes=EngineTypes;exports.Engine=Engine;exports.ErrorReports=ErrorReports;exports.Printers=Printers;exports.InfiniteArray=InfiniteArray;exports.PackedIntArray=PackedIntArray;exports.RowDisplacement=RowDisplacement;exports.LinearizedArray=LinearizedArray;exports.TableFormat=TableFormat;exports.InspectionTableFormat=InspectionTableFormat;exports.InspectionTableInterpreter=InspectionTableInterpreter;exports.TableInterpreter=TableInterpreter;exports.StaticVersion=StaticVersion},{"bs-platform/lib/js/array.js":1,"bs-platform/lib/js/block.js":2,"bs-platform/lib/js/bytes.js":4,"bs-platform/lib/js/caml_array.js":5,"bs-platform/lib/js/caml_builtin_exceptions.js":6,"bs-platform/lib/js/caml_bytes.js":7,"bs-platform/lib/js/caml_int32.js":11,"bs-platform/lib/js/caml_obj.js":17,"bs-platform/lib/js/caml_option.js":18,"bs-platform/lib/js/caml_primitive.js":19,"bs-platform/lib/js/camlinternalLazy.js":25,"bs-platform/lib/js/char.js":26,"bs-platform/lib/js/curry.js":27,"bs-platform/lib/js/lexing.js":31,"bs-platform/lib/js/list.js":32,"bs-platform/lib/js/pervasives.js":36,"bs-platform/lib/js/printf.js":37,"bs-platform/lib/js/sys.js":40}],49:[function(require,module,exports){"use strict";var Util=require("./util.bs.js");var Curry=require("bs-platform/lib/js/curry.js");var Bnf_lexer=require("./bnf_lexer.bs.js");var Bnf_parser=require("./bnf_parser.bs.js");var CamlinternalLazy=require("bs-platform/lib/js/camlinternalLazy.js");var Bnf_parser_messages=require("./bnf_parser_messages.bs.js");var Caml_builtin_exceptions=require("bs-platform/lib/js/caml_builtin_exceptions.js");function get_parse_error(env){var match=Curry._1(Bnf_parser.MenhirInterpreter.stack,env);var match$1=CamlinternalLazy.force(match);if(match$1){try{return Bnf_parser_messages.message(Curry._1(Bnf_parser.MenhirInterpreter.number,match$1[0][0]))}catch(exn){if(exn===Caml_builtin_exceptions.not_found){return"invalid syntax (no specific message for this eror)"}else{throw exn}}}else{return"Invalid syntax"}}function parse(lexbuf,_checkpoint){while(true){var checkpoint=_checkpoint;if(typeof checkpoint==="number"){throw[Util.Syntax_error,[undefined,"invalid syntax (parser rejected the input)"]]}else{switch(checkpoint.tag|0){case 0:var token=Bnf_lexer.token(lexbuf);var startp=lexbuf.lex_start_p;var endp=lexbuf.lex_curr_p;var checkpoint$1=Curry._2(Bnf_parser.MenhirInterpreter.offer,checkpoint,[token,startp,endp]);_checkpoint=checkpoint$1;continue;case 1:case 2:break;case 3:var match=Util.get_lexing_position(lexbuf);var err=get_parse_error(checkpoint[0]);throw[Util.Syntax_error,[[match[0],match[1]],err]];case 4:return checkpoint[0]}}var checkpoint$2=Curry._1(Bnf_parser.MenhirInterpreter.resume,checkpoint);_checkpoint=checkpoint$2;continue}}var I=0;exports.I=I;exports.get_parse_error=get_parse_error;exports.parse=parse},{"./bnf_lexer.bs.js":41,"./bnf_parser.bs.js":42,"./bnf_parser_messages.bs.js":43,"./util.bs.js":50,"bs-platform/lib/js/caml_builtin_exceptions.js":6,"bs-platform/lib/js/camlinternalLazy.js":25,"bs-platform/lib/js/curry.js":27}],50:[function(require,module,exports){"use strict";var Lexing=require("bs-platform/lib/js/lexing.js");var Caml_exceptions=require("bs-platform/lib/js/caml_exceptions.js");var Syntax_error=Caml_exceptions.create("Util.Syntax_error");function get_lexing_position(lexbuf){var p=Lexing.lexeme_start_p(lexbuf);var line_number=p.pos_lnum;var column=(p.pos_cnum-p.pos_bol|0)+1|0;return[line_number,column]}exports.Syntax_error=Syntax_error;exports.get_lexing_position=get_lexing_position},{"bs-platform/lib/js/caml_exceptions.js":8,"bs-platform/lib/js/lexing.js":31}],51:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}]},{},[45]);
